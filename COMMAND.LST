                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.21.0, LST:Full:4
                                
                                ;   似非COMMAND.COM
                                
       0005                     SYSTEM  EQU 00005H
       005C                     FCB1    EQU 0005CH
       006C                     FCB2    EQU 0006CH
       0080                     DTA1    EQU 00080H
                                
       000C                     RDSLT   EQU 0000CH
       001C                     CALSLT  EQU 0001CH
       006C                     INITXT  EQU 0006CH
       006F                     INIT32  EQU 0006FH
       0078                     SETTXT  EQU 00078H
       007B                     SETT32  EQU 0007BH
       0147                     FORMAT  EQU 00147H
                                
       F3AE                     LINL40  EQU 0F3AEH
       F3AF                     LINL32  EQU 0F3AFH
       F3B0                     LINLEN  EQU 0F3B0H
       F55E                     BUF EQU 0F55EH
       F7C4                     TRCFLG  EQU 0F7C4H
       FAF8                     EXBRSA  EQU 0FAF8H
       FC9B                     INTFLG  EQU 0FC9BH
       FCC1                     EXPTBL  EQU 0FCC1H
                                
                                
       0040                     PATHX   EQU 64
                                
       8000                     DATA    EQU 08000H
                                
000000 0100                         ORG 0100H
000000 0100 C31501          10      JP  START
       0103                     VER:
000003 0103 0D0A434F4D4D414E        DB  00DH,00AH,"COMMAND v0.19",00DH,00AH,'$'
            442076302E31390D    
            0A24                
       0115                     START:
000015 0115 ED7B0600        20      LD  SP,(SYSTEM+1)
000019 0119 0E6F             7      LD  C,06FH      ;(BDOS)MSX-DOS のバージョン番号の獲得
00001B 011B CD0500          17      CALL    SYSTEM
00001E 011E D8              11      RET C
00001F 011F 211D01          10      LD  HL,0011DH
000022 0122 ED42            15      SBC HL,BC
000024 0124 78               4      LD  A,B
000025 0125 32D611          13      LD  (MAJOR_VER),A
000028 0128 B5               4      OR  L
000029 0129 32D511          13      LD  (IS_MSX),A
00002C 012C B7               4      OR  A
00002D 012D 286A            12      JR  Z,WSTART
                                
00002F 012F 3AD513          13      LD  A,(PROCESS)
000032 0132 0E61             7      LD  C,61H       ;(BDOS)親プロセスに戻る
000034 0134 47               4      LD  B,A
000035 0135 B7               4      OR  A
000036 0136 C40500          17      CALL    NZ,SYSTEM
000039 0139 AF               4      XOR A
00003A 013A 32D513          13      LD  (PROCESS),A
                                
00003D 013D 212B00          10      LD  HL,002BH    ;キャラクターセット・日時フォーマット・ビデオ信号の種別
000040 0140 CD0C00          17      CALL    RDSLT
000043 0143 0F               4      RRCA
000044 0144 0F               4      RRCA
000045 0145 0F               4      RRCA
000046 0146 0F               4      RRCA
000047 0147 E603             7      AND 3
000049 0149 2814            12      JR  Z,DATEOK
00004B 014B 3D               4      DEC A
00004C 014C 21A611          10      LD  HL,V_DATE1
00004F 014F 2806            12      JR  Z,DATECHG
000051 0151 3D               4      DEC A
000052 0152 21AE11          10      LD  HL,V_DATE2
000055 0155 2008            12      JR  NZ,DATEOK
       0157                     DATECHG:
000057 0157 119611          10      LD  DE,V_DATE
00005A 015A 010800          10      LD  BC,8
00005D 015D EDB0                    LDIR
       015F                     DATEOK:
00005F 015F CD1E0E          17      CALL    INIT_VAR
000062 0162 3AC4F7          13      LD  A,(TRCFLG)
000065 0165 B7               4      OR  A
000066 0166 2814            12      JR  Z,WSTART0
000068 0168 11B310          10      LD  DE,COMERM
00006B 016B 0E09             7      LD  C,9     ;(BDOS)文字列出力
00006D 016D CD0500          17      CALL    SYSTEM
000070 0170 2AC4F7          16      LD  HL,(TRCFLG)
000073 0173 2600             7      LD  H,0
000075 0175 CDC106          17      CALL    PRDEC_HL
000078 0178 AF               4      XOR A
000079 0179 32C4F7          13      LD  (TRCFLG),A
       017C                     WSTART0:
00007C 017C 2A0600          16      LD  HL,(SYSTEM+1)
00007F 017F 2EDB             7      LD  L,256-37
000081 0181 24               4      INC H
000082 0182 22CE13          16      LD  (FCB_BAT),HL
000085 0185 3A8000          13      LD  A,(DTA1)
000088 0188 B7               4      OR  A
000089 0189 280E            12      JR  Z,WSTART
00008B 018B 110301          10      LD  DE,VER
00008E 018E 0E09             7      LD  C,9
000090 0190 CD0500          17      CALL    SYSTEM
000093 0193 118100          10      LD  DE,DTA1+1
000096 0196 CDFC01          17      CALL    COMANL
       0199                     WSTART:
000099 0199 210511          10      LD  HL,N_APPEND
00009C 019C 110C11          10      LD  DE,V_APPEND
00009F 019F 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000A1 01A1 CD0500          17      CALL    SYSTEM
                                
0000A4 01A4 21BE11          10      LD  HL,N_PROGRAM
0000A7 01A7 11CD13          10      LD  DE,ZERO
0000AA 01AA 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000AC 01AC CD0500          17      CALL    SYSTEM
                                
0000AF 01AF 21C611          10      LD  HL,N_PARAMETERS
0000B2 01B2 11CD13          10      LD  DE,ZERO
0000B5 01B5 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000B7 01B7 CD0500          17      CALL    SYSTEM
                                
0000BA 01BA CD5F06          17      CALL    LTNL
       01BD                     COMMAND:
0000BD 01BD E5              11      PUSH    HL
0000BE 01BE 2ACE13          16      LD  HL,(FCB_BAT)
0000C1 01C1 7E               7      LD  A,(HL)
0000C2 01C2 E1              10      POP HL
0000C3 01C3 B7               4      OR  A
0000C4 01C4 C2EC04          10      JP  NZ,C_BAT1
0000C7 01C7 CD8703          17      CALL    SETDTA1
0000CA 01CA D5              11      PUSH    DE
0000CB 01CB C5              11      PUSH    BC
0000CC 01CC E5              11      PUSH    HL
0000CD 01CD 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0000CF 01CF CD0500          17      CALL    SYSTEM
0000D2 01D2 E1              10      POP HL
0000D3 01D3 C1              10      POP BC
0000D4 01D4 C641             7      ADD A,'A'
0000D6 01D6 CDC30A          17      CALL    MSG_A
0000D9 01D9 1E3E             7      LD  E,'>'
0000DB 01DB CDB20A          17      CALL    _PRINT
0000DE 01DE D1              10      POP DE      ;DE=DTA1
0000DF 01DF 3E50             7      LD  A,80
0000E1 01E1 12               7      LD  (DE),A
0000E2 01E2 0E0A             7      LD  C,0AH       ;(BDOS)文字列入力
0000E4 01E4 CD0500          17      CALL    SYSTEM
0000E7 01E7 CD5F06          17      CALL    LTNL
       01EA                     COMMAND2:
0000EA 01EA 118200          10      LD  DE,DTA1+2
0000ED 01ED CDFC01          17      CALL    COMANL
0000F0 01F0 30CB            12      JR  NC,COMMAND
0000F2 01F2 11B310          10      LD  DE,COMERM
0000F5 01F5 0E09             7      LD  C,9     ;(BDOS)文字列出力
0000F7 01F7 CD0500          17      CALL    SYSTEM
0000FA 01FA 189D            12      JR  WSTART
                                
       01FC                     COMANL:
0000FC 01FC CDE70B          17      CALL    TOZERO
0000FF 01FF ED532902        20      LD  (COMST),DE
000103 0203 CD040B          17      CALL    FILE
000106 0206 D5              11      PUSH    DE
000107 0207 11A813          10      LD  DE,FNAME
00010A 020A 1A               7      LD  A,(DE)
00010B 020B FE20             7      CP  020H
00010D 020D CA9A02          10      JP  Z,SDVSW
000110 0210 1B               6      DEC DE
000111 0211 1A               7      LD  A,(DE)
000112 0212 C6FF             7      ADD A,0FFH
000114 0214 380A            12      JR  C,COMB
000116 0216 13               6      INC DE
                                
000117 0217 21F70F          10      LD  HL,COMTB
00011A 021A 3E12             7      LD  A,COMS
00011C 021C 47               4      LD  B,A
00011D 021D CD390C          17      CALL    CPNAME
       0220                     COMB:
000120 0220 D1              10      POP DE
000121 0221 D2B10A          10      JP  NC,JP_HL
       0224                     COMB2:
000124 0224 EB               4      EX  DE,HL
000125 0225 221B04          16      LD  (COMPAT),HL
                                
000128 0228 110000          10      LD  DE,0
       0229                     COMST   EQU $-2
00012B 022B 21D613          10      LD  HL,DATA_COM
00012E 022E 3600            10      LD  (HL),0
       0230                     COMPR1:
000130 0230 1A               7      LD  A,(DE)
000131 0231 13               6      INC DE
000132 0232 23               6      INC HL
000133 0233 77               7      LD  (HL),A
000134 0234 FE20             7      CP  020H
000136 0236 30F8            12      JR  NC,COMPR1
       0238                     COMPR2:
000138 0238 2B               6      DEC HL
000139 0239 7E               7      LD  A,(HL)
00013A 023A FE5C             7      CP  05CH
00013C 023C 2014            12      JR  NZ,COMPR3
00013E 023E 3600            10      LD  (HL),0
000140 0240 23               6      INC HL
000141 0241 EB               4      EX  DE,HL
000142 0242 CD040B          17      CALL    FILE
000145 0245 210511          10      LD  HL,N_APPEND
000148 0248 11D713          10      LD  DE,DATA_COM+1
00014B 024B 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
00014D 024D CD0500          17      CALL    SYSTEM
000150 0250 1804            12      JR  COMPR4
       0252                     COMPR3:
000152 0252 FE20             7      CP  020H
000154 0254 30E2            12      JR  NC,COMPR2
       0256                     COMPR4:
000156 0256 CDDD03          17      CALL    CEXE4
                                
000159 0259 214C11          10      LD  HL,N_PATH
00015C 025C 115111          10      LD  DE,V_PATH
00015F 025F 0640             7      LD  B,PATHX
000161 0261 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000163 0263 CD0500          17      CALL    SYSTEM
                                
000166 0266 215111          10      LD  HL,V_PATH
000169 0269 22D013          16      LD  (X_PATH),HL
       026C                     CEX1:
00016C 026C 2AD013          16      LD  HL,(X_PATH)
00016F 026F 7E               7      LD  A,(HL)
000170 0270 FE20             7      CP  020H
000172 0272 D8              11      RET C
       0273                     CEX2:
000173 0273 7E               7      LD  A,(HL)
000174 0274 FE20             7      CP  020H
000176 0276 3807            12      JR  C,CEX3
000178 0278 FE3B             7      CP  ';'
00017A 027A 2803            12      JR  Z,CEX3
00017C 027C 23               6      INC HL
00017D 027D 18F4            12      JR  CEX2
       027F                     CEX3:
00017F 027F 3600            10      LD  (HL),0
000181 0281 FE20             7      CP  020H
000183 0283 3801            12      JR  C,CEX4
000185 0285 23               6      INC HL
       0286                     CEX4:
000186 0286 ED5BD013        20      LD  DE,(X_PATH)
00018A 028A 22D013          16      LD  (X_PATH),HL
00018D 028D 210511          10      LD  HL,N_APPEND
000190 0290 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000192 0292 CD0500          17      CALL    SYSTEM
                                
000195 0295 CDDD03          17      CALL    CEXE4
000198 0298 18D2            12      JR  CEX1
                                
       029A                     SDVSW:
00019A 029A F1              10      POP AF
00019B 029B 3AA713          13      LD  A,(FDRV)
00019E 029E 3D               4      DEC A
00019F 029F 5F               4      LD  E,A
0001A0 02A0 0E0E             7      LD  C,00EH      ;(BDOS)カレントドライブの設定
0001A2 02A2 C38E03          10      JP  SYSTEM0
                                
       02A5                     OPEN_D2:            ;DOS2対応
0001A5 02A5 3AD611          13      LD  A,(MAJOR_VER)
0001A8 02A8 FE02             7      CP  2
0001AA 02AA 384F            12      JR  C,OPEN
0001AC 02AC 119E12          10      LD  DE,PATH_FN1
0001AF 02AF 180A            12      JR  OPEN_D2X
       02B1                     OPEN1_D2:           ;DOS2対応
0001B1 02B1 3AD611          13      LD  A,(MAJOR_VER)
0001B4 02B4 FE02             7      CP  2
0001B6 02B6 3840            12      JR  C,OPEN1
                                
0001B8 02B8 111E12          10      LD  DE,PATH_CCP
       02BB                     OPEN_D2X:
0001BB 02BB DD21D711        14      LD  IX,SEARCH_IX
0001BF 02BF 014010          10      LD  BC,01040H   ;(BDOS)最初のエントリ検索
0001C2 02C2 CD0500          17      CALL    SYSTEM
0001C5 02C5 F5              11      PUSH    AF
0001C6 02C6 115E12          10      LD  DE,PATH_PAR
0001C9 02C9 0E5E             7      LD  C,05EH      ;(BDOS)完全なパス文字列の獲得(_WPATH)
0001CB 02CB CD0500          17      CALL    SYSTEM
0001CE 02CE AF               4      XOR A
0001CF 02CF 77               7      LD  (HL),A
0001D0 02D0 115E12          10      LD  DE,PATH_PAR
0001D3 02D3 ED52            15      SBC HL,DE
0001D5 02D5 221912          16      LD  (PATH_POS),HL
0001D8 02D8 F1              10      POP AF
       02D9                     FIB2DIRENT:
0001D9 02D9 B7               4      OR  A
0001DA 02DA C0              11      RET NZ
                                
0001DB 02DB 11D811          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
0001DE 02DE 217013          10      LD  HL,DTA_CCP+1
0001E1 02E1 0E5C             7      LD  C,05CH      ;(BDOS)ファイル名の解析
0001E3 02E3 CD0500          17      CALL    SYSTEM
                                
0001E6 02E6 21E511          10      LD  HL,SEARCH_IX+14 ;(FIB)属性
0001E9 02E9 117B13          10      LD  DE,DTA_CCP+1+8+3
0001EC 02EC EDA0            16      LDI
0001EE 02EE 118613          10      LD  DE,DTA_CCP+1+8+3+1+10
0001F1 02F1 010A00          10      LD  BC,2+2+2+4  ;最終変更時刻+最終変更日付+開始クラスタ+ファイルサイズ
0001F4 02F4 EDB0                    LDIR
0001F6 02F6 AF               4      XOR A
0001F7 02F7 C9              10      RET
                                
       02F8                     OPEN1:
0001F8 02F8 21A713          10      LD  HL,FDRV
       02FB                     OPEN:
0001FB 02FB 0E11             7      LD  C,011H      ;(BDOS)最初のファイルの検索
       02FD                     OPEN3:
0001FD 02FD D5              11      PUSH    DE
0001FE 02FE 116F13          10      LD  DE,DTA_CCP
000201 0301 CD7A03          17      CALL    SETDTA
000204 0304 EB               4      EX  DE,HL
000205 0305 CD0500          17      CALL    SYSTEM
000208 0308 D1              10      POP DE
000209 0309 B7               4      OR  A
00020A 030A C9              10      RET
                                
       030B                     OPEN2_D2:           ;DOS2対応
00020B 030B 3AD611          13      LD  A,(MAJOR_VER)
00020E 030E FE02             7      CP  2
000210 0310 380B            12      JR  C,OPEN2
000212 0312 DD21D711        14      LD  IX,SEARCH_IX
000216 0316 0E41             7      LD  C,41H       ;(BDOS)次のエントリ検索
000218 0318 CD0500          17      CALL    SYSTEM
00021B 031B 18BC            12      JR  FIB2DIRENT
       031D                     OPEN2:
00021D 031D 0E12             7      LD  C,012H
00021F 031F 18DC            12      JR  OPEN3
                                
       0321                     DEFCB_D2:           ;DOS2対応
000221 0321 3AD611          13      LD  A,(MAJOR_VER)
000224 0324 FE02             7      CP  2
000226 0326 383A            12      JR  C,DEFCB
000228 0328 215E12          10      LD  HL,PATH_PAR
00022B 032B 111E12          10      LD  DE,PATH_CCP
00022E 032E 014000          10      LD  BC,64
000231 0331 EDB0                    LDIR
000233 0333 2A1912          16      LD  HL,(PATH_POS)
000236 0336 111E12          10      LD  DE,PATH_CCP
000239 0339 19              11      ADD HL,DE
00023A 033A 060D             7      LD  B,13
00023C 033C 11D811          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
       033F                     DCB4:
00023F 033F 1A               7      LD  A,(DE)
000240 0340 B7               4      OR  A
000241 0341 2805            12      JR  Z,DCB5
000243 0343 13               6      INC DE
000244 0344 77               7      LD  (HL),A
000245 0345 23               6      INC HL
000246 0346 18F7            12      JR  DCB4
       0348                     DCB5:
000248 0348 3600            10      LD  (HL),0
00024A 034A 3AF011          13      LD  A,(SEARCH_IX+25)    ;(FIB)ドライブ番号(1-8)
00024D 034D C640             7      ADD A,040H
00024F 034F 111B12          10      LD  DE,PATH_DRV
000252 0352 12               7      LD  (DE),A
000253 0353 0E43             7      LD  C,043H      ;_OPEN ファイルハンドルのオープン
000255 0355 3E01             7      LD  A,1     ;書き込み禁止
000257 0357 CD0500          17      CALL    SYSTEM
00025A 035A B7               4      OR  A
00025B 035B C0              11      RET NZ
00025C 035C ED431712        20      LD  (HANDLE1),BC
000260 0360 1815            12      JR  SETDTA100
       0362                     DEFCB:              ;Z=Ok NZ=Error
000262 0362 116F13          10      LD  DE,DTA_CCP
000265 0365 CD8C03          17      CALL    SYSC0F
000268 0368 B7               4      OR  A
000269 0369 C0              11      RET NZ
                                
00026A 036A 210100          10      LD  HL,1
00026D 036D 227D13          16      LD  (DTA_CCP+14),HL
000270 0370 2D               4      DEC L
000271 0371 229013          16      LD  (DTA_CCP+33),HL
000274 0374 229213          16      LD  (DTA_CCP+35),HL
       0377                     SETDTA100:
000277 0377 110080          10      LD  DE,DATA
       037A                     SETDTA:
00027A 037A C5              11      PUSH    BC
00027B 037B D5              11      PUSH    DE
00027C 037C E5              11      PUSH    HL
00027D 037D 0E1A             7      LD  C,01AH      ;(BDOS)DTAの設定
00027F 037F CD0500          17      CALL    SYSTEM
000282 0382 E1              10      POP HL
000283 0383 D1              10      POP DE
000284 0384 C1              10      POP BC
000285 0385 AF               4      XOR A
000286 0386 C9              10      RET
                                
       0387                     SETDTA1:
000287 0387 118000          10      LD  DE,DTA1
00028A 038A 18EE            12      JR  SETDTA
                                
       038C                     SYSC0F:
00028C 038C 0E0F             7      LD  C,00FH      ;(BDOS)ファイルのオープン
       038E                     SYSTEM0:
00028E 038E CD0500          17      CALL    SYSTEM
000291 0391 B7               4      OR  A
000292 0392 C9              10      RET
                                
       0393                     C_CD:
000293 0393 CDD60A          17      CALL    FILEC_D2
000296 0396 111E12          10      LD  DE,PATH_CCP
000299 0399 1A               7      LD  A,(DE)
00029A 039A FE20             7      CP  020H
00029C 039C 3805            12      JR  C,PWD
00029E 039E 0E5A             7      LD  C,5AH       ;(BDOS)_CHDIR カレントディレクトリの変更
0002A0 03A0 C30500          10      JP  SYSTEM
       03A3                     PWD:
0002A3 03A3 CDA506          17      CALL    PUTDRV
0002A6 03A6 3E5C             7      LD  A,05CH
0002A8 03A8 CDC30A          17      CALL    MSG_A
0002AB 03AB C30A06          10      JP  PDSKF2
                                
       03AE                     S27DTA_D2:      ;DOS2対応
0002AE 03AE 3AD611          13      LD  A,(MAJOR_VER)
0002B1 03B1 FE02             7      CP  2
0002B3 03B3 3817            12      JR  C,S27DTA
0002B5 03B5 ED4B1712        20      LD  BC,(HANDLE1)
0002B9 03B9 110080          10      LD  DE,DATA
0002BC 03BC 0E48             7      LD  C,048H      ;(BDOS)ファイルハンドルからの読み出し(_READ)
0002BE 03BE CD8E03          17      CALL    SYSTEM0
0002C1 03C1 C8              11      RET Z
0002C2 03C2 FEC7             7      CP  0C7H        ;.EOF
0002C4 03C4 2803            12      JR  Z,S27EOF
0002C6 03C6 37               4      SCF
0002C7 03C7 9F               4      SBC A,A
0002C8 03C8 C9              10      RET
       03C9                     S27EOF:
0002C9 03C9 3E01             7      LD  A,1
0002CB 03CB C9              10      RET
                                
       03CC                     S27DTA:
0002CC 03CC 110100          10      LD  DE,1
0002CF 03CF ED537D13        20      LD  (DTA_CCP+14),DE
0002D3 03D3 116F13          10      LD  DE,DTA_CCP
       03D6                     S27:
0002D6 03D6 0E27             7      LD  C,027H      ;(BDOS)ランダム・ブロック・リード
0002D8 03D8 CD0500          17      CALL    SYSTEM
0002DB 03DB B7               4      OR  A
0002DC 03DC C9              10      RET
                                
       03DD                     CEXE4:
0002DD 03DD 21A713          10      LD  HL,FDRV
0002E0 03E0 116F13          10      LD  DE,DTA_CCP
0002E3 03E3 010900          10      LD  BC,1+8
0002E6 03E6 EDB0                    LDIR
0002E8 03E8 217813          10      LD  HL,DTA_CCP+9
0002EB 03EB 3643            10      LD  (HL),'C'
0002ED 03ED 23               6      INC HL
0002EE 03EE 364F            10      LD  (HL),'O'
0002F0 03F0 23               6      INC HL
0002F1 03F1 364D            10      LD  (HL),'M'
       03F3                     C_EXE:
0002F3 03F3 CD6203          17      CALL    DEFCB
0002F6 03F6 C2C404          10      JP  NZ,C_BAT
0002F9 03F9 11D613          10      LD  DE,DATA_COM
0002FC 03FC CD7A03          17      CALL    SETDTA
                                
0002FF 03FF 2A0600          16      LD  HL,(SYSTEM+1)
000302 0402 11D613          10      LD  DE,DATA_COM
000305 0405 ED52            15      SBC HL,DE
                                
000307 0407 CDCC03          17      CALL    S27DTA
00030A 040A 3D               4      DEC A
00030B 040B 37               4      SCF
00030C 040C C0              11      RET NZ
00030D 040D 7C               4      LD  A,H
00030E 040E B5               4      OR  L
00030F 040F 37               4      SCF
000310 0410 C8              11      RET Z
000311 0411 22BE04          16      LD  (COMSIZ),HL
                                
000314 0414 11D613          10      LD  DE,DATA_COM
000317 0417 CD7A03          17      CALL    SETDTA
00031A 041A 110000          10      LD  DE,0
       041B                     COMPAT  EQU $-2
00031D 041D CD5408          17      CALL    SETFCB
                                
000320 0420 210511          10      LD  HL,N_APPEND
000323 0423 111E12          10      LD  DE,PATH_CCP
000326 0426 0640             7      LD  B,PATHX
000328 0428 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
00032A 042A CD0500          17      CALL    SYSTEM
00032D 042D 3A1E12          13      LD  A,(PATH_CCP)
000330 0430 B7               4      OR  A
000331 0431 201D            12      JR  NZ,COM_ENV1
000333 0433 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
000335 0435 CD0500          17      CALL    SYSTEM
000338 0438 C641             7      ADD A,'A'
00033A 043A 321E12          13      LD  (PATH_CCP),A
00033D 043D 3E3A             7      LD  A,':'
00033F 043F 321F12          13      LD  (PATH_CCP+1),A
000342 0442 3E5C             7      LD  A,05CH      ;\
000344 0444 322012          13      LD  (PATH_CCP+2),A
000347 0447 47               4      LD  B,A     ;ドライブ
000348 0448 112012          10      LD  DE,PATH_CCP+2
00034B 044B 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
00034D 044D CD0500          17      CALL    SYSTEM
       0450                     COM_ENV1:
000350 0450 116F13          10      LD  DE,DTA_CCP
000353 0453 216113          10      LD  HL,DOS2NAME
000356 0456 CD170A          17      CALL    FCB2FNAME
000359 0459 111E12          10      LD  DE,PATH_CCP
00035C 045C 216313          10      LD  HL,DOS2NAME+2
       045F                     COM_ENV2:
00035F 045F 1A               7      LD  A,(DE)
000360 0460 B7               4      OR  A
000361 0461 2803            12      JR  Z,COM_ENV3
000363 0463 13               6      INC DE
000364 0464 18F9            12      JR  COM_ENV2
       0466                     COM_ENV3:
000366 0466 1B               6      DEC DE
000367 0467 1A               7      LD  A,(DE)
000368 0468 13               6      INC DE
000369 0469 FE5C             7      CP  05CH
00036B 046B 2804            12      JR  Z,COM_ENV4
00036D 046D 3E5C             7      LD  A,05CH
00036F 046F 12               7      LD  (DE),A
000370 0470 13               6      INC DE
       0471                     COM_ENV4:
000371 0471 7E               7      LD  A,(HL)
000372 0472 23               6      INC HL
000373 0473 12               7      LD  (DE),A
000374 0474 13               6      INC DE
000375 0475 B7               4      OR  A
000376 0476 20F9            12      JR  NZ,COM_ENV4
                                
000378 0478 21BE11          10      LD  HL,N_PROGRAM
00037B 047B 111E12          10      LD  DE,PATH_CCP
00037E 047E 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000380 0480 CD0500          17      CALL    SYSTEM
                                
000383 0483 21C611          10      LD  HL,N_PARAMETERS
000386 0486 118100          10      LD  DE,DTA1+1
000389 0489 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
00038B 048B CD0500          17      CALL    SYSTEM
                                
00038E 048E 210511          10      LD  HL,N_APPEND
000391 0491 110C11          10      LD  DE,V_APPEND
000394 0494 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000396 0496 CD0500          17      CALL    SYSTEM
                                
000399 0499 0E60             7      LD  C,60H       ;(BDOS)子プロセスの起動
00039B 049B CD0500          17      CALL    SYSTEM
00039E 049E B7               4      OR  A
00039F 049F 2004            12      JR  NZ,COMP1
0003A1 04A1 78               4      LD  A,B
0003A2 04A2 32D513          13      LD  (PROCESS),A
       04A5                     COMP1:
0003A5 04A5 AF               4      XOR A
0003A6 04A6 67               4      LD  H,A
0003A7 04A7 6F               4      LD  L,A ;HL=0x0000
0003A8 04A8 32C4F7          13      LD  (TRCFLG),A
0003AB 04AB F3               4      DI
0003AC 04AC ED7B0600        20      LD  SP,(SYSTEM+1)
0003B0 04B0 E5              11      PUSH    HL
0003B1 04B1 21EDB0          10      LD  HL,0B0EDH   ;LDIR
0003B4 04B4 22FE00          16      LD  (000FEH),HL
0003B7 04B7 21D613          10      LD  HL,DATA_COM
0003BA 04BA 110001          10      LD  DE,00100H
0003BD 04BD 010000          10      LD  BC,0
       04BE                     COMSIZ  EQU $-2
0003C0 04C0 FB               4      EI
0003C1 04C1 C3FE00          10      JP  000FEH
                                
       04C4                     C_BAT:
0003C4 04C4 217813          10      LD  HL,DTA_CCP+9
0003C7 04C7 3642            10      LD  (HL),'B'
0003C9 04C9 23               6      INC HL
0003CA 04CA 3641            10      LD  (HL),'A'
0003CC 04CC 23               6      INC HL
0003CD 04CD 3654            10      LD  (HL),'T'
                                
0003CF 04CF CD6203          17      CALL    DEFCB
0003D2 04D2 C0              11      RET NZ
                                
0003D3 04D3 216F13          10      LD  HL,DTA_CCP
0003D6 04D6 7E               7      LD  A,(HL)
0003D7 04D7 B7               4      OR  A
0003D8 04D8 2009            12      JR  NZ,CBAT_DS
0003DA 04DA E5              11      PUSH    HL
0003DB 04DB 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
0003DD 04DD CD0500          17      CALL    SYSTEM
0003E0 04E0 E1              10      POP HL
0003E1 04E1 3C               4      INC A
0003E2 04E2 77               7      LD  (HL),A
       04E3                     CBAT_DS:
0003E3 04E3 ED5BCE13        20      LD  DE,(FCB_BAT)
0003E7 04E7 012500          10      LD  BC,37
0003EA 04EA EDB0                    LDIR
       04EC                     C_BAT1:
0003EC 04EC CD7703          17      CALL    SETDTA100
0003EF 04EF CD2D05          17      CALL    FGETC_BAT
0003F2 04F2 218100          10      LD  HL,DTA1+1
0003F5 04F5 202A            12      JR  NZ,END_BATCH
0003F7 04F7 FE21             7      CP  021H        ;スペースや改行など制御文字を飛ばす
0003F9 04F9 38F1            12      JR  C,C_BAT1
0003FB 04FB 3620            10      LD  (HL),' '
0003FD 04FD 23               6      INC HL
       04FE                     C_BAT2:
0003FE 04FE 77               7      LD  (HL),A
0003FF 04FF 23               6      INC HL
000400 0500 7D               4      LD  A,L
000401 0501 3C               4      INC A       ;L==0FFH
000402 0502 2809            12      JR  Z,RUN_BATCH
000404 0504 CD2D05          17      CALL    FGETC_BAT
000407 0507 2004            12      JR  NZ,RUN_BATCH
000409 0509 FE20             7      CP  020H
00040B 050B 30F1            12      JR  NC,C_BAT2
       050D                     RUN_BATCH:
00040D 050D 7D               4      LD  A,L
00040E 050E D67F             7      SUB DTA1-1
000410 0510 328000          13      LD  (DTA1),A
000413 0513 FE04             7      CP  4
000415 0515 380A            12      JR  C,END_BATCH
000417 0517 3600            10      LD  (HL),0
000419 0519 3A9BFC          13      LD  A,(INTFLG)
00041C 051C FE03             7      CP  3
00041E 051E C2EA01          10      JP  NZ,COMMAND2
       0521                     END_BATCH:      ;バッチファイルを閉じる
000421 0521 2ACE13          16      LD  HL,(FCB_BAT)
000424 0524 3600            10      LD  (HL),0
000426 0526 ED7B0600        20      LD  SP,(SYSTEM+1)
00042A 052A C39901          10      JP  WSTART
                                
       052D                     FGETC_BAT:
00042D 052D ED5BCE13        20      LD  DE,(FCB_BAT)
       0531                     FGETC:              ;1文字ずつ読み込む
000431 0531 E5              11      PUSH    HL      ;Z:成功
000432 0532 210100          10      LD  HL,1
000435 0535 CDD603          17      CALL    S27
000438 0538 E1              10      POP HL
000439 0539 3A0080          13      LD  A,(DATA)
00043C 053C C9              10      RET
                                
       053D                     C_REM:
00043D 053D AF               4      XOR A
00043E 053E C9              10      RET
                                
       053F                     C_DEL:
00043F 053F CD5408          17      CALL    SETFCB
000442 0542 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力
000444 0544 CD0500          17      CALL    SYSTEM
000447 0547 0600             7      LD  B,0
000449 0549 3AD611          13      LD  A,(MAJOR_VER)
00044C 054C FE02             7      CP  2
00044E 054E 381E            12      JR  C,CDEL_DOS1
                                
000450 0550 215C00          10      LD  HL,FCB1
000453 0553 CDA502          17      CALL    OPEN_D2
000456 0556 37               4      SCF
       0557                     DEL1:
000457 0557 C0              11      RET NZ
000458 0558 3AE511          13      LD  A,(SEARCH_IX+14);   (FIB)属性
00045B 055B CB67             8      BIT 4,A
00045D 055D 200A            12      JR  NZ,DEL2
                                
00045F 055F 11D711          10      LD  DE,SEARCH_IX
000462 0562 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除(_DELETE)
000464 0564 CD8E03          17      CALL    SYSTEM0
000467 0567 37               4      SCF
000468 0568 C0              11      RET NZ
       0569                     DEL2:
000469 0569 CD0B03          17      CALL    OPEN2_D2
00046C 056C 18E9            12      JR  DEL1
                                
       056E                     CDEL_DOS1:
00046E 056E 0E13             7      LD  C,013H
000470 0570 1811            12      JR  CDEL1       ;(BDOS)ファイルの削除
                                
       0572                     C_REN:
000472 0572 3AD611          13      LD  A,(MAJOR_VER)
000475 0575 FE02             7      CP  2
000477 0577 3013            12      JR  NC,REN_DOS2
000479 0579 CD5408          17      CALL    SETFCB
00047C 057C 3E10             7      LD  A,010H      ;ディレクトリも対象にする(LSX-Dodgers)
00047E 057E 326900          13      LD  (FCB1+13),A ;属性
000481 0581 0E17             7      LD  C,017H      ;(BDOS)ファイル名の変更
       0583                     CDEL1:
000483 0583 115C00          10      LD  DE,FCB1
       0586                     REN2:
000486 0586 CD0500          17      CALL    SYSTEM
000489 0589 C6FF             7      ADD A,0FFH
00048B 058B C9              10      RET
                                
       058C                     REN_DOS2:           ;DOS2のリネーム(ディレクトリ対応)
00048C 058C CDE10B          17      CALL    SPCUT
00048F 058F 6B               4      LD  L,E
000490 0590 62               4      LD  H,D
       0591                     REN_D2_1:
000491 0591 7E               7      LD  A,(HL)
000492 0592 FE21             7      CP  020H+1
000494 0594 3803            12      JR  C,REN_D2_2
000496 0596 23               6      INC HL
000497 0597 18F8            12      JR  REN_D2_1
       0599                     REN_D2_2:
000499 0599 3600            10      LD  (HL),0
00049B 059B 23               6      INC HL
00049C 059C 0E4E             7      LD  C,04EH      ;(BDOS)ファイルあるいはサブディレクトリ名の変更(_RENAME)
00049E 059E 18E6            12      JR  REN2
                                
       05A0                     C_DIR:
0004A0 05A0 CDD60A          17      CALL    FILEC_D2
0004A3 05A3 21A813          10      LD  HL,FDRV+1
0004A6 05A6 CD970A          17      CALL    CWILD1
0004A9 05A9 3EF1             7      LD  A,0F1H
0004AB 05AB 32B413          13      LD  (FDRV+13),A
0004AE 05AE CDB102          17      CALL    OPEN1_D2
       05B1                     CDIR1:
0004B1 05B1 B7               4      OR  A
0004B2 05B2 2008            12      JR  NZ,PDSKF
0004B4 05B4 CD3706          17      CALL    P_NAME
0004B7 05B7 CD0B03          17      CALL    OPEN2_D2
0004BA 05BA 18F5            12      JR  CDIR1
                                
       05BC                     PDSKF:
0004BC 05BC 3AA713          13      LD  A,(FDRV)
0004BF 05BF 5F               4      LD  E,A
0004C0 05C0 0E1B             7      LD  C,01BH      ;(BDOS)ディスク情報の獲得
0004C2 05C2 CD0500          17      CALL    SYSTEM
0004C5 05C5 4F               4      LD  C,A     ;C←1クラスタ辺りの論理セクタ数
0004C6 05C6 C601             7      ADD A,001H
0004C8 05C8 D8              11      RET C       ;Aが0FFHだった場合
0004C9 05C9 3E06             7      LD  A,8-2
       05CB                     PDS1:               ;HL=未使用クラスタの総数
0004CB 05CB 3C               4      INC A
0004CC 05CC CB19             8      RR  C
0004CE 05CE 30FB            12      JR  NC,PDS1
       05D0                     PDS2:               ;B←論理セクタのサイズの上位8ビット
0004D0 05D0 3C               4      INC A
0004D1 05D1 CB18             8      RR  B
0004D3 05D3 30FB            12      JR  NC,PDS2
0004D5 05D5 47               4      LD  B,A
                                
0004D6 05D6 110000          10      LD  DE,0
       05D9                     PDS3:
0004D9 05D9 29              11      ADD HL,HL
0004DA 05DA EB               4      EX  DE,HL
0004DB 05DB ED6A            15      ADC HL,HL
0004DD 05DD EB               4      EX  DE,HL
0004DE 05DE 10F9            13      DJNZ    PDS3
       05E0                     PDSKF1:
0004E0 05E0 CDC506          17      CALL    PRDEC_DEHL
0004E3 05E3 119910          10      LD  DE,FREE
0004E6 05E6 0E09             7      LD  C,9     ;(BDOS)文字列出力
0004E8 05E8 CD0500          17      CALL    SYSTEM
0004EB 05EB CDA506          17      CALL    PUTDRV
0004EE 05EE 3E5C             7      LD  A,05CH      ;\
0004F0 05F0 CDC30A          17      CALL    MSG_A
0004F3 05F3 3AD611          13      LD  A,(MAJOR_VER)
0004F6 05F6 FE01             7      CP  1
0004F8 05F8 3865            12      JR  C,LTNL
0004FA 05FA 200E            12      JR  NZ,PDSKF2
0004FC 05FC 2AB513          16      LD  HL,(FDRV+14)
0004FF 05FF AF               4      XOR A
000500 0600 11FEFF          10      LD  DE,0-2
000503 0603 19              11      ADD HL,DE
000504 0604 23               6      INC HL
000505 0605 DCC106          17      CALL    C,PRDEC_HL
000508 0608 1855            12      JR  LTNL
       060A                     PDSKF2:             ;MSX-DOS2
00050A 060A 3AA713          13      LD  A,(FDRV)
00050D 060D 47               4      LD  B,A     ;ドライブ
00050E 060E 110080          10      LD  DE,DATA
000511 0611 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
000513 0613 CD0500          17      CALL    SYSTEM
000516 0616 210080          10      LD  HL,DATA
                                
000519 0619 CD2106          17      CALL    MSX
00051C 061C 1841            12      JR  LTNL
                                
       061E                     MSX1:
00051E 061E CDC30A          17      CALL    MSG_A
       0621                     MSX:
000521 0621 7E               7      LD  A,(HL)
000522 0622 23               6      INC HL
000523 0623 B7               4      OR  A
000524 0624 20F8            12      JR  NZ,MSX1
000526 0626 C9              10      RET
                                
       0627                     MSXSLT1:
000527 0627 CDC30A          17      CALL    MSG_A
       062A                     MSXSLT:
00052A 062A C5              11      PUSH    BC
00052B 062B E5              11      PUSH    HL
00052C 062C 78               4      LD  A,B
00052D 062D CD0C00          17      CALL    RDSLT
000530 0630 E1              10      POP HL
000531 0631 C1              10      POP BC
000532 0632 23               6      INC HL
000533 0633 B7               4      OR  A
000534 0634 20F1            12      JR  NZ,MSXSLT1
000536 0636 C9              10      RET
                                
       0637                     P_NAME:
000537 0637 217013          10      LD  HL,DTA_CCP+1
00053A 063A 7E               7      LD  A,(HL)
00053B 063B FE2E             7      CP  '.'
00053D 063D C8              11      RET Z
00053E 063E CD1B07          17      CALL    FPRNT
000541 0641 3A7B13          13      LD  A,(DTA_CCP+12)
000544 0644 CB67             8      BIT 4,A
000546 0646 280A            12      JR  Z,DIR3
000548 0648 11A710          10      LD  DE,DIRMES
00054B 064B 0E09             7      LD  C,9     ;(BDOS)文字列出力
00054D 064D CD0500          17      CALL    SYSTEM
000550 0650 180A            12      JR  DIR6
       0652                     DIR3:
000552 0652 ED5B8E13        20      LD  DE,(DTA_CCP+1+01EH)
000556 0656 2A8C13          16      LD  HL,(DTA_CCP+1+01CH)
000559 0659 CDC506          17      CALL    PRDEC_DEHL
       065C                     DIR6:
00055C 065C CD3D07          17      CALL    PRTTMS
                                
       065F                     LTNL:
00055F 065F 1E0D             7      LD  E,00DH
000561 0661 CDB20A          17      CALL    _PRINT
000564 0664 1E0A             7      LD  E,00AH
000566 0666 C3B20A          10      JP  _PRINT
                                
       0669                     C_PATH:
000569 0669 CDE10B          17      CALL    SPCUT
00056C 066C FE21             7      CP  021H
00056E 066E 301C            12      JR  NC,CPATH0
                                
000570 0670 214C11          10      LD  HL,N_PATH
000573 0673 115111          10      LD  DE,V_PATH
000576 0676 0640             7      LD  B,PATHX
000578 0678 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
00057A 067A CD0500          17      CALL    SYSTEM
00057D 067D 215111          10      LD  HL,V_PATH
       0680                     CPATHP:
000580 0680 7E               7      LD  A,(HL)
000581 0681 23               6      INC HL
000582 0682 FE20             7      CP  020H
000584 0684 3F               4      CCF
000585 0685 30D8            12      JR  NC,LTNL
000587 0687 CDC30A          17      CALL    MSG_A
00058A 068A 18F4            12      JR  CPATHP
       068C                     CPATH0:
00058C 068C 215111          10      LD  HL,V_PATH
00058F 068F FE3B             7      CP  ';'
000591 0691 2001            12      JR  NZ,CPATH1
000593 0693 13               6      INC DE
       0694                     CPATH1:
000594 0694 EB               4      EX  DE,HL
000595 0695 014000          10      LD  BC,PATHX
000598 0698 EDB0                    LDIR
                                
00059A 069A 214C11          10      LD  HL,N_PATH
00059D 069D 115111          10      LD  DE,V_PATH
0005A0 06A0 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0005A2 06A2 C30500          10      JP  SYSTEM
                                
       06A5                     PUTDRV:
0005A5 06A5 3AA713          13      LD  A,(FDRV)
0005A8 06A8 B7               4      OR  A
0005A9 06A9 200C            12      JR  NZ,PUTDRV1
0005AB 06AB C5              11      PUSH    BC
0005AC 06AC D5              11      PUSH    DE
0005AD 06AD E5              11      PUSH    HL
0005AE 06AE 0E19             7      LD  C,019H
0005B0 06B0 CD0500          17      CALL    SYSTEM
0005B3 06B3 E1              10      POP HL
0005B4 06B4 D1              10      POP DE
0005B5 06B5 C1              10      POP BC
0005B6 06B6 3C               4      INC A
       06B7                     PUTDRV1:
0005B7 06B7 C640             7      ADD A,'A'-1
0005B9 06B9 CDC30A          17      CALL    MSG_A
0005BC 06BC 3E3A             7      LD  A,':'
       06BE                     MSG_AR:
0005BE 06BE C3C30A          10      JP  MSG_A
                                
       06C1                     PRDEC_HL:
0005C1 06C1 AF               4      XOR A
       06C2                     PRDEC_AHL:
0005C2 06C2 5F               4      LD  E,A
0005C3 06C3 1600             7      LD  D,0
       06C5                     PRDEC_DEHL:
0005C5 06C5 3E02             7      LD  A,2
0005C7 06C7 321007          13      LD  (DEC6+1),A
0005CA 06CA AF               4      XOR A
0005CB 06CB E5              11      PUSH    HL
0005CC 06CC 21A113          10      LD  HL,DECBF
0005CF 06CF 0605             7      LD  B,5
0005D1 06D1 CDA80B          17      CALL    FILL_MEMORY
0005D4 06D4 E1              10      POP HL
                                
0005D5 06D5 0E20             7      LD  C,32
       06D7                     DEC1:
0005D7 06D7 29              11      ADD HL,HL
0005D8 06D8 EB               4      EX  DE,HL
0005D9 06D9 ED6A            15      ADC HL,HL
0005DB 06DB EB               4      EX  DE,HL
0005DC 06DC E5              11      PUSH    HL
0005DD 06DD 21A513          10      LD  HL,DECBF+4
0005E0 06E0 0605             7      LD  B,5
       06E2                     DEC2:
0005E2 06E2 7E               7      LD  A,(HL)
0005E3 06E3 8F               4      ADC A,A
0005E4 06E4 27               4      DAA
0005E5 06E5 77               7      LD  (HL),A
0005E6 06E6 2B               6      DEC HL
0005E7 06E7 10F9            13      DJNZ    DEC2
0005E9 06E9 E1              10      POP HL
0005EA 06EA 0D               4      DEC C
0005EB 06EB 20EA            12      JR  NZ,DEC1
                                
0005ED 06ED 21A113          10      LD  HL,DECBF
0005F0 06F0 3E20             7      LD  A,020H
0005F2 06F2 0604             7      LD  B,4
       06F4                     DEC3:
0005F4 06F4 CD0107          17      CALL    DEC4
0005F7 06F7 CD0107          17      CALL    DEC4
0005FA 06FA 23               6      INC HL
0005FB 06FB 10F7            13      DJNZ    DEC3
       06FD                     DECX:
0005FD 06FD CD0107          17      CALL    DEC4
000600 0700 AF               4      XOR A
       0701                     DEC4:
000601 0701 ED6F            18      RLD
000603 0703 FE20             7      CP  020H
000605 0705 2808            12      JR  Z,DEC6
000607 0707 F630             7      OR  030H
       0709                     DEC5:
000609 0709 18B3            12      JR  MSG_AR
       070B                     DEC7:
00060B 070B 3E20             7      LD  A,020H
00060D 070D 18AF            12      JR  MSG_AR
       070F                     DEC6:
00060F 070F 3E02             7      LD  A,2
000611 0711 B7               4      OR  A
000612 0712 28F7            12      JR  Z,DEC7
000614 0714 3D               4      DEC A
000615 0715 321007          13      LD  (DEC6+1),A
000618 0718 3E20             7      LD  A,020H
00061A 071A C9              10      RET
                                
       071B                     FPRNT:
00061B 071B 0608             7      LD  B,8
00061D 071D CD2E07          17      CALL    P_N1
000620 0720 7E               7      LD  A,(HL)
000621 0721 C680             7      ADD A,0A0H-020H
000623 0723 FEA0             7      CP  0A0H
000625 0725 2802            12      JR  Z,FPR1
000627 0727 3E2E             7      LD  A,'.'
       0729                     FPR1:
000629 0729 CDC30A          17      CALL    MSG_A
00062C 072C 0603             7      LD  B,3
                                
       072E                     P_N1:
00062E 072E C5              11      PUSH    BC
00062F 072F E5              11      PUSH    HL
000630 0730 7E               7      LD  A,(HL)
000631 0731 CD000C          17      CALL    CAP3
000634 0734 CDC30A          17      CALL    MSG_A
000637 0737 E1              10      POP HL
000638 0738 C1              10      POP BC
000639 0739 23               6      INC HL
00063A 073A 10F2            13      DJNZ    P_N1
00063C 073C C9              10      RET
                                
       073D                     PRTTMS:
00063D 073D 3E20             7      LD  A,020H
00063F 073F CDC30A          17      CALL    MSG_A
                                
000642 0742 2A8813          16      LD  HL,(DTA_CCP+1+24)
000645 0745 7D               4      LD  A,L
000646 0746 B7               4      OR  A
000647 0747 C8              11      RET Z
000648 0748 CB3C             8      SRL H
00064A 074A 17               4      RLA
00064B 074B 17               4      RLA
00064C 074C 17               4      RLA
00064D 074D 17               4      RLA
00064E 074E E60F             7      AND 00FH
000650 0750 57               4      LD  D,A
000651 0751 DD219611        14      LD  IX,V_DATE
       0755                     PRTTMS1:
000655 0755 DD7E00          19      LD  A,(IX+0)
000658 0758 B7               4      OR  A
000659 0759 2808            12      JR  Z,PRTTMS2
00065B 075B CDDE07          17      CALL    PR_DATE
00065E 075E CD4908          17      CALL    PR_DATE_SPLITER
000661 0761 18F2            12      JR  PRTTMS1
       0763                     PRTTMS2:
                                
000663 0763 CDDF0C          17      CALL    GET_WIDTH
000666 0766 FE21             7      CP  32+1
000668 0768 3005            12      JR  NC,SHOW_TIME
00066A 076A 3E1D             7      LD  A,01DH
00066C 076C C3C30A          10      JP  MSG_A
       076F                     SHOW_TIME:
00066F 076F 2A8613          16      LD  HL,(DTA_CCP+1+22)
                                
000672 0772 3E20             7      LD  A,020H
000674 0774 CDC30A          17      CALL    MSG_A
000677 0777 7C               4      LD  A,H
000678 0778 65               4      LD  H,L
000679 0779 1F               4      RRA
00067A 077A CB1D             8      RR  L
00067C 077C 1F               4      RRA
00067D 077D CB1D             8      RR  L
00067F 077F 1F               4      RRA
000680 0780 CB1D             8      RR  L
000682 0782 E61F             7      AND 01FH
000684 0784 4F               4      LD  C,A
000685 0785 3ABB11          13      LD  A,(V_TIME)
000688 0788 FE31             7      CP  '1'
00068A 078A 79               4      LD  A,C
00068B 078B 200B            12      JR  NZ,TIME24
00068D 078D FE0C             7      CP  12
00068F 078F 3802            12      JR  C,TIME12
000691 0791 D60C             7      SUB 12
       0793                     TIME12:
000693 0793 B7               4      OR  A
000694 0794 2002            12      JR  NZ,TIME24
000696 0796 C60C             7      ADD A,12
       0798                     TIME24:
000698 0798 C5              11      PUSH    BC
000699 0799 CDC907          17      CALL    PRDEC_A
00069C 079C 3E3A             7      LD  A,':'
00069E 079E CDC30A          17      CALL    MSG_A
0006A1 07A1 7D               4      LD  A,L
0006A2 07A2 0F               4      RRCA
0006A3 07A3 0F               4      RRCA
0006A4 07A4 E63F             7      AND 03FH
0006A6 07A6 CDC907          17      CALL    PRDEC_A
                                
0006A9 07A9 3E3A             7      LD  A,':'
0006AB 07AB CDC30A          17      CALL    MSG_A
0006AE 07AE 7C               4      LD  A,H
0006AF 07AF E61F             7      AND 01FH
0006B1 07B1 87               4      ADD A,A
0006B2 07B2 CDC907          17      CALL    PRDEC_A
                                
0006B5 07B5 3ABB11          13      LD  A,(V_TIME)
0006B8 07B8 FE31             7      CP  '1'
0006BA 07BA C1              10      POP BC
0006BB 07BB C0              11      RET NZ
0006BC 07BC 79               4      LD  A,C
0006BD 07BD 1E61             7      LD  E,'a'
0006BF 07BF FE0C             7      CP  12
0006C1 07C1 DAB20A          10      JP  C,_PRINT
0006C4 07C4 1E70             7      LD  E,'p'
0006C6 07C6 C3B20A          10      JP  _PRINT
                                
                                ;   PRINT10
                                
       07C9                     PRDEC_A:
0006C9 07C9 E5              11      PUSH    HL
0006CA 07CA 0608             7      LD  B,8
0006CC 07CC 4F               4      LD  C,A
0006CD 07CD AF               4      XOR A
       07CE                     PRTA1:
0006CE 07CE CB01             8      RLC C
0006D0 07D0 8F               4      ADC A,A
0006D1 07D1 27               4      DAA
0006D2 07D2 10FA            13      DJNZ    PRTA1
0006D4 07D4 21A113          10      LD  HL,DECBF
0006D7 07D7 77               7      LD  (HL),A
0006D8 07D8 AF               4      XOR A
0006D9 07D9 CDFD06          17      CALL    DECX
0006DC 07DC E1              10      POP HL
0006DD 07DD C9              10      RET
                                
       07DE                     PR_DATE:
0006DE 07DE DD7E00          19      LD  A,(IX+0)
0006E1 07E1 FE20             7      CP  020H
0006E3 07E3 D8              11      RET C
0006E4 07E4 CDF40B          17      CALL    CAP
0006E7 07E7 FE44             7      CP  'D'
0006E9 07E9 2848            12      JR  Z,PR_DAY
0006EB 07EB FE4D             7      CP  'M'
0006ED 07ED 2820            12      JR  Z,PR_MONTH
0006EF 07EF FE59             7      CP  'Y'
0006F1 07F1 2046            12      JR  NZ,PR_DATE1
0006F3 07F3 4F               4      LD  C,A
0006F4 07F4 DD7E02          19      LD  A,(IX+2)
0006F7 07F7 CDF40B          17      CALL    CAP
0006FA 07FA B9               4      CP  C
0006FB 07FB 200A            12      JR  NZ,YEAR2
0006FD 07FD 7C               4      LD  A,H     ;YEAR
0006FE 07FE C6EC             7      ADD A,80+256-100
000700 0800 3E13             7      LD  A,19
000702 0802 CE00             7      ADC A,0
000704 0804 CDC907          17      CALL    PRDEC_A     ;年4桁
       0807                     YEAR2:
000707 0807 7C               4      LD  A,H     ;YEAR
000708 0808 C650             7      ADD A,80
00070A 080A CDC907          17      CALL    PRDEC_A
00070D 080D 182A            12      JR  PR_DATE1
       080F                     PR_MONTH:
00070F 080F 4F               4      LD  C,A
000710 0810 DD7E02          19      LD  A,(IX+2)
000713 0813 CDF40B          17      CALL    CAP
000716 0816 B9               4      CP  C
000717 0817 2014            12      JR  NZ,MONTH2
000719 0819 E5              11      PUSH    HL      ;月を文字列で表示 Jan等
00071A 081A D5              11      PUSH    DE
00071B 081B 7A               4      LD  A,D
00071C 081C 3D               4      DEC A
00071D 081D 87               4      ADD A,A
00071E 081E 87               4      ADD A,A
00071F 081F 21D510          10      LD  HL,S_MONTH
000722 0822 1600             7      LD  D,0
000724 0824 5F               4      LD  E,A
000725 0825 19              11      ADD HL,DE
000726 0826 CD2106          17      CALL    MSX
000729 0829 D1              10      POP DE
00072A 082A E1              10      POP HL
00072B 082B 180C            12      JR  PR_DATE1
       082D                     MONTH2:
00072D 082D 7A               4      LD  A,D     ;月を数字で表示
00072E 082E CDC907          17      CALL    PRDEC_A
000731 0831 1806            12      JR  PR_DATE1
       0833                     PR_DAY:
000733 0833 7D               4      LD  A,L
000734 0834 E61F             7      AND 01FH
000736 0836 CDC907          17      CALL    PRDEC_A
       0839                     PR_DATE1:
000739 0839 DD23            10      INC IX
00073B 083B DD7E00          19      LD  A,(IX+0)
00073E 083E CDF40B          17      CALL    CAP
000741 0841 FE41             7      CP  'A'
000743 0843 D8              11      RET C
000744 0844 FE5B             7      CP  'Z'+1
000746 0846 38F1            12      JR  C,PR_DATE1
000748 0848 C9              10      RET
       0849                     PR_DATE_SPLITER:
000749 0849 DD7E00          19      LD  A,(IX+0)
00074C 084C FE20             7      CP  020H
00074E 084E D8              11      RET C
00074F 084F DD23            10      INC IX
000751 0851 C3C30A          10      JP  MSG_A
                                
       0854                     SETFCB:
000754 0854 CDE10B          17      CALL    SPCUT
000757 0857 1A               7      LD  A,(DE)
000758 0858 FE20             7      CP  020H
00075A 085A 3801            12      JR  C,SETFCBA
00075C 085C 1B               6      DEC DE
       085D                     SETFCBA:
00075D 085D D5              11      PUSH    DE
00075E 085E 215C00          10      LD  HL,FCB1
000761 0861 115D00          10      LD  DE,FCB1+1
000764 0864 012300          10      LD  BC,00023H
000767 0867 70               7      LD  (HL),B      ;B=0
000768 0868 EDB0                    LDIR
00076A 086A D1              10      POP DE
00076B 086B D5              11      PUSH    DE
00076C 086C 215C00          10      LD  HL,FCB1
00076F 086F DD219E12        14      LD  IX,PATH_FN1
000773 0873 CD850C          17      CALL    _SYS29      ;ファイル名の解析
000776 0876 216C00          10      LD  HL,FCB2
000779 0879 DD21DE12        14      LD  IX,PATH_FN2
00077D 087D CD850C          17      CALL    _SYS29      ;ファイル名の解析
000780 0880 E1              10      POP HL
000781 0881 010050          10      LD  BC,05000H
000784 0884 118100          10      LD  DE,00081H
       0887                     SETFCB1:
000787 0887 7E               7      LD  A,(HL)
000788 0888 23               6      INC HL
000789 0889 FE20             7      CP  020H
00078B 088B 3805            12      JR  C,SETFCB2
00078D 088D 12               7      LD  (DE),A
00078E 088E 13               6      INC DE
00078F 088F 0C               4      INC C
000790 0890 10F5            13      DJNZ    SETFCB1
       0892                     SETFCB2:
000792 0892 79               4      LD  A,C
000793 0893 328000          13      LD  (DTA1),A
000796 0896 04               4      INC B
000797 0897 AF               4      XOR A
       0898                     SETFCB3:
000798 0898 12               7      LD  (DE),A
000799 0899 13               6      INC DE
00079A 089A 10FC            13      DJNZ    SETFCB3
00079C 089C C9              10      RET
                                
       089D                     C_COPY:
00079D 089D CD5408          17      CALL    SETFCB
0007A0 08A0 3AD611          13      LD  A,(MAJOR_VER)
0007A3 08A3 FE02             7      CP  2
0007A5 08A5 380D            12      JR  C,COPYI0
0007A7 08A7 CDF20C          17      CALL    IS_FOLDER_FN2
0007AA 08AA 3808            12      JR  C,COPYI0
0007AC 08AC 21A813          10      LD  HL,FDRV+1
0007AF 08AF 060B             7      LD  B,8+3
0007B1 08B1 CDA60B          17      CALL    FILE10
       08B4                     COPYI0:
0007B4 08B4 3AA713          13      LD  A,(FDRV)
0007B7 08B7 47               4      LD  B,A
0007B8 08B8 B7               4      OR  A
0007B9 08B9 200B            12      JR  NZ,COPYI1
0007BB 08BB C5              11      PUSH    BC
0007BC 08BC 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0007BE 08BE CD0500          17      CALL    SYSTEM
0007C1 08C1 3C               4      INC A
0007C2 08C2 32A713          13      LD  (FDRV),A
0007C5 08C5 C1              10      POP BC
       08C6                     COPYI1:
0007C6 08C6 C640             7      ADD A,040H
0007C8 08C8 321E13          13      LD  (CUR_DRV),A
0007CB 08CB 112113          10      LD  DE,CUR_PATH
0007CE 08CE 0E59             7      LD  C,059H      ;(BDOS)カレントディレクトリの獲得(_GETCD)
0007D0 08D0 CD0500          17      CALL    SYSTEM
0007D3 08D3 CDE508          17      CALL    COPYSUB
       08D6                     RES_CUR_PATH:
0007D6 08D6 111E13          10      LD  DE,CUR_DRV
       08D9                     SET_CUR_PATH:
0007D9 08D9 F5              11      PUSH    AF
0007DA 08DA 3AA713          13      LD  A,(FDRV)
0007DD 08DD 47               4      LD  B,A
0007DE 08DE 0E5A             7      LD  C,05AH      ;(BDOS)カレントディレクトリの変更(_CHDIR)
0007E0 08E0 CD0500          17      CALL    SYSTEM
0007E3 08E3 F1              10      POP AF
0007E4 08E4 C9              10      RET
       08E5                     COPYSUB:
0007E5 08E5 11CD13          10      LD  DE,ZERO
0007E8 08E8 CDFC0A          17      CALL    FILEC2
0007EB 08EB 216C00          10      LD  HL,FCB2
0007EE 08EE CDC90C          17      CALL    S29X1
                                
0007F1 08F1 3E10             7      LD  A,010H
0007F3 08F3 326900          13      LD  (FCB1+13),A
0007F6 08F6 216D00          10      LD  HL,FCB2+1
0007F9 08F9 CD970A          17      CALL    CWILD1
       08FC                     COPY0:
0007FC 08FC CD940A          17      CALL    CWILD
0007FF 08FF 215C00          10      LD  HL,FCB1
000802 0902 CDA502          17      CALL    OPEN_D2
000805 0905 37               4      SCF
       0906                     COPY1:
000806 0906 C0              11      RET NZ
000807 0907 CD2103          17      CALL    DEFCB_D2
                                
00080A 090A 3A7B13          13      LD  A,(DTA_CCP+12)
00080D 090D CB67             8      BIT 4,A
00080F 090F 2821            12      JR  Z,COPY1A
                                
000811 0911 215D00          10      LD  HL,FCB1+1
000814 0914 CD2D0C          17      CALL    CHKWILD
000817 0917 3811            12      JR  C,COPY9
                                
000819 0919 3E20             7      LD  A,020H
00081B 091B 325D00          13      LD  (FCB1+1),A
00081E 091E 2A8913          16      LD  HL,(DTA_CCP+26)
000821 0921 23               6      INC HL
000822 0922 226A00          16      LD  (FCB1+14),HL
000825 0925 18D5            12      JR  COPY0
                                
       0927                     COPY8:
000827 0927 CDE80D          17      CALL    SHOW_OK
       092A                     COPY9:
00082A 092A CDD608          17      CALL    RES_CUR_PATH
00082D 092D CD0B03          17      CALL    OPEN2_D2
000830 0930 18D4            12      JR  COPY1
                                
       0932                     COPY1A:
000832 0932 216C00          10      LD  HL,FCB2
000835 0935 11A713          10      LD  DE,FDRV
000838 0938 017113          10      LD  BC,DTA_CCP+2
00083B 093B EDA0            16      LDI
00083D 093D 3E0B             7      LD  A,11
       093F                     COPY2:
00083F 093F F5              11      PUSH    AF
000840 0940 7E               7      LD  A,(HL)
000841 0941 FE3F             7      CP  '?'
000843 0943 2001            12      JR  NZ,COPY3
000845 0945 0A               7      LD  A,(BC)
       0946                     COPY3:
000846 0946 12               7      LD  (DE),A
000847 0947 03               6      INC BC
000848 0948 13               6      INC DE
000849 0949 23               6      INC HL
00084A 094A F1              10      POP AF
00084B 094B 3D               4      DEC A
00084C 094C 20F1            12      JR  NZ,COPY2
00084E 094E 010500          10      LD  BC,16-11
000851 0951 EDB0                    LDIR
       0953                     PUTNAME:
000853 0953 215D00          10      LD  HL,FCB1+1
000856 0956 CD2D0C          17      CALL    CHKWILD
000859 0959 300B            12      JR  NC,PUTN1
00085B 095B 21A813          10      LD  HL,FDRV+1
00085E 095E CD1B07          17      CALL    FPRNT
000861 0961 3E20             7      LD  A,020H
000863 0963 CDC30A          17      CALL    MSG_A
       0966                     PUTN1:
000866 0966 11DE12          10      LD  DE,PATH_FN2
000869 0969 CDD908          17      CALL    SET_CUR_PATH
                                
00086C 096C 11A713          10      LD  DE,FDRV
00086F 096F 0E16             7      LD  C,016H      ;(BDOS)ファイルの作成
000871 0971 CD8E03          17      CALL    SYSTEM0
000874 0974 C2150A          10      JP  NZ,COPYE2
000877 0977 67               4      LD  H,A     ;A=0
000878 0978 6F               4      LD  L,A
000879 0979 22C813          16      LD  (FDRV+33),HL    ;(FCB)ランダム・レコード
00087C 097C 22CA13          16      LD  (FDRV+35),HL
00087F 097F 2C               4      INC L       ;HL=1
000880 0980 22B513          16      LD  (FDRV+14),HL    ;(FCB)レコード・サイズ
       0983                     COPY6:
000883 0983 CDA60A          17      CALL    BUFSIZ
000886 0986 CDAE03          17      CALL    S27DTA_D2
000889 0989 47               4      LD  B,A
00088A 098A 3C               4      INC A
00088B 098B CA040A          10      JP  Z,COPYE
00088E 098E 7C               4      LD  A,H
00088F 098F B5               4      OR  L
000890 0990 280F            12      JR  Z,COPY7
000892 0992 11A713          10      LD  DE,FDRV
000895 0995 C5              11      PUSH    BC
000896 0996 0E26             7      LD  C,026H      ;(BDOS)ランダム・ブロック・ライト
000898 0998 CD0500          17      CALL    SYSTEM
00089B 099B C1              10      POP BC
00089C 099C B7               4      OR  A
00089D 099D 2065            12      JR  NZ,COPYE
00089F 099F 10E2            13      DJNZ    COPY6
       09A1                     COPY7:
0008A1 09A1 3AD611          13      LD  A,(MAJOR_VER)
0008A4 09A4 FE02             7      CP  2
0008A6 09A6 3011            12      JR  NC,COPY7_MSX2   ;DOS2はFCBの仕様が違う
0008A8 09A8 3A7C13          13      LD  A,(DTA_CCP+13)  ;(FCB)属性(アトリビュート)
0008AB 09AB 32B413          13      LD  (FDRV+13),A ;(FCB)属性(アトリビュート)
0008AE 09AE 218313          10      LD  HL,DTA_CCP+20
0008B1 09B1 11BB13          10      LD  DE,FDRV+20  ;(FCB)更新日時
0008B4 09B4 010400          10      LD  BC,4
0008B7 09B7 EDB0                    LDIR
       09B9                     COPY7_MSX2:
0008B9 09B9 11A713          10      LD  DE,FDRV
0008BC 09BC 0E10             7      LD  C,010H      ;(BDOS)ファイルのクローズ
0008BE 09BE CD8E03          17      CALL    SYSTEM0
                                
0008C1 09C1 2041            12      JR  NZ,COPYE
0008C3 09C3 3AD611          13      LD  A,(MAJOR_VER)
0008C6 09C6 FE02             7      CP  2
0008C8 09C8 3837            12      JR  C,COPY_DOS2DT
                                
0008CA 09CA ED4B1712        20      LD  BC,(HANDLE1)
0008CE 09CE 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
0008D0 09D0 CD0500          17      CALL    SYSTEM
                                
0008D3 09D3 11DE12          10      LD  DE,PATH_FN2
0008D6 09D6 CDD908          17      CALL    SET_CUR_PATH
                                
0008D9 09D9 11A713          10      LD  DE,FDRV
0008DC 09DC 216113          10      LD  HL,DOS2NAME
0008DF 09DF CD170A          17      CALL    FCB2FNAME
                                
0008E2 09E2 3AE511          13      LD  A,(SEARCH_IX+14);   (FIB)属性
0008E5 09E5 6F               4      LD  L,A
0008E6 09E6 116113          10      LD  DE,DOS2NAME
0008E9 09E9 3E01             7      LD  A,1
0008EB 09EB 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
0008ED 09ED CD8E03          17      CALL    SYSTEM0
                                
0008F0 09F0 DD2AE611        20      LD  IX,(SEARCH_IX+15)   ;(FIB)更新時間
0008F4 09F4 2AE811          16      LD  HL,(SEARCH_IX+17)   ;(FIB)更新日
0008F7 09F7 116113          10      LD  DE,DOS2NAME
0008FA 09FA 3E01             7      LD  A,1
0008FC 09FC 0E51             7      LD  C,51H       ;(BDOS)_FTIME ファイルの日付および時刻の獲得・設定
0008FE 09FE CD8E03          17      CALL    SYSTEM0
       0A01                     COPY_DOS2DT:
000901 0A01 C32709          10      JP  COPY8
                                
       0A04                     COPYE:
000904 0A04 ED4B1712        20      LD  BC,(HANDLE1)
000908 0A08 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
00090A 0A0A CD0500          17      CALL    SYSTEM
00090D 0A0D 11A713          10      LD  DE,FDRV
000910 0A10 0E13             7      LD  C,013H      ;(BDOS)ファイルの削除
000912 0A12 CD0500          17      CALL    SYSTEM
       0A15                     COPYE2:
000915 0A15 37               4      SCF
000916 0A16 C9              10      RET
                                
       0A17                     FCB2FNAME:
000917 0A17 1A               7      LD  A,(DE)
000918 0A18 13               6      INC DE
000919 0A19 C640             7      ADD A,040H
00091B 0A1B 77               7      LD  (HL),A
00091C 0A1C 23               6      INC HL
00091D 0A1D 363A            10      LD  (HL),':'
00091F 0A1F 23               6      INC HL
                                
000920 0A20 0608             7      LD  B,8
       0A22                     FCB2FNAME1:
000922 0A22 1A               7      LD  A,(DE)
000923 0A23 FE21             7      CP  020H+1
000925 0A25 3807            12      JR  C,FCB2FNAME2
000927 0A27 13               6      INC DE
000928 0A28 77               7      LD  (HL),A
000929 0A29 23               6      INC HL
00092A 0A2A 10F6            13      DJNZ    FCB2FNAME1
00092C 0A2C 1803            12      JR  FCB2FNAME3
       0A2E                     FCB2FNAME2:
00092E 0A2E 13               6      INC DE
00092F 0A2F 10FD            13      DJNZ    FCB2FNAME2
       0A31                     FCB2FNAME3:
000931 0A31 1A               7      LD  A,(DE)
000932 0A32 FE21             7      CP  020H+1
000934 0A34 380F            12      JR  C,FCB2FNAME5
000936 0A36 362E            10      LD  (HL),'.'
000938 0A38 23               6      INC HL
000939 0A39 0603             7      LD  B,3
       0A3B                     FCB2FNAME4:
00093B 0A3B 1A               7      LD  A,(DE)
00093C 0A3C 13               6      INC DE
00093D 0A3D FE21             7      CP  020H+1
00093F 0A3F 3804            12      JR  C,FCB2FNAME5
000941 0A41 77               7      LD  (HL),A
000942 0A42 23               6      INC HL
000943 0A43 10F6            13      DJNZ    FCB2FNAME4
       0A45                     FCB2FNAME5:
000945 0A45 3600            10      LD  (HL),0
000947 0A47 C9              10      RET
                                
       0A48                     C_TYPE:
000948 0A48 CD5408          17      CALL    SETFCB
00094B 0A4B 215C00          10      LD  HL,FCB1
00094E 0A4E CDA502          17      CALL    OPEN_D2
000951 0A51 37               4      SCF
       0A52                     TYPE1:
000952 0A52 C0              11      RET NZ
000953 0A53 CD2103          17      CALL    DEFCB_D2
000956 0A56 3E1A             7      LD  A,01AH
000958 0A58 CDC30A          17      CALL    MSG_A
       0A5B                     TYPE2:
00095B 0A5B CDA60A          17      CALL    BUFSIZ
00095E 0A5E CDAE03          17      CALL    S27DTA_D2
000961 0A61 C6FE             7      ADD A,0FEH
000963 0A63 D8              11      RET C
000964 0A64 7C               4      LD  A,H
000965 0A65 B5               4      OR  L
000966 0A66 281A            12      JR  Z,TYPEE
000968 0A68 010080          10      LD  BC,DATA
       0A6B                     TYPE3:
00096B 0A6B 0A               7      LD  A,(BC)
00096C 0A6C 03               6      INC BC
00096D 0A6D FE1A             7      CP  01AH
00096F 0A6F 2811            12      JR  Z,TYPEE
000971 0A71 5F               4      LD  E,A
000972 0A72 C5              11      PUSH    BC
000973 0A73 E5              11      PUSH    HL
000974 0A74 0E02             7      LD  C,2     ;(BDOS)コンソール出力
000976 0A76 CD0500          17      CALL    SYSTEM
000979 0A79 E1              10      POP HL
00097A 0A7A C1              10      POP BC
00097B 0A7B 2B               6      DEC HL
00097C 0A7C 7C               4      LD  A,H
00097D 0A7D B5               4      OR  L
00097E 0A7E 20EB            12      JR  NZ,TYPE3
000980 0A80 18D9            12      JR  TYPE2
       0A82                     TYPEE:
000982 0A82 3AD611          13      LD  A,(MAJOR_VER)   ;DOS2対応
000985 0A85 FE02             7      CP  2
000987 0A87 3806            12      JR  C,TYPEE2
000989 0A89 ED4B1712        20      LD  BC,(HANDLE1)
00098D 0A8D 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
       0A8F                     TYPEE2:
00098F 0A8F CD0B03          17      CALL    OPEN2_D2
000992 0A92 18BE            12      JR  TYPE1
                                
       0A94                     CWILD:
000994 0A94 215D00          10      LD  HL,FCB1+1
       0A97                     CWILD1:
000997 0A97 7E               7      LD  A,(HL)
000998 0A98 FE20             7      CP  020H
00099A 0A9A C0              11      RET NZ
       0A9B                     CWILD2:
00099B 0A9B 54               4      LD  D,H
00099C 0A9C 5D               4      LD  E,L
00099D 0A9D 13               6      INC DE
00099E 0A9E 010A00          10      LD  BC,10
0009A1 0AA1 363F            10      LD  (HL),'?'
0009A3 0AA3 EDB0                    LDIR
0009A5 0AA5 C9              10      RET
                                
       0AA6                     BUFSIZ:
0009A6 0AA6 3A0700          13      LD  A,(SYSTEM+2)
0009A9 0AA9 D681             7      SUB (DATA/256)+1
0009AB 0AAB E6F8             7      AND 0F8H
0009AD 0AAD 67               4      LD  H,A
0009AE 0AAE 2E00             7      LD  L,0
0009B0 0AB0 C9              10      RET
                                
0009B1 0AB1 E9               4  JP_HL:  JP  (HL)
                                
       0AB2                     _PRINT:
0009B2 0AB2 C5              11      PUSH    BC
0009B3 0AB3 D5              11      PUSH    DE
0009B4 0AB4 E5              11      PUSH    HL
0009B5 0AB5 DDE5            15      PUSH    IX
0009B7 0AB7 0E06             7      LD  C,6
0009B9 0AB9 CD0500          17      CALL    SYSTEM
0009BC 0ABC DDE1            14      POP IX
0009BE 0ABE E1              10      POP HL
0009BF 0ABF D1              10      POP DE
0009C0 0AC0 C1              10      POP BC
0009C1 0AC1 B7               4      OR  A
0009C2 0AC2 C9              10      RET
                                
       0AC3                     MSG_A:
0009C3 0AC3 F5              11      PUSH    AF
0009C4 0AC4 C5              11      PUSH    BC
0009C5 0AC5 D5              11      PUSH    DE
0009C6 0AC6 E5              11      PUSH    HL
0009C7 0AC7 DDE5            15      PUSH    IX
0009C9 0AC9 5F               4      LD  E,A
0009CA 0ACA 0E02             7      LD  C,2
0009CC 0ACC CD0500          17      CALL    SYSTEM
0009CF 0ACF DDE1            14      POP IX
0009D1 0AD1 E1              10      POP HL
0009D2 0AD2 D1              10      POP DE
0009D3 0AD3 C1              10      POP BC
0009D4 0AD4 F1              10      POP AF
0009D5 0AD5 C9              10      RET
                                ;       FILE
       0AD6                     FILEC_D2:       ;DOS2対応
0009D6 0AD6 3AD611          13      LD  A,(MAJOR_VER)
0009D9 0AD9 FE02             7      CP  2
0009DB 0ADB 381C            12      JR  C,FILEC
0009DD 0ADD C5              11      PUSH    BC
0009DE 0ADE D5              11      PUSH    DE
0009DF 0ADF E5              11      PUSH    HL
0009E0 0AE0 CDE10B          17      CALL    SPCUT
0009E3 0AE3 211E12          10      LD  HL,PATH_CCP
0009E6 0AE6 0640             7      LD  B,64
       0AE8                     PATHCD1:
0009E8 0AE8 1A               7      LD  A,(DE)
0009E9 0AE9 13               6      INC DE
0009EA 0AEA FE20             7      CP  020H
0009EC 0AEC 3002            12      JR  NC,PATHCD2
0009EE 0AEE 3E00             7      LD  A,0
       0AF0                     PATHCD2:
0009F0 0AF0 77               7      LD  (HL),A
0009F1 0AF1 3803            12      JR  C,PATHCD3
0009F3 0AF3 23               6      INC HL
0009F4 0AF4 10F2            13      DJNZ    PATHCD1
       0AF6                     PATHCD3:
0009F6 0AF6 E1              10      POP HL
0009F7 0AF7 D1              10      POP DE
0009F8 0AF8 C1              10      POP BC
       0AF9                     FILEC:
0009F9 0AF9 CD040B          17      CALL    FILE
       0AFC                     FILEC2:
0009FC 0AFC 3AA813          13      LD  A,(FDRV+1)
0009FF 0AFF FE20             7      CP  020H
000A01 0B01 C8              11      RET Z
000A02 0B02 1839            12      JR  SETDIR1
                                
       0B04                     FILE:
000A04 0B04 AF               4      XOR A
000A05 0B05 32A713          13      LD  (FDRV),A
000A08 0B08 67               4      LD  H,A
000A09 0B09 6F               4      LD  L,A
000A0A 0B0A 22B513          16      LD  (FDRV+14),HL
000A0D 0B0D CDE10B          17      CALL    SPCUT
000A10 0B10 CDC60B          17      CALL    CCHK3
000A13 0B13 2812            12      JR  Z,DEVI1
000A15 0B15 13               6      INC DE
000A16 0B16 1A               7      LD  A,(DE)
000A17 0B17 1B               6      DEC DE
000A18 0B18 FE3A             7      CP  ':'
000A1A 0B1A 200B            12      JR  NZ,DEVI1
000A1C 0B1C 1A               7      LD  A,(DE)      ;DRIVE
000A1D 0B1D CDF40B          17      CALL    CAP
000A20 0B20 D640             7      SUB '@'
000A22 0B22 13               6      INC DE
000A23 0B23 13               6      INC DE
000A24 0B24 32A713          13      LD  (FDRV),A
       0B27                     DEVI1:
000A27 0B27 1A               7      LD  A,(DE)
000A28 0B28 D65C             7      SUB 05CH        ;\
000A2A 0B2A 2009            12      JR  NZ,NOROOT
000A2C 0B2C 6F               4      LD  L,A     ;A=0でH=0のはずなのでHL=0
000A2D 0B2D 22C113          16      LD  (FDRV+26),HL
000A30 0B30 2C               4      INC L
000A31 0B31 22B513          16      LD  (FDRV+14),HL
000A34 0B34 13               6      INC DE
       0B35                     NOROOT:
                                
       0B35                     SETDIR:
000A35 0B35 CD660B          17      CALL    FILED
000A38 0B38 1A               7      LD  A,(DE)
000A39 0B39 FE5C             7      CP  05CH        ;\
000A3B 0B3B C0              11      RET NZ
000A3C 0B3C 13               6      INC DE
       0B3D                     SETDIR1:
000A3D 0B3D 3AD611          13      LD  A,(MAJOR_VER)
000A40 0B40 FE01             7      CP  1
000A42 0B42 C0              11      RET NZ
                                                ;for LSX-Dodgers
000A43 0B43 3E10             7      LD  A,010H      ;Directory
000A45 0B45 32B413          13      LD  (FDRV+13),A
000A48 0B48 D5              11      PUSH    DE
000A49 0B49 11A713          10      LD  DE,FDRV
000A4C 0B4C 0E0F             7      LD  C,00FH
000A4E 0B4E CD0500          17      CALL    SYSTEM
000A51 0B51 D1              10      POP DE
000A52 0B52 B7               4      OR  A
000A53 0B53 C0              11      RET NZ
                                
000A54 0B54 3AB413          13      LD  A,(FDRV+13)
000A57 0B57 CB67             8      BIT 4,A
000A59 0B59 C8              11      RET Z
                                
000A5A 0B5A CDAD0B          17      CALL    FILEI
000A5D 0B5D 2AC113          16      LD  HL,(FDRV+26)
000A60 0B60 23               6      INC HL
000A61 0B61 22B513          16      LD  (FDRV+14),HL
000A64 0B64 18CF            12      JR  SETDIR
                                
       0B66                     FILED:
000A66 0B66 CDAD0B          17      CALL    FILEI
                                
000A69 0B69 0608             7      LD  B,8
       0B6B                     FILE2:
000A6B 0B6B CDBB0B          17      CALL    CCHKF
000A6E 0B6E C8              11      RET Z
000A6F 0B6F FE2A             7      CP  '*'
000A71 0B71 282E            12      JR  Z,FILE9
000A73 0B73 FE2E             7      CP  '.'
000A75 0B75 280C            12      JR  Z,FILE4
000A77 0B77 77               7      LD  (HL),A
000A78 0B78 23               6      INC HL
000A79 0B79 10F0            13      DJNZ    FILE2
                                
       0B7B                     FILE3:
000A7B 0B7B CDBB0B          17      CALL    CCHKF
000A7E 0B7E C8              11      RET Z
000A7F 0B7F FE2E             7      CP  '.'
000A81 0B81 20F8            12      JR  NZ,FILE3
                                
       0B83                     FILE4:
000A83 0B83 21B013          10      LD  HL,FNAME+8
000A86 0B86 0603             7      LD  B,3
                                
       0B88                     FILE4L:
000A88 0B88 CDBB0B          17      CALL    CCHKF
000A8B 0B8B C8              11      RET Z
000A8C 0B8C FE2E             7      CP  '.'
000A8E 0B8E 2008            12      JR  NZ,FILE12
000A90 0B90 32A813          13      LD  (FNAME),A   ;Parent directory(..)
000A93 0B93 32A913          13      LD  (FNAME+1),A
000A96 0B96 3E20             7      LD  A,020H
       0B98                     FILE12:
000A98 0B98 FE2A             7      CP  '*'
000A9A 0B9A 280A            12      JR  Z,FILE10
000A9C 0B9C 77               7      LD  (HL),A
000A9D 0B9D 23               6      INC HL
000A9E 0B9E 10E8            13      DJNZ    FILE4L
000AA0 0BA0 C9              10      RET
                                
       0BA1                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000AA1 0BA1 CDA60B          17      CALL    FILE10
000AA4 0BA4 18D5            12      JR  FILE3
                                
       0BA6                     FILE10:
000AA6 0BA6 3E3F             7      LD  A,'?'
                                
       0BA8                     FILL_MEMORY:                ;HLからBバイトAで埋める
000AA8 0BA8 77               7      LD  (HL),A
000AA9 0BA9 23               6      INC HL
000AAA 0BAA 10FC            13      DJNZ    FILL_MEMORY
000AAC 0BAC C9              10      RET
                                
       0BAD                     FILEI:              ;名前＋拡張子をスペースで初期化
000AAD 0BAD 3E20             7      LD  A,020H
000AAF 0BAF 01000B          10      LD  BC,11*256
000AB2 0BB2 21A813          10      LD  HL,FNAME
000AB5 0BB5 E5              11      PUSH    HL
000AB6 0BB6 CDA80B          17      CALL    FILL_MEMORY
000AB9 0BB9 E1              10      POP HL
000ABA 0BBA C9              10      RET
                                
       0BBB                     CCHKF:
000ABB 0BBB 1A               7      LD  A,(DE)
000ABC 0BBC CDC30B          17      CALL    CCHK2
000ABF 0BBF C8              11      RET Z
000AC0 0BC0 C3160C          10      JP  FKAN
                                
       0BC3                     CCHK2:
000AC3 0BC3 0C               4      INC C
000AC4 0BC4 0D               4      DEC C
000AC5 0BC5 C0              11      RET NZ
       0BC6                     CCHK3:              ;ZF=1 で使えない文字
000AC6 0BC6 FE2B             7      CP  '+'
000AC8 0BC8 C8              11      RET Z
000AC9 0BC9 FE2C             7      CP  ','
000ACB 0BCB C8              11      RET Z
000ACC 0BCC FE2F             7      CP  '/'
000ACE 0BCE C8              11      RET Z
000ACF 0BCF FE3A             7      CP  ':'
000AD1 0BD1 C8              11      RET Z
000AD2 0BD2 FE3B             7      CP  ';'
000AD4 0BD4 C8              11      RET Z
000AD5 0BD5 FE3D             7      CP  '='
000AD7 0BD7 C8              11      RET Z
000AD8 0BD8 FE5C             7      CP  05CH    ;\
000ADA 0BDA C8              11      RET Z
000ADB 0BDB FE20             7      CP  020H
000ADD 0BDD D0              11      RET NC
000ADE 0BDE BF               4      CP  A       ;Z=1
000ADF 0BDF C9              10      RET
                                
       0BE0                     SS1:
000AE0 0BE0 13               6      INC DE
       0BE1                     SPCUT:              ;スペースをカット
000AE1 0BE1 1A               7      LD  A,(DE)
000AE2 0BE2 FE20             7      CP  020H
000AE4 0BE4 28FA            12      JR  Z,SS1
000AE6 0BE6 C9              10      RET
                                
       0BE7                     TOZERO:
000AE7 0BE7 D5              11      PUSH    DE
       0BE8                     TZ1:
000AE8 0BE8 1A               7      LD  A,(DE)
000AE9 0BE9 FE20             7      CP  20H
000AEB 0BEB 3803            12      JR  C,TZ2
000AED 0BED 13               6      INC DE
000AEE 0BEE 18F8            12      JR  TZ1
       0BF0                     TZ2:
000AF0 0BF0 AF               4      XOR A
000AF1 0BF1 12               7      LD  (DE),A
000AF2 0BF2 D1              10      POP DE
000AF3 0BF3 C9              10      RET
                                
       0BF4                     CAP:
000AF4 0BF4 FE61             7      CP  'a'
000AF6 0BF6 D8              11      RET C
000AF7 0BF7 FE7B             7      CP  'z'+1
000AF9 0BF9 D0              11      RET NC
000AFA 0BFA D620             7      SUB 020H
000AFC 0BFC C9              10      RET
       0BFD                     CAP2:
000AFD 0BFD CDF40B          17      CALL    CAP
       0C00                     CAP3:
000B00 0C00 CD090C          17      CALL    CAP4
000B03 0C03 FE21             7      CP  021H
000B05 0C05 D0              11      RET NC
000B06 0C06 3E20             7      LD  A,020H
000B08 0C08 C9              10      RET
       0C09                     CAP4:
000B09 0C09 FE05             7      CP  5
000B0B 0C0B C0              11      RET NZ
000B0C 0C0C 3EE5             7      LD  A,0E5H
000B0E 0C0E C9              10      RET
                                
       0C0F                     FKANC:
000B0F 0C0F CB41             8      BIT 0,C
000B11 0C11 CCFD0B          17      CALL    Z,CAP2
000B14 0C14 1801            12      JR  FKANX
       0C16                     FKAN:           ;漢字チェック
000B16 0C16 13               6      INC DE
       0C17                     FKANX:
000B17 0C17 CB41             8      BIT 0,C
000B19 0C19 CB81             8      RES 0,C
000B1B 0C1B C0              11      RET NZ
000B1C 0C1C FE80             7      CP  080H
000B1E 0C1E D8              11      RET C
000B1F 0C1F FEA0             7      CP  0A0H
000B21 0C21 3803            12      JR  C,FKAN1
000B23 0C23 FEE0             7      CP  0E0H
000B25 0C25 D8              11      RET C
       0C26                     FKAN1:
000B26 0C26 0C               4      INC C
000B27 0C27 A7               4      AND A
000B28 0C28 C9              10      RET
                                
       0C29                     CHKWILDX:
000B29 0C29 FDE5            15      PUSH    IY
000B2B 0C2B E1              10      POP HL
000B2C 0C2C 23               6      INC HL
       0C2D                     CHKWILD:
000B2D 0C2D 060B             7      LD  B,11
000B2F 0C2F 3E3F             7      LD  A,'?'
       0C31                     CHKWIL1:
000B31 0C31 BE               7      CP  (HL)
000B32 0C32 23               6      INC HL
000B33 0C33 37               4      SCF
000B34 0C34 C8              11      RET Z
000B35 0C35 10FA            13      DJNZ    CHKWIL1
000B37 0C37 AF               4      XOR A
000B38 0C38 C9              10      RET
                                
       0C39                     CPNAME:
000B39 0C39 C5              11      PUSH    BC
000B3A 0C3A D5              11      PUSH    DE
000B3B 0C3B 119613          10      LD  DE,CPBUF
000B3E 0C3E 010700          10      LD  BC,7
000B41 0C41 EDB0                    LDIR
000B43 0C43 D1              10      POP DE
000B44 0C44 D5              11      PUSH    DE
000B45 0C45 E5              11      PUSH    HL
000B46 0C46 219613          10      LD  HL,CPBUF
000B49 0C49 CD5C0C          17      CALL    CPFILE
000B4C 0C4C E1              10      POP HL
000B4D 0C4D D1              10      POP DE
000B4E 0C4E C1              10      POP BC
000B4F 0C4F 2005            12      JR  NZ,CPNAME1
000B51 0C51 7E               7      LD  A,(HL)
000B52 0C52 23               6      INC HL
000B53 0C53 66               7      LD  H,(HL)
000B54 0C54 6F               4      LD  L,A
000B55 0C55 C9              10      RET
       0C56                     CPNAME1:
000B56 0C56 23               6      INC HL
000B57 0C57 23               6      INC HL
000B58 0C58 10DF            13      DJNZ    CPNAME
000B5A 0C5A 37               4      SCF
000B5B 0C5B C9              10      RET
                                
       0C5C                     CPFILE:
000B5C 0C5C C5              11      PUSH    BC
000B5D 0C5D 01000B          10      LD  BC,00B00H
       0C60                     CPSTR1:
000B60 0C60 1A               7      LD  A,(DE)
000B61 0C61 FE3F             7      CP  '?'     ;Wild card
000B63 0C63 2812            12      JR  Z,CPSTR2
000B65 0C65 7E               7      LD  A,(HL)
000B66 0C66 CD0F0C          17      CALL    FKANC
000B69 0C69 E5              11      PUSH    HL
000B6A 0C6A 67               4      LD  H,A
000B6B 0C6B 1A               7      LD  A,(DE)
000B6C 0C6C CB01             8      RLC C
000B6E 0C6E CD0F0C          17      CALL    FKANC
000B71 0C71 CB09             8      RRC C
000B73 0C73 BC               4      CP  H       ;CP (HL),(DE)
000B74 0C74 E1              10      POP HL
000B75 0C75 2004            12      JR  NZ,CPSTR3
       0C77                     CPSTR2:
000B77 0C77 13               6      INC DE
000B78 0C78 23               6      INC HL
000B79 0C79 10E5            13      DJNZ    CPSTR1
       0C7B                     CPSTR3:
000B7B 0C7B C1              10      POP BC
000B7C 0C7C C9              10      RET
                                
       0C7D                     CPFILE2:
000B7D 0C7D FD7E0D          19      LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
000B80 0C80 F6E1             7      OR  0E1H
000B82 0C82 2F               4      CPL
000B83 0C83 A6               7      AND (HL)
000B84 0C84 C9              10      RET
                                
       0C85                     _SYS29:     ;(BDOS)ファイル名の解析
000B85 0C85 C5              11      PUSH    BC
000B86 0C86 D5              11      PUSH    DE
000B87 0C87 0640             7      LD  B,64
000B89 0C89 CDE10B          17      CALL    SPCUT
000B8C 0C8C DD229413        20      LD  (DIR_CK),IX
       0C90                     D2FN1:
000B90 0C90 1A               7      LD  A,(DE)
000B91 0C91 FE21             7      CP  020H+1
000B93 0C93 3808            12      JR  C,D2FN2
000B95 0C95 13               6      INC DE
000B96 0C96 DD7700          19      LD  (IX+0),A
000B99 0C99 DD23            10      INC IX
000B9B 0C9B 10F3            13      DJNZ    D2FN1
       0C9D                     D2FN2:
000B9D 0C9D DD360000        19      LD  (IX+0),0
000BA1 0CA1 DD7EFF          19      LD  A,(IX-1)
000BA4 0CA4 FE5C             7      CP  05CH        ;\
000BA6 0CA6 2018            12      JR  NZ,D2FN3
000BA8 0CA8 DD7EFE          19      LD  A,(IX-2)
000BAB 0CAB FE3A             7      CP  ':'
000BAD 0CAD 2811            12      JR  Z,D2FN3
                                
000BAF 0CAF DD36FF00        19      LD  (IX-1),0
000BB3 0CB3 ED5B9413        20      LD  DE,(DIR_CK)
000BB7 0CB7 CD380D          17      CALL    IS_FOLDER
000BBA 0CBA 3804            12      JR  C,D2FN3
       0CBC                     D2FN4:
000BBC 0CBC DD36FF5C        19      LD  (IX-1),05CH ;\
       0CC0                     D2FN3:
000BC0 0CC0 D1              10      POP DE
000BC1 0CC1 C1              10      POP BC
000BC2 0CC2 C5              11      PUSH    BC
000BC3 0CC3 E5              11      PUSH    HL
000BC4 0CC4 CD040B          17      CALL    FILE
000BC7 0CC7 E1              10      POP HL
000BC8 0CC8 C1              10      POP BC
       0CC9                     S29X1:
000BC9 0CC9 C5              11      PUSH    BC
000BCA 0CCA D5              11      PUSH    DE
000BCB 0CCB E5              11      PUSH    HL
000BCC 0CCC EB               4      EX  DE,HL
000BCD 0CCD 21A713          10      LD  HL,FDRV
000BD0 0CD0 010D00          10      LD  BC,13
000BD3 0CD3 EDB0                    LDIR
000BD5 0CD5 70               7      LD  (HL),B      ;B=0
000BD6 0CD6 0E03             7      LD  C,3
000BD8 0CD8 EDB0                    LDIR
000BDA 0CDA E1              10      POP HL
000BDB 0CDB D1              10      POP DE
000BDC 0CDC C1              10      POP BC
000BDD 0CDD AF               4      XOR A
000BDE 0CDE C9              10      RET
       0CDF                     GET_WIDTH:
000BDF 0CDF 3AD511          13      LD  A,(IS_MSX)
000BE2 0CE2 B7               4      OR  A
000BE3 0CE3 2804            12      JR  Z,NOT_MSX
000BE5 0CE5 3AB0F3          13      LD  A,(LINLEN)
000BE8 0CE8 C9              10      RET
       0CE9                     NOT_MSX:
000BE9 0CE9 E5              11      PUSH    HL
000BEA 0CEA 2A0100          16      LD  HL,(1)
000BED 0CED 2EB1             7      LD  L,0B1H
000BEF 0CEF 7E               7      LD  A,(HL)
000BF0 0CF0 E1              10      POP HL
000BF1 0CF1 C9              10      RET
                                
       0CF2                     IS_FOLDER_FN2:
000BF2 0CF2 11DE12          10      LD  DE,PATH_FN2
000BF5 0CF5 CD4F0D          17      CALL    IS_FOLDER2
000BF8 0CF8 D8              11      RET C
                                
000BF9 0CF9 110000          10      LD  DE,0
000BFC 0CFC ED53D213        20      LD  (PATH_FN2_SL),DE
000C00 0D00 11DE12          10      LD  DE,PATH_FN2
       0D03                     IF2_1:
000C03 0D03 1A               7      LD  A,(DE)
000C04 0D04 13               6      INC DE
000C05 0D05 FE5C             7      CP  '\\'
000C07 0D07 2004            12      JR  NZ,IF2_2
000C09 0D09 ED53D213        20      LD  (PATH_FN2_SL),DE
       0D0D                     IF2_2:
000C0D 0D0D B7               4      OR  A
000C0E 0D0E 20F3            12      JR  NZ,IF2_1
000C10 0D10 ED5BD213        20      LD  DE,(PATH_FN2_SL)
000C14 0D14 7A               4      LD  A,D
000C15 0D15 B3               4      OR  E
000C16 0D16 280F            12      JR  Z,IS_FOLDER_FN2_E
000C18 0D18 AF               4      XOR A
000C19 0D19 1B               6      DEC DE
000C1A 0D1A 12               7      LD  (DE),A
                                
000C1B 0D1B 11DE12          10      LD  DE,PATH_FN2
000C1E 0D1E CD380D          17      CALL    IS_FOLDER
000C21 0D21 3009            12      JR  NC,IS2_3
000C23 0D23 3E5C             7      LD  A,'\\'
000C25 0D25 1B               6      DEC DE
000C26 0D26 12               7      LD  (DE),A
       0D27                     IS_FOLDER_FN2_E:
000C27 0D27 11DE12          10      LD  DE,PATH_FN2
000C2A 0D2A 37               4      SCF
000C2B 0D2B C9              10      RET
       0D2C                     IS2_3:
000C2C 0D2C ED5BD213        20      LD  DE,(PATH_FN2_SL)
000C30 0D30 216C00          10      LD  HL,FCB2
000C33 0D33 CD850C          17      CALL    _SYS29
000C36 0D36 37               4      SCF
000C37 0D37 C9              10      RET
                                
       0D38                     IS_FOLDER:          ;out CF=0:Folder
000C38 0D38 CDE10B          17      CALL    SPCUT
000C3B 0D3B 1A               7      LD  A,(DE)
000C3C 0D3C C6FF             7      ADD A,0FFH
000C3E 0D3E D0              11      RET NC
000C3F 0D3F AF               4      XOR A
000C40 0D40 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C42 0D42 D5              11      PUSH    DE
000C43 0D43 CD8E03          17      CALL    SYSTEM0
000C46 0D46 D1              10      POP DE
000C47 0D47 37               4      SCF
000C48 0D48 C0              11      RET NZ
000C49 0D49 7D               4      LD  A,L
000C4A 0D4A E610             7      AND 010H
000C4C 0D4C D601             7      SUB 1
000C4E 0D4E C9              10      RET
                                
       0D4F                     IS_FOLDER2:         ;out CF=0:Folder
000C4F 0D4F CDE10B          17      CALL    SPCUT
000C52 0D52 1A               7      LD  A,(DE)
000C53 0D53 C6FF             7      ADD A,0FFH
000C55 0D55 D0              11      RET NC
000C56 0D56 AF               4      XOR A
000C57 0D57 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C59 0D59 D5              11      PUSH    DE
000C5A 0D5A CD8E03          17      CALL    SYSTEM0
000C5D 0D5D D1              10      POP DE
000C5E 0D5E C0              11      RET NZ
000C5F 0D5F 7D               4      LD  A,L
000C60 0D60 E610             7      AND 010H
000C62 0D62 D601             7      SUB 1
000C64 0D64 C9              10      RET
                                
       0D65                     C_MODE:
000C65 0D65 3AD511          13      LD  A,(IS_MSX)
000C68 0D68 B7               4      OR  A
000C69 0D69 C8              11      RET Z
000C6A 0D6A 0E29             7      LD  C,41
000C6C 0D6C 3AF8FA          13      LD  A,(EXBRSA)
000C6F 0D6F B7               4      OR  A
000C70 0D70 2802            12      JR  Z,MODE_MSX1
000C72 0D72 0E51             7      LD  C,81
       0D74                     MODE_MSX1:
000C74 0D74 C5              11      PUSH    BC
000C75 0D75 CDCD0F          17      CALL    GETNUM
000C78 0D78 C1              10      POP BC
000C79 0D79 7D               4      LD  A,L
000C7A 0D7A B9               4      CP  C
000C7B 0D7B 301C            12      JR  NC,MODE1
000C7D 0D7D B7               4      OR  A
000C7E 0D7E 2819            12      JR  Z,MODE1
000C80 0D80 FE21             7      CP  33
000C82 0D82 381E            12      JR  C,MODE32
000C84 0D84 32AEF3          13      LD  (LINL40),A
000C87 0D87 DD216C00        14      LD  IX,INITXT
000C8B 0D8B CD920D          17      CALL    CALLROM
000C8E 0D8E DD217800        14      LD  IX,SETTXT
       0D92                     CALLROM:
000C92 0D92 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000C96 0D96 C31C00          10      JP  CALSLT
       0D99                     MODE1:
000C99 0D99 3AB0F3          13      LD  A,(LINLEN)
000C9C 0D9C CDC907          17      CALL    PRDEC_A
000C9F 0D9F C35F06          10      JP  LTNL
       0DA2                     MODE32:
000CA2 0DA2 32AFF3          13      LD  (LINL32),A
000CA5 0DA5 DD216F00        14      LD  IX,INIT32
000CA9 0DA9 CD920D          17      CALL    CALLROM
000CAC 0DAC DD217B00        14      LD  IX,SETT32
000CB0 0DB0 18E0            12      JR  CALLROM
                                
       0DB2                     C_PAUSE:
000CB2 0DB2 CDE10B          17      CALL    SPCUT
000CB5 0DB5 EB               4      EX  DE,HL
000CB6 0DB6 7E               7      LD  A,(HL)
000CB7 0DB7 B7               4      OR  A
000CB8 0DB8 2003            12      JR  NZ,C_PAUSE1
000CBA 0DBA 21BA10          10      LD  HL,PAUSE
       0DBD                     C_PAUSE1:
000CBD 0DBD CD2106          17      CALL    MSX
000CC0 0DC0 0E07             7      LD  C,7     ;(BDOS)コンソール直接入力(_DIRIN)
000CC2 0DC2 CD0500          17      CALL    SYSTEM
000CC5 0DC5 FE03             7      CP  3
000CC7 0DC7 CA2105          10      JP  Z,END_BATCH
000CCA 0DCA C35F06          10      JP  LTNL
                                
       0DCD                     C_ECHO:
000CCD 0DCD CDE10B          17      CALL    SPCUT
000CD0 0DD0 EB               4      EX  DE,HL
000CD1 0DD1 CD2106          17      CALL    MSX
000CD4 0DD4 C35F06          10      JP  LTNL
                                
       0DD7                     C_MKDIR:
000CD7 0DD7 CDE10B          17      CALL    SPCUT
000CDA 0DDA 014490          10      LD  BC,09044H   ;B=新規作成+ディレクトリ/C=(BDOS)ファイルハンドルの作成(_CREATE)
000CDD 0DDD CD0500          17      CALL    SYSTEM
000CE0 0DE0 C6FF             7      ADD A,0FFH
000CE2 0DE2 D8              11      RET C
000CE3 0DE3 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
000CE5 0DE5 CD0500          17      CALL    SYSTEM
       0DE8                     SHOW_OK:
000CE8 0DE8 11B010          10      LD  DE,OK
000CEB 0DEB 0E09             7      LD  C,9     ;(BDOS)文字列出力
000CED 0DED CD0500          17      CALL    SYSTEM
000CF0 0DF0 C35F06          10      JP  LTNL
                                
       0DF3                     C_RMDIR:
000CF3 0DF3 CD380D          17      CALL    IS_FOLDER
000CF6 0DF6 D8              11      RET C
000CF7 0DF7 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除
000CF9 0DF9 CD0500          17      CALL    SYSTEM
000CFC 0DFC C6FF             7      ADD A,0FFH
000CFE 0DFE D8              11      RET C
000CFF 0DFF 18E7            12      JR  SHOW_OK
                                
       0E01                     C_SET:
000D01 0E01 CDE10B          17      CALL    SPCUT
000D04 0E04 ED53170E        20      LD  (CSET_PARAM),DE
       0E08                     CSET2:
000D08 0E08 1A               7      LD  A,(DE)
000D09 0E09 FE20             7      CP  020H
000D0B 0E0B 3838            12      JR  C,CSET_LIST
000D0D 0E0D D63D             7      SUB '='
000D0F 0E0F 2803            12      JR  Z,CSET_SET
000D11 0E11 13               6      INC DE
000D12 0E12 18F4            12      JR  CSET2
       0E14                     CSET_SET:
000D14 0E14 12               7      LD  (DE),A
000D15 0E15 13               6      INC DE
       0E17                     CSET_PARAM  EQU $+1
000D16 0E16 210000          10      LD  HL,0
000D19 0E19 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000D1B 0E1B CD0500          17      CALL    SYSTEM
       0E1E                     INIT_VAR:           ;環境変数の初期化
000D1E 0E1E 219111          10      LD  HL,N_DATE
000D21 0E21 119611          10      LD  DE,V_DATE
000D24 0E24 0610             7      LD  B,16
000D26 0E26 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D28 0E28 CD0500          17      CALL    SYSTEM
                                
000D2B 0E2B 21B611          10      LD  HL,N_TIME
000D2E 0E2E 11BB11          10      LD  DE,V_TIME
000D31 0E31 0603             7      LD  B,3
000D33 0E33 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D35 0E35 CD0500          17      CALL    SYSTEM
                                
000D38 0E38 210511          10      LD  HL,N_APPEND
000D3B 0E3B 110C11          10      LD  DE,V_APPEND
000D3E 0E3E 0640             7      LD  B,PATHX
000D40 0E40 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D42 0E42 C30500          10      JP  SYSTEM
                                
       0E45                     CSET_LIST:
000D45 0E45 3E0A             7      LD  A,10
000D47 0E47 32D413          13      LD  (CSET_DATA),A
000D4A 0E4A 110100          10      LD  DE,1
       0E4D                     CSET1:
000D4D 0E4D D5              11      PUSH    DE
000D4E 0E4E 016DFF          10      LD  BC,0FF6DH   ;_FENV 環境変数の検索
000D51 0E51 21D613          10      LD  HL,DATA_COM
000D54 0E54 3600            10      LD  (HL),0
000D56 0E56 CD0500          17      CALL    SYSTEM
000D59 0E59 B7               4      OR  A
000D5A 0E5A 2030            12      JR  NZ,CSET_ERROR
000D5C 0E5C 21D613          10      LD  HL,DATA_COM
000D5F 0E5F 7E               7      LD  A,(HL)
000D60 0E60 B7               4      OR  A
000D61 0E61 2829            12      JR  Z,CSET_ERROR
000D63 0E63 CD2106          17      CALL    MSX
000D66 0E66 1E3D             7      LD  E,'='
000D68 0E68 CDB20A          17      CALL    _PRINT
000D6B 0E6B 21D613          10      LD  HL,DATA_COM
000D6E 0E6E 11D614          10      LD  DE,DATA_COM+256
000D71 0E71 016BFF          10      LD  BC,0FF6BH   ;_GENV 環境変数の獲得
000D74 0E74 CD0500          17      CALL    SYSTEM
000D77 0E77 21D614          10      LD  HL,DATA_COM+256
000D7A 0E7A CD2106          17      CALL    MSX
000D7D 0E7D CD5F06          17      CALL    LTNL
000D80 0E80 3E0A             7      LD  A,10
000D82 0E82 32D413          13      LD  (CSET_DATA),A
       0E85                     CSET_NEXT:
000D85 0E85 D1              10      POP DE
000D86 0E86 13               6      INC DE
000D87 0E87 7A               4      LD  A,D
000D88 0E88 B3               4      OR  E
000D89 0E89 20C2            12      JR  NZ,CSET1
000D8B 0E8B C9              10      RET
       0E8C                     CSET_ERROR:
000D8C 0E8C 21D413          10      LD  HL,CSET_DATA
000D8F 0E8F 35              11      DEC (HL)
000D90 0E90 20F3            12      JR  NZ,CSET_NEXT
       0E92                     CSET_END:
000D92 0E92 D1              10      POP DE
000D93 0E93 C9              10      RET
                                
       0E94                     C_FORMAT:
000D94 0E94 3AD511          13      LD  A,(IS_MSX)
000D97 0E97 B7               4      OR  A
000D98 0E98 C8              11      RET Z
000D99 0E99 3AD611          13      LD  A,(MAJOR_VER)
000D9C 0E9C FE02             7      CP  2
000D9E 0E9E 300B            12      JR  NC,FORMAT2
       0EA0                     FORMAT1:
000DA0 0EA0 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000DA4 0EA4 DD214701        14      LD  IX,FORMAT
000DA8 0EA8 C31C00          10      JP  CALSLT
       0EAB                     FORMAT2:
000DAB 0EAB CD5408          17      CALL    SETFCB
000DAE 0EAE 3A5C00          13      LD  A,(FCB1)
000DB1 0EB1 B7               4      OR  A
000DB2 0EB2 28EC            12      JR  Z,FORMAT1
000DB4 0EB4 47               4      LD  B,A
000DB5 0EB5 AF               4      XOR A
000DB6 0EB6 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000DB8 0EB8 CD0500          17      CALL    SYSTEM
000DBB 0EBB B7               4      OR  A
000DBC 0EBC 20E2            12      JR  NZ,FORMAT1
000DBE 0EBE CD2A06          17      CALL    MSXSLT
000DC1 0EC1 21D211          10      LD  HL,PROMPT
000DC4 0EC4 CD2106          17      CALL    MSX
       0EC7                     FORMAT3:
000DC7 0EC7 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DC9 0EC9 CD0500          17      CALL    SYSTEM
000DCC 0ECC D631             7      SUB '0'+1
000DCE 0ECE 38F7            12      JR  C,FORMAT3
000DD0 0ED0 3C               4      INC A
000DD1 0ED1 FE0A             7      CP  10
000DD3 0ED3 30F2            12      JR  NC,FORMAT3
000DD5 0ED5 F5              11      PUSH    AF
000DD6 0ED6 CD5F06          17      CALL    LTNL
000DD9 0ED9 21BA10          10      LD  HL,PAUSE
000DDC 0EDC CD2106          17      CALL    MSX
000DDF 0EDF 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DE1 0EE1 CD0500          17      CALL    SYSTEM
000DE4 0EE4 CD5F06          17      CALL    LTNL
000DE7 0EE7 F1              10      POP AF
000DE8 0EE8 ED4B5B00        20      LD  BC,(FCB1-1)
000DEC 0EEC 210080          10      LD  HL,08000H
000DEF 0EEF 110040          10      LD  DE,04000H
000DF2 0EF2 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000DF4 0EF4 C30500          10      JP  SYSTEM
                                
       0EF7                     C_RAMDISK:
000DF7 0EF7 3AD511          13      LD  A,(IS_MSX)
000DFA 0EFA B7               4      OR  A
000DFB 0EFB C8              11      RET Z
000DFC 0EFC 3AD611          13      LD  A,(MAJOR_VER)
000DFF 0EFF FE02             7      CP  2
000E01 0F01 D8              11      RET C
000E02 0F02 CDE10B          17      CALL    SPCUT
000E05 0F05 1A               7      LD  A,(DE)
000E06 0F06 FE30             7      CP  '0'
000E08 0F08 D8              11      RET C
000E09 0F09 FE3A             7      CP  '9'+1
000E0B 0F0B 3F               4      CCF
000E0C 0F0C D8              11      RET C
000E0D 0F0D CDCD0F          17      CALL    GETNUM
000E10 0F10 110F00          10      LD  DE,15       ;切り上げの為
000E13 0F13 19              11      ADD HL,DE
000E14 0F14 7D               4      LD  A,L
000E15 0F15 0604             7      LD  B,4     ;16で割る
       0F17                     RAMDISK1:
000E17 0F17 CB3C             8      SRL H   ;/2
000E19 0F19 1F               4      RRA
000E1A 0F1A 10FB            13      DJNZ    RAMDISK1
000E1C 0F1C FEFF             7      CP  0FFH
000E1E 0F1E 2001            12      JR  NZ,RAMDISK2
000E20 0F20 3D               4      DEC A
       0F21                     RAMDISK2:
000E21 0F21 47               4      LD  B,A
000E22 0F22 0E68             7      LD  C,068H      ;(_RAMD)RAMディスクの作成あるいは消去
000E24 0F24 CD0500          17      CALL    SYSTEM
000E27 0F27 B7               4      OR  A
000E28 0F28 CCE80D          17      CALL    Z,SHOW_OK
000E2B 0F2B C9              10      RET
                                
       0F2C                     C_ATTRIB:
000E2C 0F2C 3AD511          13      LD  A,(IS_MSX)
000E2F 0F2F B7               4      OR  A
000E30 0F30 C8              11      RET Z
000E31 0F31 3AD611          13      LD  A,(MAJOR_VER)
000E34 0F34 FE02             7      CP  2
000E36 0F36 D8              11      RET C
000E37 0F37 ED53580F        20      LD  (ATTRIB_OPT),DE
                                                ;パス名を検索
       0F3B                     ATTRIB1:
000E3B 0F3B CDE10B          17      CALL    SPCUT
000E3E 0F3E 1A               7      LD  A,(DE)
000E3F 0F3F 13               6      INC DE
000E40 0F40 FE20             7      CP  ' '
000E42 0F42 D8              11      RET C
000E43 0F43 FE41             7      CP  'A'
000E45 0F45 3003            12      JR  NC,ATTRIB2
000E47 0F47 13               6      INC DE
000E48 0F48 18F1            12      JR  ATTRIB1
       0F4A                     ATTRIB2:
000E4A 0F4A 1B               6      DEC DE
000E4B 0F4B ED53C00F        20      LD  (ATTRIB_PATH),DE
000E4F 0F4F AF               4      XOR A
000E50 0F50 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000E52 0F52 CD8E03          17      CALL    SYSTEM0
000E55 0F55 37               4      SCF
000E56 0F56 C0              11      RET NZ
                                
000E57 0F57 110000          10      LD  DE,0
       0F58                     ATTRIB_OPT  EQU $-2
       0F5A                     ATTRIB3:
000E5A 0F5A CDE10B          17      CALL    SPCUT
000E5D 0F5D 1A               7      LD  A,(DE)
000E5E 0F5E 13               6      INC DE
000E5F 0F5F FE41             7      CP  'A'
000E61 0F61 305C            12      JR  NC,ATTRIB_WRITE
000E63 0F63 FE2D             7      CP  '-'
000E65 0F65 280A            12      JR  Z,ATTRIB_M
000E67 0F67 FE2B             7      CP  '+'
000E69 0F69 282D            12      JR  Z,ATTRIB_P
000E6B 0F6B FE2F             7      CP  '/'
000E6D 0F6D 1A               7      LD  A,(DE)
000E6E 0F6E 13               6      INC DE
000E6F 0F6F 18E9            12      JR  ATTRIB3
       0F71                     ATTRIB_M:
000E71 0F71 1A               7      LD  A,(DE)
000E72 0F72 13               6      INC DE
000E73 0F73 CDF40B          17      CALL    CAP
000E76 0F76 FE41             7      CP  'A'
000E78 0F78 280E            12      JR  Z,ATTRIB_M_A
000E7A 0F7A FE53             7      CP  'S'
000E7C 0F7C 280E            12      JR  Z,ATTRIB_M_S
000E7E 0F7E FE48             7      CP  'H'
000E80 0F80 280E            12      JR  Z,ATTRIB_M_H
000E82 0F82 FE52             7      CP  'R'
000E84 0F84 280E            12      JR  Z,ATTRIB_M_R
000E86 0F86 18D2            12      JR  ATTRIB3
       0F88                     ATTRIB_M_A:
000E88 0F88 CBAD             8      RES 5,L
000E8A 0F8A 18CE            12      JR  ATTRIB3
       0F8C                     ATTRIB_M_S:
000E8C 0F8C CB95             8      RES 2,L
000E8E 0F8E 18CA            12      JR  ATTRIB3
       0F90                     ATTRIB_M_H:
000E90 0F90 CB8D             8      RES 1,L
000E92 0F92 18C6            12      JR  ATTRIB3
       0F94                     ATTRIB_M_R:
000E94 0F94 CB85             8      RES 0,L
000E96 0F96 18C2            12      JR  ATTRIB3
       0F98                     ATTRIB_P:
000E98 0F98 1A               7      LD  A,(DE)
000E99 0F99 13               6      INC DE
000E9A 0F9A CDF40B          17      CALL    CAP
000E9D 0F9D FE41             7      CP  'A'
000E9F 0F9F 280E            12      JR  Z,ATTRIB_P_A
000EA1 0FA1 FE53             7      CP  'S'
000EA3 0FA3 280E            12      JR  Z,ATTRIB_P_S
000EA5 0FA5 FE48             7      CP  'H'
000EA7 0FA7 280E            12      JR  Z,ATTRIB_P_H
000EA9 0FA9 FE52             7      CP  'R'
000EAB 0FAB 280E            12      JR  Z,ATTRIB_P_R
000EAD 0FAD 18AB            12      JR  ATTRIB3
       0FAF                     ATTRIB_P_A:
000EAF 0FAF CBED             8      SET 5,L
000EB1 0FB1 18A7            12      JR  ATTRIB3
       0FB3                     ATTRIB_P_S:
000EB3 0FB3 CBD5             8      SET 2,L
000EB5 0FB5 18A3            12      JR  ATTRIB3
       0FB7                     ATTRIB_P_H:
000EB7 0FB7 CBCD             8      SET 1,L
000EB9 0FB9 189F            12      JR  ATTRIB3
       0FBB                     ATTRIB_P_R:
000EBB 0FBB CBC5             8      SET 0,L
000EBD 0FBD 189B            12      JR  ATTRIB3
       0FBF                     ATTRIB_WRITE:
000EBF 0FBF 110000          10      LD  DE,0
       0FC0                     ATTRIB_PATH EQU $-2
000EC2 0FC2 3E01             7      LD  A,1
000EC4 0FC4 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000EC6 0FC6 CD8E03          17      CALL    SYSTEM0
000EC9 0FC9 D8              11      RET C
000ECA 0FCA C3E80D          10      JP  SHOW_OK
                                
       0FCD                     GETNUM:
000ECD 0FCD CDE10B          17      CALL    SPCUT
000ED0 0FD0 210000          10      LD  HL,0
       0FD3                     GETNUM1:
000ED3 0FD3 1A               7      LD  A,(DE)
000ED4 0FD4 13               6      INC DE
000ED5 0FD5 D630             7      SUB '0'
000ED7 0FD7 D8              11      RET C
000ED8 0FD8 FE0A             7      CP  10
000EDA 0FDA D0              11      RET NC
000EDB 0FDB 4D               4      LD  C,L
000EDC 0FDC 44               4      LD  B,H
000EDD 0FDD 29              11      ADD HL,HL   ;*2
000EDE 0FDE 29              11      ADD HL,HL   ;*4
000EDF 0FDF 09              11      ADD HL,BC   ;*5
000EE0 0FE0 29              11      ADD HL,HL   ;*10
000EE1 0FE1 4F               4      LD  C,A
000EE2 0FE2 0600             7      LD  B,0
000EE4 0FE4 09              11      ADD HL,BC
000EE5 0FE5 18EC            12      JR  GETNUM1
                                
       0FE7                     CHDIR:
000EE7 0FE7 3AD611          13      LD  A,(MAJOR_VER)
000EEA 0FEA FE02             7      CP  2
000EEC 0FEC D8              11      RET C
000EED 0FED C5              11      PUSH    BC
000EEE 0FEE E5              11      PUSH    HL
000EEF 0FEF 0E5A             7      LD  C,05AH      ;(BDOS)_CHDIR カレントディレクトリの変更
000EF1 0FF1 CD0500          17      CALL    SYSTEM
000EF4 0FF4 E1              10      POP HL
000EF5 0FF5 C1              10      POP BC
000EF6 0FF6 C9              10      RET
                                
       0012                     COMS    EQU 18
       0FF7                     COMTB:
000EF7 0FF7 44202020202020          DB  "D      "   ;1
000EFE 0FFE A005                    DW  C_DIR
000F00 1000 44495220202020          DB  "DIR    "   ;2
000F07 1007 A005                    DW  C_DIR
000F09 1009 434F5059202020          DB  "COPY   "   ;3
000F10 1010 9D08                    DW  C_COPY
000F12 1012 43442020202020          DB  "CD     "   ;4
000F19 1019 9303                    DW  C_CD
000F1B 101B 44454C20202020          DB  "DEL    "   ;5
000F22 1022 3F05                    DW  C_DEL
000F24 1024 50415448202020          DB  "PATH   "   ;6
000F2B 102B 6906                    DW  C_PATH
000F2D 102D 52454E20202020          DB  "REN    "   ;7
000F34 1034 7205                    DW  C_REN
000F36 1036 54595045202020          DB  "TYPE   "   ;8
000F3D 103D 480A                    DW  C_TYPE
000F3F 103F 52454D20202020          DB  "REM    "   ;9
000F46 1046 3D05                    DW  C_REM
000F48 1048 4D4F4445202020          DB  "MODE   "   ;10
000F4F 104F 650D                    DW  C_MODE
000F51 1051 50415553452020          DB  "PAUSE  "   ;11
000F58 1058 B20D                    DW  C_PAUSE
000F5A 105A 53455420202020          DB  "SET    "   ;12
000F61 1061 010E                    DW  C_SET
000F63 1063 4543484F202020          DB  "ECHO   "   ;13
000F6A 106A CD0D                    DW  C_ECHO
000F6C 106C 4D4B4449522020          DB  "MKDIR  "   ;14
000F73 1073 D70D                    DW  C_MKDIR
000F75 1075 524D4449522020          DB  "RMDIR  "   ;15
000F7C 107C F30D                    DW  C_RMDIR
000F7E 107E 464F524D415420          DB  "FORMAT "   ;16
000F85 1085 940E                    DW  C_FORMAT
000F87 1087 52414D4449534B          DB  "RAMDISK"   ;17
000F8E 108E F70E                    DW  C_RAMDISK
000F90 1090 41545452494220          DB  "ATTRIB "   ;18
000F97 1097 2C0F                    DW  C_ATTRIB
                                
000F99 1099 2062797465732066    FREE:   DB  " bytes free  $"
            726565202024        
000FA7 10A7 2020203C4449523E    DIRMES: DB  "   <DIR>$"
            24                  
000FB0 10B0 4F4B24              OK: DB  "OK$"
000FB3 10B3 4572726F722124      COMERM: DB  "Error!$"
000FBA 10BA 537472696B652061    PAUSE:  DB  "Strike any key when ready ",0
            6E79206B65792077    
            68656E2072656164    
            792000              
                                
       10D5                     S_MONTH:
000FD5 10D5 4A616E00                DB  "Jan",0
000FD9 10D9 46656200                DB  "Feb",0
000FDD 10DD 4D617200                DB  "Mar",0
000FE1 10E1 41707200                DB  "Apr",0
000FE5 10E5 4D617900                DB  "May",0
000FE9 10E9 4A756E00                DB  "Jun",0
000FED 10ED 4A756C00                DB  "Jul",0
000FF1 10F1 41756700                DB  "Aug",0
000FF5 10F5 53657000                DB  "Sep",0
000FF9 10F9 4F637400                DB  "Oct",0
000FFD 10FD 4E6F7600                DB  "Nov",0
001001 1101 44656300                DB  "Dec",0
                                
       1105                     N_APPEND:
001005 1105 415050454E4400          DB  "APPEND",0
       110C                     V_APPEND:
00100C 110C                         DS  64
       114C                     N_PATH:
00104C 114C 5041544800              DB  "PATH",0
       1151                     V_PATH:
001051 1151                         DS  PATHX
       1191                     N_DATE:
001091 1191 4441544500              DB  "DATE",0
       1196                     V_DATE:
001096 1196 79792D6D6D2D6464        DB  "yy-mm-dd"
00109E 119E                         DS  8
       11A6                     V_DATE1:
0010A6 11A6 6D6D2D64642D7979        DB  "mm-dd-yy"
       11AE                     V_DATE2:
0010AE 11AE 64642D6D6D2D7979        DB  "dd-mm-yy"
       11B6                     N_TIME:
0010B6 11B6 54494D4500              DB  "TIME",0
       11BB                     V_TIME:
0010BB 11BB 323400                  DB  "24",0
       11BE                     N_PROGRAM:
0010BE 11BE 50524F4752414D00        DB  "PROGRAM",0
       11C6                     N_PARAMETERS:
0010C6 11C6 504152414D455445        DB  "PARAMETERS",0
            525300              
                                
       11D1                     F_TIME:
0010D1 11D1 00                      DB  0
       11D2                     PROMPT:
0010D2 11D2 3F2000                  DB  "? ",0
       11D5                     IS_MSX:
0010D5 11D5 00                      DB  0
       11D6                     MAJOR_VER:
0010D6 11D6 00                      DB  0
       11D7                     SEARCH_IX:
0010D7 11D7                         DS  64  ;DOS2用
       1217                     HANDLE1:
001117 1217 0000                    DW  0
       1219                     PATH_POS:
001119 1219 0000                    DW  0
       121B                     PATH_DRV:
00111B 121B 413A5C                  DB  "A:\\"
       121E                     PATH_CCP:
00111E 121E                         DS  64  ;DOS2用
       125E                     PATH_PAR:
00115E 125E                         DS  64  ;DOS2用
       129E                     PATH_FN1:
00119E 129E                         DS  64  ;DOS2用
       12DE                     PATH_FN2:
0011DE 12DE                         DS  64  ;DOS2用
       131E                     CUR_DRV:
00121E 131E 413A5C                  DB  "A:\\"
       1321                     CUR_PATH:
001221 1321                         DS  64  ;DOS2用
       1361                     DOS2NAME:
001261 1361                         DS  2+8+3+1 ;DOS2用
       136F                     DTA_CCP:
00126F 136F                         DS  37
       1394                     DIR_CK:
001294 1394 0000                    DW  0
                                
       1396                     CPBUF:
001296 1396 0000                LEFTX:  DW  0
001298 1398 0000                DTAX:   DW  0
00129A 139A 20                      DB  020H    ;CPBUFで使う
00129B 139B 20                      DB  020H
00129C 139C 20                      DB  020H
00129D 139D 20                      DB  020H
00129E 139E 20                      DB  020H
00129F 139F 20                      DB  020H
0012A0 13A0 20                      DB  020H
                                
       13A1                     DECBF:
0012A1 13A1                         DS  5
       13A6                     FCB_BAT2:
0012A6 13A6 00                      DB  0
       13A7                     FDRV:
0012A7 13A7 00                      DB  0
       13A8                     FNAME:
0012A8 13A8                         DS  37
       13CD                     ZERO:
0012CD 13CD 00                      DB  0
       13CE                     FCB_BAT:
0012CE 13CE A613                    DW  FCB_BAT2
       13D0                     X_PATH:
0012D0 13D0 0000                    DW  0
       13D2                     PATH_FN2_SL:
0012D2 13D2 0000                    DW  0
       13D4                     CSET_DATA:
0012D4 13D4 00                      DB  0
       13D5                     PROCESS:
0012D5 13D5 00                      DB  0
                                
       13D6                     DATA_COM:
[EOF:COMMAND.ASM:SHIFT_JIS]
