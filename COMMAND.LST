                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.21.0, LST:Full:4
                                
                                ;   似非COMMAND.COM
                                
                                    INCLUDE "DEF.ASM"
                                ;
                                ;   似非DOS
                                ;
       0023                     VER_BCD EQU 00023H
                                
       0005                     SYSTEM  EQU 00005H
       005C                     FCB1    EQU 0005CH
       006C                     FCB2    EQU 0006CH
       0080                     DTA1    EQU 00080H
                                
       000C                     RDSLT   EQU 0000CH
       001C                     CALSLT  EQU 0001CH
       006C                     INITXT  EQU 0006CH
       006F                     INIT32  EQU 0006FH
       0078                     SETTXT  EQU 00078H
       007B                     SETT32  EQU 0007BH
       0147                     FORMAT  EQU 00147H
                                
       0402                     MAPPER  EQU 00402H
                                
       F307                     FCB11   EQU 0F307H
       F37D                     BDOS    EQU 0F37DH
       F3AF                     LINL32  EQU 0F3AFH
       F3AE                     LINL40  EQU 0F3AEH
       F3B0                     LINLEN  EQU 0F3B0H
                                
       F41F                     KBUF    EQU 0F41FH; 318
       F55E                     BUF EQU 0F55EH; 258
                                
       F662                     DIMFLG  EQU 0F662H
       F663                     VALTYP  EQU 0F663H
       F672                     MEMSIZ  EQU 0F672H
       F6A7                     TEMP    EQU 0F6A7H
       F6AF                     SAVTXT  EQU 0F6AFH
       F6B1                     SAVSTK  EQU 0F6B1H
       F6B5                     DOT EQU 0F6B5H
       F6B9                     ONELIN  EQU 0F6B9H
                                
       F7C4                     TRCFLG  EQU 0F7C4H
                                
       FAF8                     EXBRSA  EQU 0FAF8H
                                
       FC9B                     INTFLG  EQU 0FC9BH
       FCC1                     EXPTBL  EQU 0FCC1H
       FFCA                     EXTBIOS EQU 0FFCAH
[EOF:DEF.ASM:UTF_8]
                                
       0040                     PATHX   EQU 64
                                
       8000                     DATA    EQU 08000H
                                
000000 0100                         ORG 00100H
000000 0100 C31601          10      JP  START
       0103                     TITLE:
000003 0103 0D0A70736575646F        DB  00DH,00AH,"pseudo COMMAND v$"
            20434F4D4D414E44    
            207624              
       0116                     START:
000016 0116 ED7B0600        20      LD  SP,(SYSTEM+1)
00001A 011A 0E6F             7      LD  C,06FH      ;(BDOS)MSX-DOS のバージョン番号の獲得
00001C 011C CD0500          17      CALL    SYSTEM
00001F 011F D8              11      RET C
000020 0120 211D01          10      LD  HL,0011DH
000023 0123 ED42            15      SBC HL,BC
000025 0125 78               4      LD  A,B
000026 0126 32E011          13      LD  (MAJOR_VER),A
000029 0129 B5               4      OR  L
00002A 012A 32DF11          13      LD  (IS_MSX),A
00002D 012D B7               4      OR  A
00002E 012E CAC101          10      JP  Z,WSTART
000031 0131 21918A          10      LD  HL,08A91H
000034 0134 ED52            15      SBC HL,DE
000036 0136 2005            12      JR  NZ,NOTABLACUS
000038 0138 3E01             7      LD  A,1
00003A 013A 32E011          13      LD  (MAJOR_VER),A
       013D                     NOTABLACUS:
00003D 013D 3ADF13          13      LD  A,(PROCESS)
000040 0140 0E61             7      LD  C,61H       ;(BDOS)親プロセスに戻る
000042 0142 47               4      LD  B,A
000043 0143 B7               4      OR  A
000044 0144 C40500          17      CALL    NZ,SYSTEM
000047 0147 AF               4      XOR A
000048 0148 32DF13          13      LD  (PROCESS),A
                                
00004B 014B 212B00          10      LD  HL,002BH    ;キャラクターセット・日時フォーマット・ビデオ信号の種別
00004E 014E CD0C00          17      CALL    RDSLT
000051 0151 0F               4      RRCA
000052 0152 0F               4      RRCA
000053 0153 0F               4      RRCA
000054 0154 0F               4      RRCA
000055 0155 E603             7      AND 3
000057 0157 2814            12      JR  Z,DATEOK
000059 0159 3D               4      DEC A
00005A 015A 21B011          10      LD  HL,V_DATE1
00005D 015D 2806            12      JR  Z,DATECHG
00005F 015F 3D               4      DEC A
000060 0160 21B811          10      LD  HL,V_DATE2
000063 0163 2008            12      JR  NZ,DATEOK
       0165                     DATECHG:
000065 0165 11A011          10      LD  DE,V_DATE
000068 0168 010800          10      LD  BC,8
00006B 016B EDB0                    LDIR
       016D                     DATEOK:
00006D 016D CD380E          17      CALL    INIT_VAR
000070 0170 3AC4F7          13      LD  A,(TRCFLG)
000073 0173 B7               4      OR  A
000074 0174 2814            12      JR  Z,WSTART0
000076 0176 11BD10          10      LD  DE,COMERM
000079 0179 0E09             7      LD  C,9     ;(BDOS)文字列出力
00007B 017B CD0500          17      CALL    SYSTEM
00007E 017E 2AC4F7          16      LD  HL,(TRCFLG)
000081 0181 2600             7      LD  H,0
000083 0183 CDD706          17      CALL    PRDEC_HL
000086 0186 AF               4      XOR A
000087 0187 32C4F7          13      LD  (TRCFLG),A
       018A                     WSTART0:
00008A 018A 2A0100          16      LD  HL,(1)
00008D 018D 2EDB             7      LD  L,256-37
00008F 018F 25               4      DEC H
000090 0190 22D813          16      LD  (FCB_BAT),HL
000093 0193 3A8000          13      LD  A,(DTA1)
000096 0196 B7               4      OR  A
000097 0197 2828            12      JR  Z,WSTART
000099 0199 110301          10      LD  DE,TITLE
00009C 019C 0E09             7      LD  C,9
00009E 019E CD0500          17      CALL    SYSTEM
                                
0000A1 01A1 212300          10      LD  HL,VER_BCD
0000A4 01A4 7C               4      LD  A,H
0000A5 01A5 CDE90A          17      CALL    PRTHX1
0000A8 01A8 3E2E             7      LD  A,'.'
0000AA 01AA CDEC0A          17      CALL    MSG_A
0000AD 01AD 7D               4      LD  A,L
0000AE 01AE CDE00A          17      CALL    PRTHX
0000B1 01B1 3E0D             7      LD  A,00DH
0000B3 01B3 CDEC0A          17      CALL    MSG_A
0000B6 01B6 3E0A             7      LD  A,00AH
0000B8 01B8 CDEC0A          17      CALL    MSG_A
                                
0000BB 01BB 118100          10      LD  DE,DTA1+1
0000BE 01BE CD2402          17      CALL    COMANL
       01C1                     WSTART:
0000C1 01C1 210F11          10      LD  HL,N_APPEND
0000C4 01C4 111611          10      LD  DE,V_APPEND
0000C7 01C7 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000C9 01C9 CD0500          17      CALL    SYSTEM
                                
0000CC 01CC 21C811          10      LD  HL,N_PROGRAM
0000CF 01CF 11D713          10      LD  DE,ZERO
0000D2 01D2 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000D4 01D4 CD0500          17      CALL    SYSTEM
                                
0000D7 01D7 21D011          10      LD  HL,N_PARAMETERS
0000DA 01DA 11D713          10      LD  DE,ZERO
0000DD 01DD 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000DF 01DF CD0500          17      CALL    SYSTEM
                                
0000E2 01E2 CD7506          17      CALL    LTNL
       01E5                     COMMAND:
0000E5 01E5 E5              11      PUSH    HL
0000E6 01E6 2AD813          16      LD  HL,(FCB_BAT)
0000E9 01E9 7E               7      LD  A,(HL)
0000EA 01EA E1              10      POP HL
0000EB 01EB B7               4      OR  A
0000EC 01EC C21705          10      JP  NZ,C_BAT1
0000EF 01EF CDBF03          17      CALL    SETDTA1
0000F2 01F2 D5              11      PUSH    DE
0000F3 01F3 C5              11      PUSH    BC
0000F4 01F4 E5              11      PUSH    HL
0000F5 01F5 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0000F7 01F7 CD0500          17      CALL    SYSTEM
0000FA 01FA E1              10      POP HL
0000FB 01FB C1              10      POP BC
0000FC 01FC C641             7      ADD A,'A'
0000FE 01FE CDEC0A          17      CALL    MSG_A
000101 0201 1E3E             7      LD  E,'>'
000103 0203 CDCF0A          17      CALL    _PRINT
000106 0206 D1              10      POP DE      ;DE=DTA1
000107 0207 3E50             7      LD  A,80
000109 0209 12               7      LD  (DE),A
00010A 020A 0E0A             7      LD  C,0AH       ;(BDOS)文字列入力
00010C 020C CD0500          17      CALL    SYSTEM
00010F 020F CD7506          17      CALL    LTNL
       0212                     COMMAND2:
000112 0212 118200          10      LD  DE,DTA1+2
000115 0215 CD2402          17      CALL    COMANL
000118 0218 30CB            12      JR  NC,COMMAND
00011A 021A 11BD10          10      LD  DE,COMERM
00011D 021D 0E09             7      LD  C,9     ;(BDOS)文字列出力
00011F 021F CD0500          17      CALL    SYSTEM
000122 0222 189D            12      JR  WSTART
                                
       0224                     COMANL:
000124 0224 CD010C          17      CALL    TOZERO
000127 0227 ED535102        20      LD  (COMST),DE
00012B 022B CD370B          17      CALL    FILE
00012E 022E D5              11      PUSH    DE
00012F 022F 11B213          10      LD  DE,FNAME
000132 0232 1A               7      LD  A,(DE)
000133 0233 FE20             7      CP  020H
000135 0235 CAC202          10      JP  Z,SDVSW
000138 0238 1B               6      DEC DE
000139 0239 1A               7      LD  A,(DE)
00013A 023A C6FF             7      ADD A,0FFH
00013C 023C 380A            12      JR  C,COMB
00013E 023E 13               6      INC DE
                                
00013F 023F 210110          10      LD  HL,COMTB
000142 0242 3E12             7      LD  A,COMS
000144 0244 47               4      LD  B,A
000145 0245 CD530C          17      CALL    CPNAME
       0248                     COMB:
000148 0248 D1              10      POP DE
000149 0249 D2CE0A          10      JP  NC,JP_HL
       024C                     COMB2:
00014C 024C EB               4      EX  DE,HL
00014D 024D 224604          16      LD  (COMPAT),HL
                                
000150 0250 110000          10      LD  DE,0
       0251                     COMST   EQU $-2
000153 0253 21E013          10      LD  HL,DATA_COM
000156 0256 3600            10      LD  (HL),0
       0258                     COMPR1:
000158 0258 1A               7      LD  A,(DE)
000159 0259 13               6      INC DE
00015A 025A 23               6      INC HL
00015B 025B 77               7      LD  (HL),A
00015C 025C FE20             7      CP  020H
00015E 025E 30F8            12      JR  NC,COMPR1
       0260                     COMPR2:
000160 0260 2B               6      DEC HL
000161 0261 7E               7      LD  A,(HL)
000162 0262 FE5C             7      CP  05CH
000164 0264 2014            12      JR  NZ,COMPR3
000166 0266 3600            10      LD  (HL),0
000168 0268 23               6      INC HL
000169 0269 EB               4      EX  DE,HL
00016A 026A CD370B          17      CALL    FILE
00016D 026D 210F11          10      LD  HL,N_APPEND
000170 0270 11E113          10      LD  DE,DATA_COM+1
000173 0273 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000175 0275 CD0500          17      CALL    SYSTEM
000178 0278 1804            12      JR  COMPR4
       027A                     COMPR3:
00017A 027A FE20             7      CP  020H
00017C 027C 30E2            12      JR  NC,COMPR2
       027E                     COMPR4:
00017E 027E CD0804          17      CALL    CEXE4
                                
000181 0281 215611          10      LD  HL,N_PATH
000184 0284 115B11          10      LD  DE,V_PATH
000187 0287 0640             7      LD  B,PATHX
000189 0289 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
00018B 028B CD0500          17      CALL    SYSTEM
                                
00018E 028E 215B11          10      LD  HL,V_PATH
000191 0291 22DA13          16      LD  (X_PATH),HL
       0294                     CEX1:
000194 0294 2ADA13          16      LD  HL,(X_PATH)
000197 0297 7E               7      LD  A,(HL)
000198 0298 FE20             7      CP  020H
00019A 029A D8              11      RET C
       029B                     CEX2:
00019B 029B 7E               7      LD  A,(HL)
00019C 029C FE20             7      CP  020H
00019E 029E 3807            12      JR  C,CEX3
0001A0 02A0 FE3B             7      CP  ';'
0001A2 02A2 2803            12      JR  Z,CEX3
0001A4 02A4 23               6      INC HL
0001A5 02A5 18F4            12      JR  CEX2
       02A7                     CEX3:
0001A7 02A7 3600            10      LD  (HL),0
0001A9 02A9 FE20             7      CP  020H
0001AB 02AB 3801            12      JR  C,CEX4
0001AD 02AD 23               6      INC HL
       02AE                     CEX4:
0001AE 02AE ED5BDA13        20      LD  DE,(X_PATH)
0001B2 02B2 22DA13          16      LD  (X_PATH),HL
0001B5 02B5 210F11          10      LD  HL,N_APPEND
0001B8 02B8 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0001BA 02BA CD0500          17      CALL    SYSTEM
                                
0001BD 02BD CD0804          17      CALL    CEXE4
0001C0 02C0 18D2            12      JR  CEX1
                                
       02C2                     SDVSW:
0001C2 02C2 F1              10      POP AF
0001C3 02C3 3AB113          13      LD  A,(FDRV)
0001C6 02C6 3D               4      DEC A
0001C7 02C7 5F               4      LD  E,A
0001C8 02C8 0E0E             7      LD  C,00EH      ;(BDOS)カレントドライブの設定
0001CA 02CA C3C603          10      JP  SYSTEM0
                                
       02CD                     OPEN_D2:            ;DOS2対応
0001CD 02CD 3AE011          13      LD  A,(MAJOR_VER)
0001D0 02D0 FE02             7      CP  2
0001D2 02D2 384F            12      JR  C,OPEN
0001D4 02D4 11A812          10      LD  DE,PATH_FN1
0001D7 02D7 180A            12      JR  OPEN_D2X
       02D9                     OPEN1_D2:           ;DOS2対応
0001D9 02D9 3AE011          13      LD  A,(MAJOR_VER)
0001DC 02DC FE02             7      CP  2
0001DE 02DE 3840            12      JR  C,OPEN1
                                
0001E0 02E0 112812          10      LD  DE,PATH_CCP
       02E3                     OPEN_D2X:
0001E3 02E3 DD21E111        14      LD  IX,SEARCH_IX
0001E7 02E7 014010          10      LD  BC,01040H   ;(BDOS)最初のエントリ検索
0001EA 02EA CD0500          17      CALL    SYSTEM
0001ED 02ED F5              11      PUSH    AF
0001EE 02EE 116812          10      LD  DE,PATH_PAR
0001F1 02F1 0E5E             7      LD  C,05EH      ;(BDOS)完全なパス文字列の獲得(_WPATH)
0001F3 02F3 CD0500          17      CALL    SYSTEM
0001F6 02F6 AF               4      XOR A
0001F7 02F7 77               7      LD  (HL),A
0001F8 02F8 116812          10      LD  DE,PATH_PAR
0001FB 02FB ED52            15      SBC HL,DE
0001FD 02FD 222312          16      LD  (PATH_POS),HL
000200 0300 F1              10      POP AF
       0301                     FIB2DIRENT:
000201 0301 B7               4      OR  A
000202 0302 C0              11      RET NZ
                                
000203 0303 11E211          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
000206 0306 217A13          10      LD  HL,DTA_CCP+1
000209 0309 0E5C             7      LD  C,05CH      ;(BDOS)ファイル名の解析
00020B 030B CD0500          17      CALL    SYSTEM
                                
00020E 030E 21EF11          10      LD  HL,SEARCH_IX+14 ;(FIB)属性
000211 0311 118513          10      LD  DE,DTA_CCP+1+8+3
000214 0314 EDA0            16      LDI
000216 0316 119013          10      LD  DE,DTA_CCP+1+8+3+1+10
000219 0319 010A00          10      LD  BC,2+2+2+4  ;最終変更時刻+最終変更日付+開始クラスタ+ファイルサイズ
00021C 031C EDB0                    LDIR
00021E 031E AF               4      XOR A
00021F 031F C9              10      RET
                                
       0320                     OPEN1:
000220 0320 21B113          10      LD  HL,FDRV
       0323                     OPEN:
000223 0323 0E11             7      LD  C,011H      ;(BDOS)最初のファイルの検索
       0325                     OPEN3:
000225 0325 D5              11      PUSH    DE
000226 0326 117913          10      LD  DE,DTA_CCP
000229 0329 CDB203          17      CALL    SETDTA
00022C 032C C5              11      PUSH    BC
00022D 032D E5              11      PUSH    HL
00022E 032E 010E00          10      LD  BC,14
000231 0331 09              11      ADD HL,BC
000232 0332 223D03          16      LD  (OPEN3_SWC),HL
000235 0335 E1              10      POP HL
000236 0336 C1              10      POP BC
000237 0337 EB               4      EX  DE,HL
000238 0338 CDC603          17      CALL    SYSTEM0
00023B 033B D1              10      POP DE
00023C 033C 2A0000          16      LD  HL,(0)      ;Tablacus Disk ROM Lite　階層ディレクトリ
       033D                     OPEN3_SWC   EQU $-2
00023F 033F 228713          16      LD  (DTA_CCP+14),HL
000242 0342 C9              10      RET
                                
       0343                     OPEN2_D2:           ;DOS2対応
000243 0343 3AE011          13      LD  A,(MAJOR_VER)
000246 0346 FE02             7      CP  2
000248 0348 380B            12      JR  C,OPEN2
00024A 034A DD21E111        14      LD  IX,SEARCH_IX
00024E 034E 0E41             7      LD  C,41H       ;(BDOS)次のエントリ検索
000250 0350 CD0500          17      CALL    SYSTEM
000253 0353 18AC            12      JR  FIB2DIRENT
       0355                     OPEN2:
000255 0355 0E12             7      LD  C,012H
000257 0357 18CC            12      JR  OPEN3
                                
       0359                     DEFCB_D2:           ;DOS2対応
000259 0359 3AE011          13      LD  A,(MAJOR_VER)
00025C 035C FE02             7      CP  2
00025E 035E 383A            12      JR  C,DEFCB
000260 0360 216812          10      LD  HL,PATH_PAR
000263 0363 112812          10      LD  DE,PATH_CCP
000266 0366 014000          10      LD  BC,64
000269 0369 EDB0                    LDIR
00026B 036B 2A2312          16      LD  HL,(PATH_POS)
00026E 036E 112812          10      LD  DE,PATH_CCP
000271 0371 19              11      ADD HL,DE
000272 0372 060D             7      LD  B,13
000274 0374 11E211          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
       0377                     DCB4:
000277 0377 1A               7      LD  A,(DE)
000278 0378 B7               4      OR  A
000279 0379 2805            12      JR  Z,DCB5
00027B 037B 13               6      INC DE
00027C 037C 77               7      LD  (HL),A
00027D 037D 23               6      INC HL
00027E 037E 18F7            12      JR  DCB4
       0380                     DCB5:
000280 0380 3600            10      LD  (HL),0
000282 0382 3AFA11          13      LD  A,(SEARCH_IX+25)    ;(FIB)ドライブ番号(1-8)
000285 0385 C640             7      ADD A,040H
000287 0387 112512          10      LD  DE,PATH_DRV
00028A 038A 12               7      LD  (DE),A
00028B 038B 0E43             7      LD  C,043H      ;_OPEN ファイルハンドルのオープン
00028D 038D 3E01             7      LD  A,1     ;書き込み禁止
00028F 038F CD0500          17      CALL    SYSTEM
000292 0392 B7               4      OR  A
000293 0393 C0              11      RET NZ
000294 0394 ED432112        20      LD  (HANDLE1),BC
000298 0398 1815            12      JR  SETDTA100
       039A                     DEFCB:              ;Z=Ok NZ=Error
00029A 039A 117913          10      LD  DE,DTA_CCP
00029D 039D CDC403          17      CALL    SYSC0F
0002A0 03A0 B7               4      OR  A
0002A1 03A1 C0              11      RET NZ
                                
0002A2 03A2 210100          10      LD  HL,1
0002A5 03A5 228713          16      LD  (DTA_CCP+14),HL
0002A8 03A8 2D               4      DEC L
0002A9 03A9 229A13          16      LD  (DTA_CCP+33),HL
0002AC 03AC 229C13          16      LD  (DTA_CCP+35),HL
       03AF                     SETDTA100:
0002AF 03AF 110080          10      LD  DE,DATA
       03B2                     SETDTA:
0002B2 03B2 C5              11      PUSH    BC
0002B3 03B3 D5              11      PUSH    DE
0002B4 03B4 E5              11      PUSH    HL
0002B5 03B5 0E1A             7      LD  C,01AH      ;(BDOS)DTAの設定
0002B7 03B7 CD0500          17      CALL    SYSTEM
0002BA 03BA E1              10      POP HL
0002BB 03BB D1              10      POP DE
0002BC 03BC C1              10      POP BC
0002BD 03BD AF               4      XOR A
0002BE 03BE C9              10      RET
                                
       03BF                     SETDTA1:
0002BF 03BF 118000          10      LD  DE,DTA1
0002C2 03C2 18EE            12      JR  SETDTA
                                
       03C4                     SYSC0F:
0002C4 03C4 0E0F             7      LD  C,00FH      ;(BDOS)ファイルのオープン
       03C6                     SYSTEM0:
0002C6 03C6 CD0500          17      CALL    SYSTEM
0002C9 03C9 B7               4      OR  A
0002CA 03CA C9              10      RET
                                
       03CB                     C_CD:
0002CB 03CB CDFB0B          17      CALL    SPCUT
0002CE 03CE 1A               7      LD  A,(DE)
0002CF 03CF FE20             7      CP  020H
0002D1 03D1 DA1606          10      JP  C,PWD
       03D4                     CD1:
0002D4 03D4 0E5A             7      LD  C,5AH       ;(BDOS)_CHDIR カレントディレクトリの変更
0002D6 03D6 C30500          10      JP  SYSTEM
                                
       03D9                     S27DTA_D2:      ;DOS2対応
0002D9 03D9 3AE011          13      LD  A,(MAJOR_VER)
0002DC 03DC FE02             7      CP  2
0002DE 03DE 3817            12      JR  C,S27DTA
0002E0 03E0 ED4B2112        20      LD  BC,(HANDLE1)
0002E4 03E4 110080          10      LD  DE,DATA
0002E7 03E7 0E48             7      LD  C,048H      ;(BDOS)ファイルハンドルからの読み出し(_READ)
0002E9 03E9 CDC603          17      CALL    SYSTEM0
0002EC 03EC C8              11      RET Z
0002ED 03ED FEC7             7      CP  0C7H        ;.EOF
0002EF 03EF 2803            12      JR  Z,S27EOF
0002F1 03F1 37               4      SCF
0002F2 03F2 9F               4      SBC A,A
0002F3 03F3 C9              10      RET
       03F4                     S27EOF:
0002F4 03F4 3E01             7      LD  A,1
0002F6 03F6 C9              10      RET
                                
       03F7                     S27DTA:
0002F7 03F7 110100          10      LD  DE,1
0002FA 03FA ED538713        20      LD  (DTA_CCP+14),DE
0002FE 03FE 117913          10      LD  DE,DTA_CCP
       0401                     S27:
000301 0401 0E27             7      LD  C,027H      ;(BDOS)ランダム・ブロック・リード
000303 0403 CD0500          17      CALL    SYSTEM
000306 0406 B7               4      OR  A
000307 0407 C9              10      RET
                                
       0408                     CEXE4:
000308 0408 21B113          10      LD  HL,FDRV
00030B 040B 117913          10      LD  DE,DTA_CCP
00030E 040E 010900          10      LD  BC,1+8
000311 0411 EDB0                    LDIR
000313 0413 218213          10      LD  HL,DTA_CCP+9
000316 0416 3643            10      LD  (HL),'C'
000318 0418 23               6      INC HL
000319 0419 364F            10      LD  (HL),'O'
00031B 041B 23               6      INC HL
00031C 041C 364D            10      LD  (HL),'M'
       041E                     C_EXE:
00031E 041E CD9A03          17      CALL    DEFCB
000321 0421 C2EF04          10      JP  NZ,C_BAT
000324 0424 11E013          10      LD  DE,DATA_COM
000327 0427 CDB203          17      CALL    SETDTA
                                
00032A 042A 2A0600          16      LD  HL,(SYSTEM+1)
00032D 042D 11E013          10      LD  DE,DATA_COM
000330 0430 ED52            15      SBC HL,DE
                                
000332 0432 CDF703          17      CALL    S27DTA
000335 0435 3D               4      DEC A
000336 0436 37               4      SCF
000337 0437 C0              11      RET NZ
000338 0438 7C               4      LD  A,H
000339 0439 B5               4      OR  L
00033A 043A 37               4      SCF
00033B 043B C8              11      RET Z
00033C 043C 22E904          16      LD  (COMSIZ),HL
                                
00033F 043F 11E013          10      LD  DE,DATA_COM
000342 0442 CDB203          17      CALL    SETDTA
000345 0445 110000          10      LD  DE,0
       0446                     COMPAT  EQU $-2
000348 0448 CD6A08          17      CALL    SETFCB
                                
00034B 044B 210F11          10      LD  HL,N_APPEND
00034E 044E 112812          10      LD  DE,PATH_CCP
000351 0451 0640             7      LD  B,PATHX
000353 0453 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000355 0455 CD0500          17      CALL    SYSTEM
000358 0458 3A2812          13      LD  A,(PATH_CCP)
00035B 045B B7               4      OR  A
00035C 045C 201D            12      JR  NZ,COM_ENV1
00035E 045E 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
000360 0460 CD0500          17      CALL    SYSTEM
000363 0463 C641             7      ADD A,'A'
000365 0465 322812          13      LD  (PATH_CCP),A
000368 0468 3E3A             7      LD  A,':'
00036A 046A 322912          13      LD  (PATH_CCP+1),A
00036D 046D 3E5C             7      LD  A,05CH      ;\
00036F 046F 322A12          13      LD  (PATH_CCP+2),A
000372 0472 47               4      LD  B,A     ;ドライブ
000373 0473 112A12          10      LD  DE,PATH_CCP+2
000376 0476 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
000378 0478 CD0500          17      CALL    SYSTEM
       047B                     COM_ENV1:
00037B 047B 117913          10      LD  DE,DTA_CCP
00037E 047E 216B13          10      LD  HL,DOS2NAME
000381 0481 CD2D0A          17      CALL    FCB2FNAME
000384 0484 112812          10      LD  DE,PATH_CCP
000387 0487 216D13          10      LD  HL,DOS2NAME+2
       048A                     COM_ENV2:
00038A 048A 1A               7      LD  A,(DE)
00038B 048B B7               4      OR  A
00038C 048C 2803            12      JR  Z,COM_ENV3
00038E 048E 13               6      INC DE
00038F 048F 18F9            12      JR  COM_ENV2
       0491                     COM_ENV3:
000391 0491 1B               6      DEC DE
000392 0492 1A               7      LD  A,(DE)
000393 0493 13               6      INC DE
000394 0494 FE5C             7      CP  05CH
000396 0496 2804            12      JR  Z,COM_ENV4
000398 0498 3E5C             7      LD  A,05CH
00039A 049A 12               7      LD  (DE),A
00039B 049B 13               6      INC DE
       049C                     COM_ENV4:
00039C 049C 7E               7      LD  A,(HL)
00039D 049D 23               6      INC HL
00039E 049E 12               7      LD  (DE),A
00039F 049F 13               6      INC DE
0003A0 04A0 B7               4      OR  A
0003A1 04A1 20F9            12      JR  NZ,COM_ENV4
                                
0003A3 04A3 21C811          10      LD  HL,N_PROGRAM
0003A6 04A6 112812          10      LD  DE,PATH_CCP
0003A9 04A9 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003AB 04AB CD0500          17      CALL    SYSTEM
                                
0003AE 04AE 21D011          10      LD  HL,N_PARAMETERS
0003B1 04B1 118100          10      LD  DE,DTA1+1
0003B4 04B4 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003B6 04B6 CD0500          17      CALL    SYSTEM
                                
0003B9 04B9 210F11          10      LD  HL,N_APPEND
0003BC 04BC 111611          10      LD  DE,V_APPEND
0003BF 04BF 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003C1 04C1 CD0500          17      CALL    SYSTEM
                                
0003C4 04C4 0E60             7      LD  C,60H       ;(BDOS)子プロセスの起動
0003C6 04C6 CD0500          17      CALL    SYSTEM
0003C9 04C9 B7               4      OR  A
0003CA 04CA 2004            12      JR  NZ,COMP1
0003CC 04CC 78               4      LD  A,B
0003CD 04CD 32DF13          13      LD  (PROCESS),A
       04D0                     COMP1:
0003D0 04D0 AF               4      XOR A
0003D1 04D1 67               4      LD  H,A
0003D2 04D2 6F               4      LD  L,A ;HL=0x0000
0003D3 04D3 32C4F7          13      LD  (TRCFLG),A
0003D6 04D6 F3               4      DI
0003D7 04D7 ED7B0600        20      LD  SP,(SYSTEM+1)
0003DB 04DB E5              11      PUSH    HL
0003DC 04DC 21EDB0          10      LD  HL,0B0EDH   ;LDIR
0003DF 04DF 22FE00          16      LD  (000FEH),HL
0003E2 04E2 21E013          10      LD  HL,DATA_COM
0003E5 04E5 110001          10      LD  DE,00100H
0003E8 04E8 010000          10      LD  BC,0
       04E9                     COMSIZ  EQU $-2
0003EB 04EB FB               4      EI
0003EC 04EC C3FE00          10      JP  000FEH
                                
       04EF                     C_BAT:
0003EF 04EF 218213          10      LD  HL,DTA_CCP+9
0003F2 04F2 3642            10      LD  (HL),'B'
0003F4 04F4 23               6      INC HL
0003F5 04F5 3641            10      LD  (HL),'A'
0003F7 04F7 23               6      INC HL
0003F8 04F8 3654            10      LD  (HL),'T'
                                
0003FA 04FA CD9A03          17      CALL    DEFCB
0003FD 04FD C0              11      RET NZ
                                
0003FE 04FE 217913          10      LD  HL,DTA_CCP
000401 0501 7E               7      LD  A,(HL)
000402 0502 B7               4      OR  A
000403 0503 2009            12      JR  NZ,CBAT_DS
000405 0505 E5              11      PUSH    HL
000406 0506 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
000408 0508 CD0500          17      CALL    SYSTEM
00040B 050B E1              10      POP HL
00040C 050C 3C               4      INC A
00040D 050D 77               7      LD  (HL),A
       050E                     CBAT_DS:
00040E 050E ED5BD813        20      LD  DE,(FCB_BAT)
000412 0512 012500          10      LD  BC,37
000415 0515 EDB0                    LDIR
       0517                     C_BAT1:
000417 0517 CDAF03          17      CALL    SETDTA100
00041A 051A CD5805          17      CALL    FGETC_BAT
00041D 051D 218100          10      LD  HL,DTA1+1
000420 0520 202A            12      JR  NZ,END_BATCH
000422 0522 FE21             7      CP  021H        ;スペースや改行など制御文字を飛ばす
000424 0524 38F1            12      JR  C,C_BAT1
000426 0526 3620            10      LD  (HL),' '
000428 0528 23               6      INC HL
       0529                     C_BAT2:
000429 0529 77               7      LD  (HL),A
00042A 052A 23               6      INC HL
00042B 052B 7D               4      LD  A,L
00042C 052C 3C               4      INC A       ;L==0FFH
00042D 052D 2809            12      JR  Z,RUN_BATCH
00042F 052F CD5805          17      CALL    FGETC_BAT
000432 0532 2004            12      JR  NZ,RUN_BATCH
000434 0534 FE20             7      CP  020H
000436 0536 30F1            12      JR  NC,C_BAT2
       0538                     RUN_BATCH:
000438 0538 7D               4      LD  A,L
000439 0539 D67F             7      SUB DTA1-1
00043B 053B 328000          13      LD  (DTA1),A
00043E 053E FE04             7      CP  4
000440 0540 380A            12      JR  C,END_BATCH
000442 0542 3600            10      LD  (HL),0
000444 0544 3A9BFC          13      LD  A,(INTFLG)
000447 0547 FE03             7      CP  3
000449 0549 C21202          10      JP  NZ,COMMAND2
       054C                     END_BATCH:      ;バッチファイルを閉じる
00044C 054C 2AD813          16      LD  HL,(FCB_BAT)
00044F 054F 3600            10      LD  (HL),0
000451 0551 ED7B0600        20      LD  SP,(SYSTEM+1)
000455 0555 C3C101          10      JP  WSTART
                                
       0558                     FGETC_BAT:
000458 0558 ED5BD813        20      LD  DE,(FCB_BAT)
       055C                     FGETC:              ;1文字ずつ読み込む
00045C 055C E5              11      PUSH    HL      ;Z:成功
00045D 055D 210100          10      LD  HL,1
000460 0560 CD0104          17      CALL    S27
000463 0563 E1              10      POP HL
000464 0564 3A0080          13      LD  A,(DATA)
000467 0567 C9              10      RET
                                
       0568                     C_REM:
000468 0568 AF               4      XOR A
000469 0569 C9              10      RET
                                
       056A                     C_DEL:
00046A 056A CD6A08          17      CALL    SETFCB
00046D 056D 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力
00046F 056F CD0500          17      CALL    SYSTEM
000472 0572 0600             7      LD  B,0
000474 0574 3AE011          13      LD  A,(MAJOR_VER)
000477 0577 FE02             7      CP  2
000479 0579 381E            12      JR  C,CDEL_DOS1
                                
00047B 057B 215C00          10      LD  HL,FCB1
00047E 057E CDCD02          17      CALL    OPEN_D2
000481 0581 37               4      SCF
       0582                     DEL1:
000482 0582 C0              11      RET NZ
000483 0583 3AEF11          13      LD  A,(SEARCH_IX+14);   (FIB)属性
000486 0586 CB67             8      BIT 4,A
000488 0588 200A            12      JR  NZ,DEL2
                                
00048A 058A 11E111          10      LD  DE,SEARCH_IX
00048D 058D 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除(_DELETE)
00048F 058F CDC603          17      CALL    SYSTEM0
000492 0592 37               4      SCF
000493 0593 C0              11      RET NZ
       0594                     DEL2:
000494 0594 CD4303          17      CALL    OPEN2_D2
000497 0597 18E9            12      JR  DEL1
                                
       0599                     CDEL_DOS1:
000499 0599 0E13             7      LD  C,013H
00049B 059B 1811            12      JR  CDEL1       ;(BDOS)ファイルの削除
                                
       059D                     C_REN:
00049D 059D 3AE011          13      LD  A,(MAJOR_VER)
0004A0 05A0 FE02             7      CP  2
0004A2 05A2 3013            12      JR  NC,REN_DOS2
0004A4 05A4 CD6A08          17      CALL    SETFCB
0004A7 05A7 3E10             7      LD  A,010H      ;ディレクトリも対象にする(LSX-Dodgers)
0004A9 05A9 326900          13      LD  (FCB1+13),A ;属性
0004AC 05AC 0E17             7      LD  C,017H      ;(BDOS)ファイル名の変更
       05AE                     CDEL1:
0004AE 05AE 115C00          10      LD  DE,FCB1
       05B1                     REN2:
0004B1 05B1 CD0500          17      CALL    SYSTEM
0004B4 05B4 C6FF             7      ADD A,0FFH
0004B6 05B6 C9              10      RET
                                
       05B7                     REN_DOS2:           ;DOS2のリネーム(ディレクトリ対応)
0004B7 05B7 CDFB0B          17      CALL    SPCUT
0004BA 05BA 6B               4      LD  L,E
0004BB 05BB 62               4      LD  H,D
       05BC                     REN_D2_1:
0004BC 05BC 7E               7      LD  A,(HL)
0004BD 05BD FE21             7      CP  020H+1
0004BF 05BF 3803            12      JR  C,REN_D2_2
0004C1 05C1 23               6      INC HL
0004C2 05C2 18F8            12      JR  REN_D2_1
       05C4                     REN_D2_2:
0004C4 05C4 3600            10      LD  (HL),0
0004C6 05C6 23               6      INC HL
0004C7 05C7 0E4E             7      LD  C,04EH      ;(BDOS)ファイルあるいはサブディレクトリ名の変更(_RENAME)
0004C9 05C9 18E6            12      JR  REN2
                                
       05CB                     C_DIR:
0004CB 05CB CD090B          17      CALL    FILEC_D2
0004CE 05CE 21B213          10      LD  HL,FDRV+1
0004D1 05D1 CDB40A          17      CALL    CWILD1
0004D4 05D4 3EF1             7      LD  A,0F1H
0004D6 05D6 32BE13          13      LD  (FDRV+13),A
0004D9 05D9 CDD902          17      CALL    OPEN1_D2
       05DC                     CDIR1:
0004DC 05DC B7               4      OR  A
0004DD 05DD 2008            12      JR  NZ,PDSKF
0004DF 05DF CD4D06          17      CALL    P_NAME
0004E2 05E2 CD4303          17      CALL    OPEN2_D2
0004E5 05E5 18F5            12      JR  CDIR1
                                
       05E7                     PDSKF:
0004E7 05E7 3AB113          13      LD  A,(FDRV)
0004EA 05EA 5F               4      LD  E,A
0004EB 05EB 0E1B             7      LD  C,01BH      ;(BDOS)ディスク情報の獲得
0004ED 05ED CD0500          17      CALL    SYSTEM
0004F0 05F0 4F               4      LD  C,A     ;C←1クラスタ辺りの論理セクタ数
0004F1 05F1 C601             7      ADD A,001H
0004F3 05F3 D8              11      RET C       ;Aが0FFHだった場合
0004F4 05F4 3E06             7      LD  A,8-2
       05F6                     PDS1:               ;HL=未使用クラスタの総数
0004F6 05F6 3C               4      INC A
0004F7 05F7 CB19             8      RR  C
0004F9 05F9 30FB            12      JR  NC,PDS1
       05FB                     PDS2:               ;B←論理セクタのサイズの上位8ビット
0004FB 05FB 3C               4      INC A
0004FC 05FC CB18             8      RR  B
0004FE 05FE 30FB            12      JR  NC,PDS2
000500 0600 47               4      LD  B,A
                                
000501 0601 110000          10      LD  DE,0
       0604                     PDS3:
000504 0604 29              11      ADD HL,HL
000505 0605 EB               4      EX  DE,HL
000506 0606 ED6A            15      ADC HL,HL
000508 0608 EB               4      EX  DE,HL
000509 0609 10F9            13      DJNZ    PDS3
       060B                     PDSKF1:
00050B 060B CDDB06          17      CALL    PRDEC_DEHL
00050E 060E 11A310          10      LD  DE,FREE
000511 0611 0E09             7      LD  C,9     ;(BDOS)文字列出力
000513 0613 CD0500          17      CALL    SYSTEM
       0616                     PWD:
000516 0616 CDBB06          17      CALL    PUTDRV
000519 0619 3E5C             7      LD  A,05CH      ;\
00051B 061B CDEC0A          17      CALL    MSG_A
       061E                     PDSKF2:             ;MSX-DOS2
00051E 061E 110080          10      LD  DE,DATA
000521 0621 AF               4      XOR A
000522 0622 12               7      LD  (DE),A
000523 0623 3AB113          13      LD  A,(FDRV)
000526 0626 47               4      LD  B,A     ;ドライブ
000527 0627 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
000529 0629 CD0500          17      CALL    SYSTEM
00052C 062C 210080          10      LD  HL,DATA
                                
00052F 062F CD3706          17      CALL    MSX
000532 0632 1841            12      JR  LTNL
                                
       0634                     MSX1:
000534 0634 CDEC0A          17      CALL    MSG_A
       0637                     MSX:
000537 0637 7E               7      LD  A,(HL)
000538 0638 23               6      INC HL
000539 0639 B7               4      OR  A
00053A 063A 20F8            12      JR  NZ,MSX1
00053C 063C C9              10      RET
                                
       063D                     MSXSLT1:
00053D 063D CDEC0A          17      CALL    MSG_A
       0640                     MSXSLT:
000540 0640 C5              11      PUSH    BC
000541 0641 E5              11      PUSH    HL
000542 0642 78               4      LD  A,B
000543 0643 CD0C00          17      CALL    RDSLT
000546 0646 E1              10      POP HL
000547 0647 C1              10      POP BC
000548 0648 23               6      INC HL
000549 0649 B7               4      OR  A
00054A 064A 20F1            12      JR  NZ,MSXSLT1
00054C 064C C9              10      RET
                                
       064D                     P_NAME:
00054D 064D 217A13          10      LD  HL,DTA_CCP+1
000550 0650 7E               7      LD  A,(HL)
000551 0651 FE2E             7      CP  '.'
000553 0653 C8              11      RET Z
000554 0654 CD3107          17      CALL    FPRNT
000557 0657 3A8513          13      LD  A,(DTA_CCP+12)
00055A 065A CB67             8      BIT 4,A
00055C 065C 280A            12      JR  Z,DIR3
00055E 065E 11B110          10      LD  DE,DIRMES
000561 0661 0E09             7      LD  C,9     ;(BDOS)文字列出力
000563 0663 CD0500          17      CALL    SYSTEM
000566 0666 180A            12      JR  DIR6
       0668                     DIR3:
000568 0668 ED5B9813        20      LD  DE,(DTA_CCP+1+01EH)
00056C 066C 2A9613          16      LD  HL,(DTA_CCP+1+01CH)
00056F 066F CDDB06          17      CALL    PRDEC_DEHL
       0672                     DIR6:
000572 0672 CD5307          17      CALL    PRTTMS
                                
       0675                     LTNL:
000575 0675 1E0D             7      LD  E,00DH
000577 0677 CDCF0A          17      CALL    _PRINT
00057A 067A 1E0A             7      LD  E,00AH
00057C 067C C3CF0A          10      JP  _PRINT
                                
       067F                     C_PATH:
00057F 067F CDFB0B          17      CALL    SPCUT
000582 0682 FE21             7      CP  021H
000584 0684 301C            12      JR  NC,CPATH0
                                
000586 0686 215611          10      LD  HL,N_PATH
000589 0689 115B11          10      LD  DE,V_PATH
00058C 068C 0640             7      LD  B,PATHX
00058E 068E 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000590 0690 CD0500          17      CALL    SYSTEM
000593 0693 215B11          10      LD  HL,V_PATH
       0696                     CPATHP:
000596 0696 7E               7      LD  A,(HL)
000597 0697 23               6      INC HL
000598 0698 FE20             7      CP  020H
00059A 069A 3F               4      CCF
00059B 069B 30D8            12      JR  NC,LTNL
00059D 069D CDEC0A          17      CALL    MSG_A
0005A0 06A0 18F4            12      JR  CPATHP
       06A2                     CPATH0:
0005A2 06A2 215B11          10      LD  HL,V_PATH
0005A5 06A5 FE3B             7      CP  ';'
0005A7 06A7 2001            12      JR  NZ,CPATH1
0005A9 06A9 13               6      INC DE
       06AA                     CPATH1:
0005AA 06AA EB               4      EX  DE,HL
0005AB 06AB 014000          10      LD  BC,PATHX
0005AE 06AE EDB0                    LDIR
                                
0005B0 06B0 215611          10      LD  HL,N_PATH
0005B3 06B3 115B11          10      LD  DE,V_PATH
0005B6 06B6 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0005B8 06B8 C30500          10      JP  SYSTEM
                                
       06BB                     PUTDRV:
0005BB 06BB 3AB113          13      LD  A,(FDRV)
0005BE 06BE B7               4      OR  A
0005BF 06BF 200C            12      JR  NZ,PUTDRV1
0005C1 06C1 C5              11      PUSH    BC
0005C2 06C2 D5              11      PUSH    DE
0005C3 06C3 E5              11      PUSH    HL
0005C4 06C4 0E19             7      LD  C,019H
0005C6 06C6 CD0500          17      CALL    SYSTEM
0005C9 06C9 E1              10      POP HL
0005CA 06CA D1              10      POP DE
0005CB 06CB C1              10      POP BC
0005CC 06CC 3C               4      INC A
       06CD                     PUTDRV1:
0005CD 06CD C640             7      ADD A,'A'-1
0005CF 06CF CDEC0A          17      CALL    MSG_A
0005D2 06D2 3E3A             7      LD  A,':'
       06D4                     MSG_AR:
0005D4 06D4 C3EC0A          10      JP  MSG_A
                                
       06D7                     PRDEC_HL:
0005D7 06D7 AF               4      XOR A
       06D8                     PRDEC_AHL:
0005D8 06D8 5F               4      LD  E,A
0005D9 06D9 1600             7      LD  D,0
       06DB                     PRDEC_DEHL:
0005DB 06DB 3E02             7      LD  A,2
0005DD 06DD 322607          13      LD  (DEC6+1),A
0005E0 06E0 AF               4      XOR A
0005E1 06E1 E5              11      PUSH    HL
0005E2 06E2 21AB13          10      LD  HL,DECBF
0005E5 06E5 0605             7      LD  B,5
0005E7 06E7 CDC20B          17      CALL    FILL_MEMORY
0005EA 06EA E1              10      POP HL
                                
0005EB 06EB 0E20             7      LD  C,32
       06ED                     DEC1:
0005ED 06ED 29              11      ADD HL,HL
0005EE 06EE EB               4      EX  DE,HL
0005EF 06EF ED6A            15      ADC HL,HL
0005F1 06F1 EB               4      EX  DE,HL
0005F2 06F2 E5              11      PUSH    HL
0005F3 06F3 21AF13          10      LD  HL,DECBF+4
0005F6 06F6 0605             7      LD  B,5
       06F8                     DEC2:
0005F8 06F8 7E               7      LD  A,(HL)
0005F9 06F9 8F               4      ADC A,A
0005FA 06FA 27               4      DAA
0005FB 06FB 77               7      LD  (HL),A
0005FC 06FC 2B               6      DEC HL
0005FD 06FD 10F9            13      DJNZ    DEC2
0005FF 06FF E1              10      POP HL
000600 0700 0D               4      DEC C
000601 0701 20EA            12      JR  NZ,DEC1
                                
000603 0703 21AB13          10      LD  HL,DECBF
000606 0706 3E20             7      LD  A,020H
000608 0708 0604             7      LD  B,4
       070A                     DEC3:
00060A 070A CD1707          17      CALL    DEC4
00060D 070D CD1707          17      CALL    DEC4
000610 0710 23               6      INC HL
000611 0711 10F7            13      DJNZ    DEC3
       0713                     DECX:
000613 0713 CD1707          17      CALL    DEC4
000616 0716 AF               4      XOR A
       0717                     DEC4:
000617 0717 ED6F            18      RLD
000619 0719 FE20             7      CP  020H
00061B 071B 2808            12      JR  Z,DEC6
00061D 071D F630             7      OR  030H
       071F                     DEC5:
00061F 071F 18B3            12      JR  MSG_AR
       0721                     DEC7:
000621 0721 3E20             7      LD  A,020H
000623 0723 18AF            12      JR  MSG_AR
       0725                     DEC6:
000625 0725 3E02             7      LD  A,2
000627 0727 B7               4      OR  A
000628 0728 28F7            12      JR  Z,DEC7
00062A 072A 3D               4      DEC A
00062B 072B 322607          13      LD  (DEC6+1),A
00062E 072E 3E20             7      LD  A,020H
000630 0730 C9              10      RET
                                
       0731                     FPRNT:
000631 0731 0608             7      LD  B,8
000633 0733 CD4407          17      CALL    P_N1
000636 0736 7E               7      LD  A,(HL)
000637 0737 C680             7      ADD A,0A0H-020H
000639 0739 FEA0             7      CP  0A0H
00063B 073B 2802            12      JR  Z,FPR1
00063D 073D 3E2E             7      LD  A,'.'
       073F                     FPR1:
00063F 073F CDEC0A          17      CALL    MSG_A
000642 0742 0603             7      LD  B,3
                                
       0744                     P_N1:
000644 0744 C5              11      PUSH    BC
000645 0745 E5              11      PUSH    HL
000646 0746 7E               7      LD  A,(HL)
000647 0747 CD1A0C          17      CALL    CAP3
00064A 074A CDEC0A          17      CALL    MSG_A
00064D 074D E1              10      POP HL
00064E 074E C1              10      POP BC
00064F 074F 23               6      INC HL
000650 0750 10F2            13      DJNZ    P_N1
000652 0752 C9              10      RET
                                
       0753                     PRTTMS:
000653 0753 3E20             7      LD  A,020H
000655 0755 CDEC0A          17      CALL    MSG_A
                                
000658 0758 2A9213          16      LD  HL,(DTA_CCP+1+24)
00065B 075B 7D               4      LD  A,L
00065C 075C B7               4      OR  A
00065D 075D C8              11      RET Z
00065E 075E CB3C             8      SRL H
000660 0760 17               4      RLA
000661 0761 17               4      RLA
000662 0762 17               4      RLA
000663 0763 17               4      RLA
000664 0764 E60F             7      AND 00FH
000666 0766 57               4      LD  D,A
000667 0767 DD21A011        14      LD  IX,V_DATE
       076B                     PRTTMS1:
00066B 076B DD7E00          19      LD  A,(IX+0)
00066E 076E B7               4      OR  A
00066F 076F 2808            12      JR  Z,PRTTMS2
000671 0771 CDF407          17      CALL    PR_DATE
000674 0774 CD5F08          17      CALL    PR_DATE_SPLITER
000677 0777 18F2            12      JR  PRTTMS1
       0779                     PRTTMS2:
                                
000679 0779 CDF90C          17      CALL    GET_WIDTH
00067C 077C FE21             7      CP  32+1
00067E 077E 3005            12      JR  NC,SHOW_TIME
000680 0780 3E1D             7      LD  A,01DH
000682 0782 C3EC0A          10      JP  MSG_A
       0785                     SHOW_TIME:
000685 0785 2A9013          16      LD  HL,(DTA_CCP+1+22)
                                
000688 0788 3E20             7      LD  A,020H
00068A 078A CDEC0A          17      CALL    MSG_A
00068D 078D 7C               4      LD  A,H
00068E 078E 65               4      LD  H,L
00068F 078F 1F               4      RRA
000690 0790 CB1D             8      RR  L
000692 0792 1F               4      RRA
000693 0793 CB1D             8      RR  L
000695 0795 1F               4      RRA
000696 0796 CB1D             8      RR  L
000698 0798 E61F             7      AND 01FH
00069A 079A 4F               4      LD  C,A
00069B 079B 3AC511          13      LD  A,(V_TIME)
00069E 079E FE31             7      CP  '1'
0006A0 07A0 79               4      LD  A,C
0006A1 07A1 200B            12      JR  NZ,TIME24
0006A3 07A3 FE0C             7      CP  12
0006A5 07A5 3802            12      JR  C,TIME12
0006A7 07A7 D60C             7      SUB 12
       07A9                     TIME12:
0006A9 07A9 B7               4      OR  A
0006AA 07AA 2002            12      JR  NZ,TIME24
0006AC 07AC C60C             7      ADD A,12
       07AE                     TIME24:
0006AE 07AE C5              11      PUSH    BC
0006AF 07AF CDDF07          17      CALL    PRDEC_A
0006B2 07B2 3E3A             7      LD  A,':'
0006B4 07B4 CDEC0A          17      CALL    MSG_A
0006B7 07B7 7D               4      LD  A,L
0006B8 07B8 0F               4      RRCA
0006B9 07B9 0F               4      RRCA
0006BA 07BA E63F             7      AND 03FH
0006BC 07BC CDDF07          17      CALL    PRDEC_A
                                
0006BF 07BF 3E3A             7      LD  A,':'
0006C1 07C1 CDEC0A          17      CALL    MSG_A
0006C4 07C4 7C               4      LD  A,H
0006C5 07C5 E61F             7      AND 01FH
0006C7 07C7 87               4      ADD A,A
0006C8 07C8 CDDF07          17      CALL    PRDEC_A
                                
0006CB 07CB 3AC511          13      LD  A,(V_TIME)
0006CE 07CE FE31             7      CP  '1'
0006D0 07D0 C1              10      POP BC
0006D1 07D1 C0              11      RET NZ
0006D2 07D2 79               4      LD  A,C
0006D3 07D3 1E61             7      LD  E,'a'
0006D5 07D5 FE0C             7      CP  12
0006D7 07D7 DACF0A          10      JP  C,_PRINT
0006DA 07DA 1E70             7      LD  E,'p'
0006DC 07DC C3CF0A          10      JP  _PRINT
                                
                                ;   PRINT10
                                
       07DF                     PRDEC_A:
0006DF 07DF E5              11      PUSH    HL
0006E0 07E0 0608             7      LD  B,8
0006E2 07E2 4F               4      LD  C,A
0006E3 07E3 AF               4      XOR A
       07E4                     PRTA1:
0006E4 07E4 CB01             8      RLC C
0006E6 07E6 8F               4      ADC A,A
0006E7 07E7 27               4      DAA
0006E8 07E8 10FA            13      DJNZ    PRTA1
0006EA 07EA 21AB13          10      LD  HL,DECBF
0006ED 07ED 77               7      LD  (HL),A
0006EE 07EE AF               4      XOR A
0006EF 07EF CD1307          17      CALL    DECX
0006F2 07F2 E1              10      POP HL
0006F3 07F3 C9              10      RET
                                
       07F4                     PR_DATE:
0006F4 07F4 DD7E00          19      LD  A,(IX+0)
0006F7 07F7 FE20             7      CP  020H
0006F9 07F9 D8              11      RET C
0006FA 07FA CD0E0C          17      CALL    CAP
0006FD 07FD FE44             7      CP  'D'
0006FF 07FF 2848            12      JR  Z,PR_DAY
000701 0801 FE4D             7      CP  'M'
000703 0803 2820            12      JR  Z,PR_MONTH
000705 0805 FE59             7      CP  'Y'
000707 0807 2046            12      JR  NZ,PR_DATE1
000709 0809 4F               4      LD  C,A
00070A 080A DD7E02          19      LD  A,(IX+2)
00070D 080D CD0E0C          17      CALL    CAP
000710 0810 B9               4      CP  C
000711 0811 200A            12      JR  NZ,YEAR2
000713 0813 7C               4      LD  A,H     ;YEAR
000714 0814 C6EC             7      ADD A,80+256-100
000716 0816 3E13             7      LD  A,19
000718 0818 CE00             7      ADC A,0
00071A 081A CDDF07          17      CALL    PRDEC_A     ;年4桁
       081D                     YEAR2:
00071D 081D 7C               4      LD  A,H     ;YEAR
00071E 081E C650             7      ADD A,80
000720 0820 CDDF07          17      CALL    PRDEC_A
000723 0823 182A            12      JR  PR_DATE1
       0825                     PR_MONTH:
000725 0825 4F               4      LD  C,A
000726 0826 DD7E02          19      LD  A,(IX+2)
000729 0829 CD0E0C          17      CALL    CAP
00072C 082C B9               4      CP  C
00072D 082D 2014            12      JR  NZ,MONTH2
00072F 082F E5              11      PUSH    HL      ;月を文字列で表示 Jan等
000730 0830 D5              11      PUSH    DE
000731 0831 7A               4      LD  A,D
000732 0832 3D               4      DEC A
000733 0833 87               4      ADD A,A
000734 0834 87               4      ADD A,A
000735 0835 21DF10          10      LD  HL,S_MONTH
000738 0838 1600             7      LD  D,0
00073A 083A 5F               4      LD  E,A
00073B 083B 19              11      ADD HL,DE
00073C 083C CD3706          17      CALL    MSX
00073F 083F D1              10      POP DE
000740 0840 E1              10      POP HL
000741 0841 180C            12      JR  PR_DATE1
       0843                     MONTH2:
000743 0843 7A               4      LD  A,D     ;月を数字で表示
000744 0844 CDDF07          17      CALL    PRDEC_A
000747 0847 1806            12      JR  PR_DATE1
       0849                     PR_DAY:
000749 0849 7D               4      LD  A,L
00074A 084A E61F             7      AND 01FH
00074C 084C CDDF07          17      CALL    PRDEC_A
       084F                     PR_DATE1:
00074F 084F DD23            10      INC IX
000751 0851 DD7E00          19      LD  A,(IX+0)
000754 0854 CD0E0C          17      CALL    CAP
000757 0857 FE41             7      CP  'A'
000759 0859 D8              11      RET C
00075A 085A FE5B             7      CP  'Z'+1
00075C 085C 38F1            12      JR  C,PR_DATE1
00075E 085E C9              10      RET
       085F                     PR_DATE_SPLITER:
00075F 085F DD7E00          19      LD  A,(IX+0)
000762 0862 FE20             7      CP  020H
000764 0864 D8              11      RET C
000765 0865 DD23            10      INC IX
000767 0867 C3EC0A          10      JP  MSG_A
                                
       086A                     SETFCB:
00076A 086A CDFB0B          17      CALL    SPCUT
00076D 086D 1A               7      LD  A,(DE)
00076E 086E FE20             7      CP  020H
000770 0870 3801            12      JR  C,SETFCBA
000772 0872 1B               6      DEC DE
       0873                     SETFCBA:
000773 0873 D5              11      PUSH    DE
000774 0874 215C00          10      LD  HL,FCB1
000777 0877 115D00          10      LD  DE,FCB1+1
00077A 087A 012300          10      LD  BC,00023H
00077D 087D 70               7      LD  (HL),B      ;B=0
00077E 087E EDB0                    LDIR
000780 0880 D1              10      POP DE
000781 0881 D5              11      PUSH    DE
000782 0882 215C00          10      LD  HL,FCB1
000785 0885 DD21A812        14      LD  IX,PATH_FN1
000789 0889 CD9F0C          17      CALL    _SYS29      ;ファイル名の解析
00078C 088C 216C00          10      LD  HL,FCB2
00078F 088F DD21E812        14      LD  IX,PATH_FN2
000793 0893 CD9F0C          17      CALL    _SYS29      ;ファイル名の解析
000796 0896 E1              10      POP HL
000797 0897 010050          10      LD  BC,05000H
00079A 089A 118100          10      LD  DE,00081H
       089D                     SETFCB1:
00079D 089D 7E               7      LD  A,(HL)
00079E 089E 23               6      INC HL
00079F 089F FE20             7      CP  020H
0007A1 08A1 3805            12      JR  C,SETFCB2
0007A3 08A3 12               7      LD  (DE),A
0007A4 08A4 13               6      INC DE
0007A5 08A5 0C               4      INC C
0007A6 08A6 10F5            13      DJNZ    SETFCB1
       08A8                     SETFCB2:
0007A8 08A8 79               4      LD  A,C
0007A9 08A9 328000          13      LD  (DTA1),A
0007AC 08AC 04               4      INC B
0007AD 08AD AF               4      XOR A
       08AE                     SETFCB3:
0007AE 08AE 12               7      LD  (DE),A
0007AF 08AF 13               6      INC DE
0007B0 08B0 10FC            13      DJNZ    SETFCB3
0007B2 08B2 C9              10      RET
                                
       08B3                     C_COPY:
0007B3 08B3 CD6A08          17      CALL    SETFCB
0007B6 08B6 3AE011          13      LD  A,(MAJOR_VER)
0007B9 08B9 FE02             7      CP  2
0007BB 08BB 380D            12      JR  C,COPYI0
0007BD 08BD CD0C0D          17      CALL    IS_FOLDER_FN2
0007C0 08C0 3808            12      JR  C,COPYI0
0007C2 08C2 21B213          10      LD  HL,FDRV+1
0007C5 08C5 060B             7      LD  B,8+3
0007C7 08C7 CDC00B          17      CALL    FILE10
       08CA                     COPYI0:
0007CA 08CA 3AB113          13      LD  A,(FDRV)
0007CD 08CD 47               4      LD  B,A
0007CE 08CE B7               4      OR  A
0007CF 08CF 200B            12      JR  NZ,COPYI1
0007D1 08D1 C5              11      PUSH    BC
0007D2 08D2 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0007D4 08D4 CD0500          17      CALL    SYSTEM
0007D7 08D7 3C               4      INC A
0007D8 08D8 32B113          13      LD  (FDRV),A
0007DB 08DB C1              10      POP BC
       08DC                     COPYI1:
0007DC 08DC C640             7      ADD A,040H
0007DE 08DE 322813          13      LD  (CUR_DRV),A
0007E1 08E1 112B13          10      LD  DE,CUR_PATH
0007E4 08E4 0E59             7      LD  C,059H      ;(BDOS)カレントディレクトリの獲得(_GETCD)
0007E6 08E6 CD0500          17      CALL    SYSTEM
0007E9 08E9 CDFB08          17      CALL    COPYSUB
       08EC                     RES_CUR_PATH:
0007EC 08EC 112813          10      LD  DE,CUR_DRV
       08EF                     SET_CUR_PATH:
0007EF 08EF F5              11      PUSH    AF
0007F0 08F0 3AB113          13      LD  A,(FDRV)
0007F3 08F3 47               4      LD  B,A
0007F4 08F4 0E5A             7      LD  C,05AH      ;(BDOS)カレントディレクトリの変更(_CHDIR)
0007F6 08F6 CD0500          17      CALL    SYSTEM
0007F9 08F9 F1              10      POP AF
0007FA 08FA C9              10      RET
       08FB                     COPYSUB:
0007FB 08FB 11D713          10      LD  DE,ZERO
0007FE 08FE CD2F0B          17      CALL    FILEC2
000801 0901 216C00          10      LD  HL,FCB2
000804 0904 CDE30C          17      CALL    S29X1
                                
000807 0907 3E10             7      LD  A,010H
000809 0909 326900          13      LD  (FCB1+13),A
00080C 090C 216D00          10      LD  HL,FCB2+1
00080F 090F CDB40A          17      CALL    CWILD1
       0912                     COPY0:
000812 0912 CDB10A          17      CALL    CWILD
000815 0915 215C00          10      LD  HL,FCB1
000818 0918 CDCD02          17      CALL    OPEN_D2
00081B 091B 37               4      SCF
       091C                     COPY1:
00081C 091C C0              11      RET NZ
00081D 091D CD5903          17      CALL    DEFCB_D2
                                
000820 0920 3A8513          13      LD  A,(DTA_CCP+12)
000823 0923 CB67             8      BIT 4,A
000825 0925 2821            12      JR  Z,COPY1A
                                
000827 0927 215D00          10      LD  HL,FCB1+1
00082A 092A CD470C          17      CALL    CHKWILD
00082D 092D 3811            12      JR  C,COPY9
                                
00082F 092F 3E20             7      LD  A,020H
000831 0931 325D00          13      LD  (FCB1+1),A
000834 0934 2A9313          16      LD  HL,(DTA_CCP+26)
000837 0937 23               6      INC HL
000838 0938 226A00          16      LD  (FCB1+14),HL
00083B 093B 18D5            12      JR  COPY0
                                
       093D                     COPY8:
00083D 093D CD020E          17      CALL    SHOW_OK
       0940                     COPY9:
000840 0940 CDEC08          17      CALL    RES_CUR_PATH
000843 0943 CD4303          17      CALL    OPEN2_D2
000846 0946 18D4            12      JR  COPY1
                                
       0948                     COPY1A:
000848 0948 216C00          10      LD  HL,FCB2
00084B 094B 11B113          10      LD  DE,FDRV
00084E 094E 017B13          10      LD  BC,DTA_CCP+2
000851 0951 EDA0            16      LDI
000853 0953 3E0B             7      LD  A,11
       0955                     COPY2:
000855 0955 F5              11      PUSH    AF
000856 0956 7E               7      LD  A,(HL)
000857 0957 FE3F             7      CP  '?'
000859 0959 2001            12      JR  NZ,COPY3
00085B 095B 0A               7      LD  A,(BC)
       095C                     COPY3:
00085C 095C 12               7      LD  (DE),A
00085D 095D 03               6      INC BC
00085E 095E 13               6      INC DE
00085F 095F 23               6      INC HL
000860 0960 F1              10      POP AF
000861 0961 3D               4      DEC A
000862 0962 20F1            12      JR  NZ,COPY2
000864 0964 010500          10      LD  BC,16-11
000867 0967 EDB0                    LDIR
       0969                     PUTNAME:
000869 0969 215D00          10      LD  HL,FCB1+1
00086C 096C CD470C          17      CALL    CHKWILD
00086F 096F 300B            12      JR  NC,PUTN1
000871 0971 21B213          10      LD  HL,FDRV+1
000874 0974 CD3107          17      CALL    FPRNT
000877 0977 3E20             7      LD  A,020H
000879 0979 CDEC0A          17      CALL    MSG_A
       097C                     PUTN1:
00087C 097C 11E812          10      LD  DE,PATH_FN2
00087F 097F CDEF08          17      CALL    SET_CUR_PATH
                                
000882 0982 11B113          10      LD  DE,FDRV
000885 0985 0E16             7      LD  C,016H      ;(BDOS)ファイルの作成
000887 0987 CDC603          17      CALL    SYSTEM0
00088A 098A C22B0A          10      JP  NZ,COPYE2
00088D 098D 67               4      LD  H,A     ;A=0
00088E 098E 6F               4      LD  L,A
00088F 098F 22D213          16      LD  (FDRV+33),HL    ;(FCB)ランダム・レコード
000892 0992 22D413          16      LD  (FDRV+35),HL
000895 0995 2C               4      INC L       ;HL=1
000896 0996 22BF13          16      LD  (FDRV+14),HL    ;(FCB)レコード・サイズ
       0999                     COPY6:
000899 0999 CDC30A          17      CALL    BUFSIZ
00089C 099C CDD903          17      CALL    S27DTA_D2
00089F 099F 47               4      LD  B,A
0008A0 09A0 3C               4      INC A
0008A1 09A1 CA1A0A          10      JP  Z,COPYE
0008A4 09A4 7C               4      LD  A,H
0008A5 09A5 B5               4      OR  L
0008A6 09A6 280F            12      JR  Z,COPY7
0008A8 09A8 11B113          10      LD  DE,FDRV
0008AB 09AB C5              11      PUSH    BC
0008AC 09AC 0E26             7      LD  C,026H      ;(BDOS)ランダム・ブロック・ライト
0008AE 09AE CD0500          17      CALL    SYSTEM
0008B1 09B1 C1              10      POP BC
0008B2 09B2 B7               4      OR  A
0008B3 09B3 2065            12      JR  NZ,COPYE
0008B5 09B5 10E2            13      DJNZ    COPY6
       09B7                     COPY7:
0008B7 09B7 3AE011          13      LD  A,(MAJOR_VER)
0008BA 09BA FE02             7      CP  2
0008BC 09BC 3011            12      JR  NC,COPY7_MSX2   ;DOS2はFCBの仕様が違う
0008BE 09BE 3A8613          13      LD  A,(DTA_CCP+13)  ;(FCB)属性(アトリビュート)
0008C1 09C1 32BE13          13      LD  (FDRV+13),A ;(FCB)属性(アトリビュート)
0008C4 09C4 218D13          10      LD  HL,DTA_CCP+20
0008C7 09C7 11C513          10      LD  DE,FDRV+20  ;(FCB)更新日時
0008CA 09CA 010400          10      LD  BC,4
0008CD 09CD EDB0                    LDIR
       09CF                     COPY7_MSX2:
0008CF 09CF 11B113          10      LD  DE,FDRV
0008D2 09D2 0E10             7      LD  C,010H      ;(BDOS)ファイルのクローズ
0008D4 09D4 CDC603          17      CALL    SYSTEM0
                                
0008D7 09D7 2041            12      JR  NZ,COPYE
0008D9 09D9 3AE011          13      LD  A,(MAJOR_VER)
0008DC 09DC FE02             7      CP  2
0008DE 09DE 3837            12      JR  C,COPY_DOS2DT
                                
0008E0 09E0 ED4B2112        20      LD  BC,(HANDLE1)
0008E4 09E4 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
0008E6 09E6 CD0500          17      CALL    SYSTEM
                                
0008E9 09E9 11E812          10      LD  DE,PATH_FN2
0008EC 09EC CDEF08          17      CALL    SET_CUR_PATH
                                
0008EF 09EF 11B113          10      LD  DE,FDRV
0008F2 09F2 216B13          10      LD  HL,DOS2NAME
0008F5 09F5 CD2D0A          17      CALL    FCB2FNAME
                                
0008F8 09F8 3AEF11          13      LD  A,(SEARCH_IX+14);   (FIB)属性
0008FB 09FB 6F               4      LD  L,A
0008FC 09FC 116B13          10      LD  DE,DOS2NAME
0008FF 09FF 3E01             7      LD  A,1
000901 0A01 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000903 0A03 CDC603          17      CALL    SYSTEM0
                                
000906 0A06 DD2AF011        20      LD  IX,(SEARCH_IX+15)   ;(FIB)更新時間
00090A 0A0A 2AF211          16      LD  HL,(SEARCH_IX+17)   ;(FIB)更新日
00090D 0A0D 116B13          10      LD  DE,DOS2NAME
000910 0A10 3E01             7      LD  A,1
000912 0A12 0E51             7      LD  C,51H       ;(BDOS)_FTIME ファイルの日付および時刻の獲得・設定
000914 0A14 CDC603          17      CALL    SYSTEM0
       0A17                     COPY_DOS2DT:
000917 0A17 C33D09          10      JP  COPY8
                                
       0A1A                     COPYE:
00091A 0A1A ED4B2112        20      LD  BC,(HANDLE1)
00091E 0A1E 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
000920 0A20 CD0500          17      CALL    SYSTEM
000923 0A23 11B113          10      LD  DE,FDRV
000926 0A26 0E13             7      LD  C,013H      ;(BDOS)ファイルの削除
000928 0A28 CD0500          17      CALL    SYSTEM
       0A2B                     COPYE2:
00092B 0A2B 37               4      SCF
00092C 0A2C C9              10      RET
                                
       0A2D                     FCB2FNAME:
00092D 0A2D 1A               7      LD  A,(DE)
00092E 0A2E 13               6      INC DE
00092F 0A2F C640             7      ADD A,040H
000931 0A31 77               7      LD  (HL),A
000932 0A32 23               6      INC HL
000933 0A33 363A            10      LD  (HL),':'
000935 0A35 23               6      INC HL
                                
000936 0A36 0608             7      LD  B,8
       0A38                     FCB2FNAME1:
000938 0A38 1A               7      LD  A,(DE)
000939 0A39 FE21             7      CP  020H+1
00093B 0A3B 3807            12      JR  C,FCB2FNAME2
00093D 0A3D 13               6      INC DE
00093E 0A3E 77               7      LD  (HL),A
00093F 0A3F 23               6      INC HL
000940 0A40 10F6            13      DJNZ    FCB2FNAME1
000942 0A42 1803            12      JR  FCB2FNAME3
       0A44                     FCB2FNAME2:
000944 0A44 13               6      INC DE
000945 0A45 10FD            13      DJNZ    FCB2FNAME2
       0A47                     FCB2FNAME3:
000947 0A47 1A               7      LD  A,(DE)
000948 0A48 FE21             7      CP  020H+1
00094A 0A4A 380F            12      JR  C,FCB2FNAME5
00094C 0A4C 362E            10      LD  (HL),'.'
00094E 0A4E 23               6      INC HL
00094F 0A4F 0603             7      LD  B,3
       0A51                     FCB2FNAME4:
000951 0A51 1A               7      LD  A,(DE)
000952 0A52 13               6      INC DE
000953 0A53 FE21             7      CP  020H+1
000955 0A55 3804            12      JR  C,FCB2FNAME5
000957 0A57 77               7      LD  (HL),A
000958 0A58 23               6      INC HL
000959 0A59 10F6            13      DJNZ    FCB2FNAME4
       0A5B                     FCB2FNAME5:
00095B 0A5B 3600            10      LD  (HL),0
00095D 0A5D C9              10      RET
                                
       0A5E                     C_TYPE:
00095E 0A5E CD6A08          17      CALL    SETFCB
000961 0A61 215C00          10      LD  HL,FCB1
000964 0A64 CDCD02          17      CALL    OPEN_D2
000967 0A67 37               4      SCF
000968 0A68 C0              11      RET NZ
000969 0A69 CD6E0A          17      CALL    TYPE1
00096C 0A6C AF               4      XOR A
00096D 0A6D C9              10      RET
       0A6E                     TYPE1:
00096E 0A6E C0              11      RET NZ
00096F 0A6F CD5903          17      CALL    DEFCB_D2
000972 0A72 3E1A             7      LD  A,01AH
000974 0A74 CDEC0A          17      CALL    MSG_A
       0A77                     TYPE2:
000977 0A77 CDC30A          17      CALL    BUFSIZ
00097A 0A7A CDD903          17      CALL    S27DTA_D2
00097D 0A7D C6FE             7      ADD A,0FEH
00097F 0A7F D8              11      RET C
000980 0A80 7C               4      LD  A,H
000981 0A81 B5               4      OR  L
000982 0A82 281A            12      JR  Z,TYPEE
000984 0A84 010080          10      LD  BC,DATA
       0A87                     TYPE3:
000987 0A87 0A               7      LD  A,(BC)
000988 0A88 03               6      INC BC
000989 0A89 FE1A             7      CP  01AH
00098B 0A8B 2811            12      JR  Z,TYPEE
00098D 0A8D 5F               4      LD  E,A
00098E 0A8E C5              11      PUSH    BC
00098F 0A8F E5              11      PUSH    HL
000990 0A90 0E02             7      LD  C,2     ;(BDOS)コンソール出力
000992 0A92 CD0500          17      CALL    SYSTEM
000995 0A95 E1              10      POP HL
000996 0A96 C1              10      POP BC
000997 0A97 2B               6      DEC HL
000998 0A98 7C               4      LD  A,H
000999 0A99 B5               4      OR  L
00099A 0A9A 20EB            12      JR  NZ,TYPE3
00099C 0A9C 18D9            12      JR  TYPE2
       0A9E                     TYPEE:
00099E 0A9E 3AE011          13      LD  A,(MAJOR_VER)   ;DOS2対応
0009A1 0AA1 FE02             7      CP  2
0009A3 0AA3 3806            12      JR  C,TYPEE2
0009A5 0AA5 ED4B2112        20      LD  BC,(HANDLE1)
0009A9 0AA9 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
       0AAB                     TYPEE2:
0009AB 0AAB CD4303          17      CALL    OPEN2_D2
0009AE 0AAE A7               4      AND A
0009AF 0AAF 18BD            12      JR  TYPE1
                                
       0AB1                     CWILD:
0009B1 0AB1 215D00          10      LD  HL,FCB1+1
       0AB4                     CWILD1:
0009B4 0AB4 7E               7      LD  A,(HL)
0009B5 0AB5 FE20             7      CP  020H
0009B7 0AB7 C0              11      RET NZ
       0AB8                     CWILD2:
0009B8 0AB8 54               4      LD  D,H
0009B9 0AB9 5D               4      LD  E,L
0009BA 0ABA 13               6      INC DE
0009BB 0ABB 010A00          10      LD  BC,10
0009BE 0ABE 363F            10      LD  (HL),'?'
0009C0 0AC0 EDB0                    LDIR
0009C2 0AC2 C9              10      RET
                                
       0AC3                     BUFSIZ:
0009C3 0AC3 3A0700          13      LD  A,(SYSTEM+2)
0009C6 0AC6 D681             7      SUB (DATA/256)+1
0009C8 0AC8 E6F8             7      AND 0F8H
0009CA 0ACA 67               4      LD  H,A
0009CB 0ACB 2E00             7      LD  L,0
0009CD 0ACD C9              10      RET
                                
0009CE 0ACE E9               4  JP_HL:  JP  (HL)
                                
       0ACF                     _PRINT:
0009CF 0ACF C5              11      PUSH    BC
0009D0 0AD0 D5              11      PUSH    DE
0009D1 0AD1 E5              11      PUSH    HL
0009D2 0AD2 DDE5            15      PUSH    IX
0009D4 0AD4 0E06             7      LD  C,6
0009D6 0AD6 CD0500          17      CALL    SYSTEM
0009D9 0AD9 DDE1            14      POP IX
0009DB 0ADB E1              10      POP HL
0009DC 0ADC D1              10      POP DE
0009DD 0ADD C1              10      POP BC
0009DE 0ADE B7               4      OR  A
0009DF 0ADF C9              10      RET
                                
       0AE0                     PRTHX:
0009E0 0AE0 F5              11      PUSH    AF
0009E1 0AE1 07               4      RLCA
0009E2 0AE2 07               4      RLCA
0009E3 0AE3 07               4      RLCA
0009E4 0AE4 07               4      RLCA
0009E5 0AE5 CDE90A          17      CALL    PRTHX1
0009E8 0AE8 F1              10      POP AF
       0AE9                     PRTHX1:
0009E9 0AE9 CDFF0A          17      CALL    ASC
       0AEC                     MSG_A:
0009EC 0AEC F5              11      PUSH    AF
0009ED 0AED C5              11      PUSH    BC
0009EE 0AEE D5              11      PUSH    DE
0009EF 0AEF E5              11      PUSH    HL
0009F0 0AF0 DDE5            15      PUSH    IX
0009F2 0AF2 5F               4      LD  E,A
0009F3 0AF3 0E02             7      LD  C,2
0009F5 0AF5 CD0500          17      CALL    SYSTEM
0009F8 0AF8 DDE1            14      POP IX
0009FA 0AFA E1              10      POP HL
0009FB 0AFB D1              10      POP DE
0009FC 0AFC C1              10      POP BC
0009FD 0AFD F1              10      POP AF
0009FE 0AFE C9              10      RET
                                
       0AFF                     ASC:
0009FF 0AFF E60F             7      AND 00FH
000A01 0B01 F630             7      OR  '0'
000A03 0B03 FE39             7      CP  '9'
000A05 0B05 D8              11      RET C
000A06 0B06 C607             7      ADD A,7
000A08 0B08 C9              10      RET
                                ;       FILE
       0B09                     FILEC_D2:       ;DOS2対応
000A09 0B09 3AE011          13      LD  A,(MAJOR_VER)
000A0C 0B0C FE02             7      CP  2
000A0E 0B0E 381C            12      JR  C,FILEC
000A10 0B10 C5              11      PUSH    BC
000A11 0B11 D5              11      PUSH    DE
000A12 0B12 E5              11      PUSH    HL
000A13 0B13 CDFB0B          17      CALL    SPCUT
000A16 0B16 212812          10      LD  HL,PATH_CCP
000A19 0B19 0640             7      LD  B,64
       0B1B                     PATHCD1:
000A1B 0B1B 1A               7      LD  A,(DE)
000A1C 0B1C 13               6      INC DE
000A1D 0B1D FE20             7      CP  020H
000A1F 0B1F 3002            12      JR  NC,PATHCD2
000A21 0B21 3E00             7      LD  A,0
       0B23                     PATHCD2:
000A23 0B23 77               7      LD  (HL),A
000A24 0B24 3803            12      JR  C,PATHCD3
000A26 0B26 23               6      INC HL
000A27 0B27 10F2            13      DJNZ    PATHCD1
       0B29                     PATHCD3:
000A29 0B29 E1              10      POP HL
000A2A 0B2A D1              10      POP DE
000A2B 0B2B C1              10      POP BC
       0B2C                     FILEC:
000A2C 0B2C CD370B          17      CALL    FILE
       0B2F                     FILEC2:
000A2F 0B2F 3AB213          13      LD  A,(FDRV+1)
000A32 0B32 FE20             7      CP  020H
000A34 0B34 C8              11      RET Z
000A35 0B35 1840            12      JR  SETDIR1
                                
       0B37                     FILE:
000A37 0B37 3AE011          13      LD  A,(MAJOR_VER)   ;Tablacus Disk ROM Lite
000A3A 0B3A FE01             7      CP  1
000A3C 0B3C 283A            12      JR  Z,FILE_TDRL
       0B3E                     FILEX:
000A3E 0B3E AF               4      XOR A
000A3F 0B3F 32B113          13      LD  (FDRV),A
000A42 0B42 67               4      LD  H,A
000A43 0B43 6F               4      LD  L,A
000A44 0B44 22BF13          16      LD  (FDRV+14),HL
000A47 0B47 CDFB0B          17      CALL    SPCUT
000A4A 0B4A CDE00B          17      CALL    CCHK3
000A4D 0B4D 2812            12      JR  Z,DEVI1
000A4F 0B4F 13               6      INC DE
000A50 0B50 1A               7      LD  A,(DE)
000A51 0B51 1B               6      DEC DE
000A52 0B52 FE3A             7      CP  ':'
000A54 0B54 200B            12      JR  NZ,DEVI1
000A56 0B56 1A               7      LD  A,(DE)      ;DRIVE
000A57 0B57 CD0E0C          17      CALL    CAP
000A5A 0B5A D640             7      SUB '@'
000A5C 0B5C 13               6      INC DE
000A5D 0B5D 13               6      INC DE
000A5E 0B5E 32B113          13      LD  (FDRV),A
       0B61                     DEVI1:
000A61 0B61 1A               7      LD  A,(DE)
000A62 0B62 D65C             7      SUB 05CH        ;\
000A64 0B64 2009            12      JR  NZ,NOROOT
000A66 0B66 6F               4      LD  L,A     ;A=0でH=0のはずなのでHL=0
000A67 0B67 22CB13          16      LD  (FDRV+26),HL
000A6A 0B6A 2C               4      INC L
000A6B 0B6B 22BF13          16      LD  (FDRV+14),HL
000A6E 0B6E 13               6      INC DE
       0B6F                     NOROOT:
                                
       0B6F                     SETDIR:
000A6F 0B6F CD800B          17      CALL    FILED
000A72 0B72 1A               7      LD  A,(DE)
000A73 0B73 FE5C             7      CP  05CH        ;\
000A75 0B75 C0              11      RET NZ
000A76 0B76 13               6      INC DE
       0B77                     SETDIR1:
000A77 0B77 C9              10      RET
                                
       0B78                     FILE_TDRL:
000A78 0B78 21B113          10      LD  HL,FDRV
000A7B 0B7B 0E29             7      LD  C,029H      ;(BDOS) パス名の解析
000A7D 0B7D C30500          10      JP  SYSTEM
                                
       0B80                     FILED:
000A80 0B80 CDC70B          17      CALL    FILEI
                                
000A83 0B83 0608             7      LD  B,8
       0B85                     FILE2:
000A85 0B85 CDD50B          17      CALL    CCHKF
000A88 0B88 C8              11      RET Z
000A89 0B89 FE2A             7      CP  '*'
000A8B 0B8B 282E            12      JR  Z,FILE9
000A8D 0B8D FE2E             7      CP  '.'
000A8F 0B8F 280C            12      JR  Z,FILE4
000A91 0B91 77               7      LD  (HL),A
000A92 0B92 23               6      INC HL
000A93 0B93 10F0            13      DJNZ    FILE2
                                
       0B95                     FILE3:
000A95 0B95 CDD50B          17      CALL    CCHKF
000A98 0B98 C8              11      RET Z
000A99 0B99 FE2E             7      CP  '.'
000A9B 0B9B 20F8            12      JR  NZ,FILE3
                                
       0B9D                     FILE4:
000A9D 0B9D 21BA13          10      LD  HL,FNAME+8
000AA0 0BA0 0603             7      LD  B,3
                                
       0BA2                     FILE4L:
000AA2 0BA2 CDD50B          17      CALL    CCHKF
000AA5 0BA5 C8              11      RET Z
000AA6 0BA6 FE2E             7      CP  '.'
000AA8 0BA8 2008            12      JR  NZ,FILE12
000AAA 0BAA 32B213          13      LD  (FNAME),A   ;Parent directory(..)
000AAD 0BAD 32B313          13      LD  (FNAME+1),A
000AB0 0BB0 3E20             7      LD  A,020H
       0BB2                     FILE12:
000AB2 0BB2 FE2A             7      CP  '*'
000AB4 0BB4 280A            12      JR  Z,FILE10
000AB6 0BB6 77               7      LD  (HL),A
000AB7 0BB7 23               6      INC HL
000AB8 0BB8 10E8            13      DJNZ    FILE4L
000ABA 0BBA C9              10      RET
                                
       0BBB                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000ABB 0BBB CDC00B          17      CALL    FILE10
000ABE 0BBE 18D5            12      JR  FILE3
                                
       0BC0                     FILE10:
000AC0 0BC0 3E3F             7      LD  A,'?'
                                
       0BC2                     FILL_MEMORY:                ;HLからBバイトAで埋める
000AC2 0BC2 77               7      LD  (HL),A
000AC3 0BC3 23               6      INC HL
000AC4 0BC4 10FC            13      DJNZ    FILL_MEMORY
000AC6 0BC6 C9              10      RET
                                
       0BC7                     FILEI:              ;名前＋拡張子をスペースで初期化
000AC7 0BC7 3E20             7      LD  A,020H
000AC9 0BC9 01000B          10      LD  BC,11*256
000ACC 0BCC 21B213          10      LD  HL,FNAME
000ACF 0BCF E5              11      PUSH    HL
000AD0 0BD0 CDC20B          17      CALL    FILL_MEMORY
000AD3 0BD3 E1              10      POP HL
000AD4 0BD4 C9              10      RET
                                
       0BD5                     CCHKF:
000AD5 0BD5 1A               7      LD  A,(DE)
000AD6 0BD6 CDDD0B          17      CALL    CCHK2
000AD9 0BD9 C8              11      RET Z
000ADA 0BDA C3300C          10      JP  FKAN
                                
       0BDD                     CCHK2:
000ADD 0BDD 0C               4      INC C
000ADE 0BDE 0D               4      DEC C
000ADF 0BDF C0              11      RET NZ
       0BE0                     CCHK3:              ;ZF=1 で使えない文字
000AE0 0BE0 FE2B             7      CP  '+'
000AE2 0BE2 C8              11      RET Z
000AE3 0BE3 FE2C             7      CP  ','
000AE5 0BE5 C8              11      RET Z
000AE6 0BE6 FE2F             7      CP  '/'
000AE8 0BE8 C8              11      RET Z
000AE9 0BE9 FE3A             7      CP  ':'
000AEB 0BEB C8              11      RET Z
000AEC 0BEC FE3B             7      CP  ';'
000AEE 0BEE C8              11      RET Z
000AEF 0BEF FE3D             7      CP  '='
000AF1 0BF1 C8              11      RET Z
000AF2 0BF2 FE5C             7      CP  05CH    ;\
000AF4 0BF4 C8              11      RET Z
000AF5 0BF5 FE20             7      CP  020H
000AF7 0BF7 D0              11      RET NC
000AF8 0BF8 BF               4      CP  A       ;Z=1
000AF9 0BF9 C9              10      RET
                                
       0BFA                     SS1:
000AFA 0BFA 13               6      INC DE
       0BFB                     SPCUT:              ;スペースをカット
000AFB 0BFB 1A               7      LD  A,(DE)
000AFC 0BFC FE20             7      CP  020H
000AFE 0BFE 28FA            12      JR  Z,SS1
000B00 0C00 C9              10      RET
                                
       0C01                     TOZERO:
000B01 0C01 D5              11      PUSH    DE
       0C02                     TZ1:
000B02 0C02 1A               7      LD  A,(DE)
000B03 0C03 FE20             7      CP  20H
000B05 0C05 3803            12      JR  C,TZ2
000B07 0C07 13               6      INC DE
000B08 0C08 18F8            12      JR  TZ1
       0C0A                     TZ2:
000B0A 0C0A AF               4      XOR A
000B0B 0C0B 12               7      LD  (DE),A
000B0C 0C0C D1              10      POP DE
000B0D 0C0D C9              10      RET
                                
       0C0E                     CAP:
000B0E 0C0E FE61             7      CP  'a'
000B10 0C10 D8              11      RET C
000B11 0C11 FE7B             7      CP  'z'+1
000B13 0C13 D0              11      RET NC
000B14 0C14 D620             7      SUB 020H
000B16 0C16 C9              10      RET
       0C17                     CAP2:
000B17 0C17 CD0E0C          17      CALL    CAP
       0C1A                     CAP3:
000B1A 0C1A CD230C          17      CALL    CAP4
000B1D 0C1D FE21             7      CP  021H
000B1F 0C1F D0              11      RET NC
000B20 0C20 3E20             7      LD  A,020H
000B22 0C22 C9              10      RET
       0C23                     CAP4:
000B23 0C23 FE05             7      CP  5
000B25 0C25 C0              11      RET NZ
000B26 0C26 3EE5             7      LD  A,0E5H
000B28 0C28 C9              10      RET
                                
       0C29                     FKANC:
000B29 0C29 CB41             8      BIT 0,C
000B2B 0C2B CC170C          17      CALL    Z,CAP2
000B2E 0C2E 1801            12      JR  FKANX
       0C30                     FKAN:           ;漢字チェック
000B30 0C30 13               6      INC DE
       0C31                     FKANX:
000B31 0C31 CB41             8      BIT 0,C
000B33 0C33 CB81             8      RES 0,C
000B35 0C35 C0              11      RET NZ
000B36 0C36 FE80             7      CP  080H
000B38 0C38 D8              11      RET C
000B39 0C39 FEA0             7      CP  0A0H
000B3B 0C3B 3803            12      JR  C,FKAN1
000B3D 0C3D FEE0             7      CP  0E0H
000B3F 0C3F D8              11      RET C
       0C40                     FKAN1:
000B40 0C40 0C               4      INC C
000B41 0C41 A7               4      AND A
000B42 0C42 C9              10      RET
                                
       0C43                     CHKWILDX:
000B43 0C43 FDE5            15      PUSH    IY
000B45 0C45 E1              10      POP HL
000B46 0C46 23               6      INC HL
       0C47                     CHKWILD:
000B47 0C47 060B             7      LD  B,11
000B49 0C49 3E3F             7      LD  A,'?'
       0C4B                     CHKWIL1:
000B4B 0C4B BE               7      CP  (HL)
000B4C 0C4C 23               6      INC HL
000B4D 0C4D 37               4      SCF
000B4E 0C4E C8              11      RET Z
000B4F 0C4F 10FA            13      DJNZ    CHKWIL1
000B51 0C51 AF               4      XOR A
000B52 0C52 C9              10      RET
                                
       0C53                     CPNAME:
000B53 0C53 C5              11      PUSH    BC
000B54 0C54 D5              11      PUSH    DE
000B55 0C55 11A013          10      LD  DE,CPBUF
000B58 0C58 010700          10      LD  BC,7
000B5B 0C5B EDB0                    LDIR
000B5D 0C5D D1              10      POP DE
000B5E 0C5E D5              11      PUSH    DE
000B5F 0C5F E5              11      PUSH    HL
000B60 0C60 21A013          10      LD  HL,CPBUF
000B63 0C63 CD760C          17      CALL    CPFILE
000B66 0C66 E1              10      POP HL
000B67 0C67 D1              10      POP DE
000B68 0C68 C1              10      POP BC
000B69 0C69 2005            12      JR  NZ,CPNAME1
000B6B 0C6B 7E               7      LD  A,(HL)
000B6C 0C6C 23               6      INC HL
000B6D 0C6D 66               7      LD  H,(HL)
000B6E 0C6E 6F               4      LD  L,A
000B6F 0C6F C9              10      RET
       0C70                     CPNAME1:
000B70 0C70 23               6      INC HL
000B71 0C71 23               6      INC HL
000B72 0C72 10DF            13      DJNZ    CPNAME
000B74 0C74 37               4      SCF
000B75 0C75 C9              10      RET
                                
       0C76                     CPFILE:
000B76 0C76 C5              11      PUSH    BC
000B77 0C77 01000B          10      LD  BC,00B00H
       0C7A                     CPSTR1:
000B7A 0C7A 1A               7      LD  A,(DE)
000B7B 0C7B FE3F             7      CP  '?'     ;Wild card
000B7D 0C7D 2812            12      JR  Z,CPSTR2
000B7F 0C7F 7E               7      LD  A,(HL)
000B80 0C80 CD290C          17      CALL    FKANC
000B83 0C83 E5              11      PUSH    HL
000B84 0C84 67               4      LD  H,A
000B85 0C85 1A               7      LD  A,(DE)
000B86 0C86 CB01             8      RLC C
000B88 0C88 CD290C          17      CALL    FKANC
000B8B 0C8B CB09             8      RRC C
000B8D 0C8D BC               4      CP  H       ;CP (HL),(DE)
000B8E 0C8E E1              10      POP HL
000B8F 0C8F 2004            12      JR  NZ,CPSTR3
       0C91                     CPSTR2:
000B91 0C91 13               6      INC DE
000B92 0C92 23               6      INC HL
000B93 0C93 10E5            13      DJNZ    CPSTR1
       0C95                     CPSTR3:
000B95 0C95 C1              10      POP BC
000B96 0C96 C9              10      RET
                                
       0C97                     CPFILE2:
000B97 0C97 FD7E0D          19      LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
000B9A 0C9A F6E1             7      OR  0E1H
000B9C 0C9C 2F               4      CPL
000B9D 0C9D A6               7      AND (HL)
000B9E 0C9E C9              10      RET
                                
       0C9F                     _SYS29:     ;(BDOS)ファイル名の解析
000B9F 0C9F C5              11      PUSH    BC
000BA0 0CA0 D5              11      PUSH    DE
000BA1 0CA1 0640             7      LD  B,64
000BA3 0CA3 CDFB0B          17      CALL    SPCUT
000BA6 0CA6 DD229E13        20      LD  (DIR_CK),IX
       0CAA                     D2FN1:
000BAA 0CAA 1A               7      LD  A,(DE)
000BAB 0CAB FE21             7      CP  020H+1
000BAD 0CAD 3808            12      JR  C,D2FN2
000BAF 0CAF 13               6      INC DE
000BB0 0CB0 DD7700          19      LD  (IX+0),A
000BB3 0CB3 DD23            10      INC IX
000BB5 0CB5 10F3            13      DJNZ    D2FN1
       0CB7                     D2FN2:
000BB7 0CB7 DD360000        19      LD  (IX+0),0
000BBB 0CBB DD7EFF          19      LD  A,(IX-1)
000BBE 0CBE FE5C             7      CP  05CH        ;\
000BC0 0CC0 2018            12      JR  NZ,D2FN3
000BC2 0CC2 DD7EFE          19      LD  A,(IX-2)
000BC5 0CC5 FE3A             7      CP  ':'
000BC7 0CC7 2811            12      JR  Z,D2FN3
                                
000BC9 0CC9 DD36FF00        19      LD  (IX-1),0
000BCD 0CCD ED5B9E13        20      LD  DE,(DIR_CK)
000BD1 0CD1 CD520D          17      CALL    IS_FOLDER
000BD4 0CD4 3804            12      JR  C,D2FN3
       0CD6                     D2FN4:
000BD6 0CD6 DD36FF5C        19      LD  (IX-1),05CH ;\
       0CDA                     D2FN3:
000BDA 0CDA D1              10      POP DE
000BDB 0CDB C1              10      POP BC
000BDC 0CDC C5              11      PUSH    BC
000BDD 0CDD E5              11      PUSH    HL
000BDE 0CDE CD370B          17      CALL    FILE
000BE1 0CE1 E1              10      POP HL
000BE2 0CE2 C1              10      POP BC
       0CE3                     S29X1:
000BE3 0CE3 C5              11      PUSH    BC
000BE4 0CE4 D5              11      PUSH    DE
000BE5 0CE5 E5              11      PUSH    HL
000BE6 0CE6 EB               4      EX  DE,HL
000BE7 0CE7 21B113          10      LD  HL,FDRV
000BEA 0CEA 010D00          10      LD  BC,13
000BED 0CED EDB0                    LDIR
000BEF 0CEF 70               7      LD  (HL),B      ;B=0
000BF0 0CF0 0E03             7      LD  C,3
000BF2 0CF2 EDB0                    LDIR
000BF4 0CF4 E1              10      POP HL
000BF5 0CF5 D1              10      POP DE
000BF6 0CF6 C1              10      POP BC
000BF7 0CF7 AF               4      XOR A
000BF8 0CF8 C9              10      RET
       0CF9                     GET_WIDTH:
000BF9 0CF9 3ADF11          13      LD  A,(IS_MSX)
000BFC 0CFC B7               4      OR  A
000BFD 0CFD 2804            12      JR  Z,NOT_MSX
000BFF 0CFF 3AB0F3          13      LD  A,(LINLEN)
000C02 0D02 C9              10      RET
       0D03                     NOT_MSX:
000C03 0D03 E5              11      PUSH    HL
000C04 0D04 2A0100          16      LD  HL,(1)
000C07 0D07 2EB1             7      LD  L,0B1H
000C09 0D09 7E               7      LD  A,(HL)
000C0A 0D0A E1              10      POP HL
000C0B 0D0B C9              10      RET
                                
       0D0C                     IS_FOLDER_FN2:
000C0C 0D0C 11E812          10      LD  DE,PATH_FN2
000C0F 0D0F CD690D          17      CALL    IS_FOLDER2
000C12 0D12 D8              11      RET C
                                
000C13 0D13 110000          10      LD  DE,0
000C16 0D16 ED53DC13        20      LD  (PATH_FN2_SL),DE
000C1A 0D1A 11E812          10      LD  DE,PATH_FN2
       0D1D                     IF2_1:
000C1D 0D1D 1A               7      LD  A,(DE)
000C1E 0D1E 13               6      INC DE
000C1F 0D1F FE5C             7      CP  '\\'
000C21 0D21 2004            12      JR  NZ,IF2_2
000C23 0D23 ED53DC13        20      LD  (PATH_FN2_SL),DE
       0D27                     IF2_2:
000C27 0D27 B7               4      OR  A
000C28 0D28 20F3            12      JR  NZ,IF2_1
000C2A 0D2A ED5BDC13        20      LD  DE,(PATH_FN2_SL)
000C2E 0D2E 7A               4      LD  A,D
000C2F 0D2F B3               4      OR  E
000C30 0D30 280F            12      JR  Z,IS_FOLDER_FN2_E
000C32 0D32 AF               4      XOR A
000C33 0D33 1B               6      DEC DE
000C34 0D34 12               7      LD  (DE),A
                                
000C35 0D35 11E812          10      LD  DE,PATH_FN2
000C38 0D38 CD520D          17      CALL    IS_FOLDER
000C3B 0D3B 3009            12      JR  NC,IS2_3
000C3D 0D3D 3E5C             7      LD  A,'\\'
000C3F 0D3F 1B               6      DEC DE
000C40 0D40 12               7      LD  (DE),A
       0D41                     IS_FOLDER_FN2_E:
000C41 0D41 11E812          10      LD  DE,PATH_FN2
000C44 0D44 37               4      SCF
000C45 0D45 C9              10      RET
       0D46                     IS2_3:
000C46 0D46 ED5BDC13        20      LD  DE,(PATH_FN2_SL)
000C4A 0D4A 216C00          10      LD  HL,FCB2
000C4D 0D4D CD9F0C          17      CALL    _SYS29
000C50 0D50 37               4      SCF
000C51 0D51 C9              10      RET
                                
       0D52                     IS_FOLDER:          ;out CF=0:Folder
000C52 0D52 CDFB0B          17      CALL    SPCUT
000C55 0D55 1A               7      LD  A,(DE)
000C56 0D56 C6FF             7      ADD A,0FFH
000C58 0D58 D0              11      RET NC
000C59 0D59 AF               4      XOR A
000C5A 0D5A 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C5C 0D5C D5              11      PUSH    DE
000C5D 0D5D CDC603          17      CALL    SYSTEM0
000C60 0D60 D1              10      POP DE
000C61 0D61 37               4      SCF
000C62 0D62 C0              11      RET NZ
000C63 0D63 7D               4      LD  A,L
000C64 0D64 E610             7      AND 010H
000C66 0D66 D601             7      SUB 1
000C68 0D68 C9              10      RET
                                
       0D69                     IS_FOLDER2:         ;out CF=0:Folder
000C69 0D69 CDFB0B          17      CALL    SPCUT
000C6C 0D6C 1A               7      LD  A,(DE)
000C6D 0D6D C6FF             7      ADD A,0FFH
000C6F 0D6F D0              11      RET NC
000C70 0D70 AF               4      XOR A
000C71 0D71 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C73 0D73 D5              11      PUSH    DE
000C74 0D74 CDC603          17      CALL    SYSTEM0
000C77 0D77 D1              10      POP DE
000C78 0D78 C0              11      RET NZ
000C79 0D79 7D               4      LD  A,L
000C7A 0D7A E610             7      AND 010H
000C7C 0D7C D601             7      SUB 1
000C7E 0D7E C9              10      RET
                                
       0D7F                     C_MODE:
000C7F 0D7F 3ADF11          13      LD  A,(IS_MSX)
000C82 0D82 B7               4      OR  A
000C83 0D83 C8              11      RET Z
000C84 0D84 0E29             7      LD  C,41
000C86 0D86 3AF8FA          13      LD  A,(EXBRSA)
000C89 0D89 B7               4      OR  A
000C8A 0D8A 2802            12      JR  Z,MODE_MSX1
000C8C 0D8C 0E51             7      LD  C,81
       0D8E                     MODE_MSX1:
000C8E 0D8E C5              11      PUSH    BC
000C8F 0D8F CDE70F          17      CALL    GETNUM
000C92 0D92 C1              10      POP BC
000C93 0D93 7D               4      LD  A,L
000C94 0D94 B9               4      CP  C
000C95 0D95 301C            12      JR  NC,MODE1
000C97 0D97 B7               4      OR  A
000C98 0D98 2819            12      JR  Z,MODE1
000C9A 0D9A FE21             7      CP  33
000C9C 0D9C 381E            12      JR  C,MODE32
000C9E 0D9E 32AEF3          13      LD  (LINL40),A
000CA1 0DA1 DD216C00        14      LD  IX,INITXT
000CA5 0DA5 CDAC0D          17      CALL    CALLROM
000CA8 0DA8 DD217800        14      LD  IX,SETTXT
       0DAC                     CALLROM:
000CAC 0DAC FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000CB0 0DB0 C31C00          10      JP  CALSLT
       0DB3                     MODE1:
000CB3 0DB3 3AB0F3          13      LD  A,(LINLEN)
000CB6 0DB6 CDDF07          17      CALL    PRDEC_A
000CB9 0DB9 C37506          10      JP  LTNL
       0DBC                     MODE32:
000CBC 0DBC 32AFF3          13      LD  (LINL32),A
000CBF 0DBF DD216F00        14      LD  IX,INIT32
000CC3 0DC3 CDAC0D          17      CALL    CALLROM
000CC6 0DC6 DD217B00        14      LD  IX,SETT32
000CCA 0DCA 18E0            12      JR  CALLROM
                                
       0DCC                     C_PAUSE:
000CCC 0DCC CDFB0B          17      CALL    SPCUT
000CCF 0DCF EB               4      EX  DE,HL
000CD0 0DD0 7E               7      LD  A,(HL)
000CD1 0DD1 B7               4      OR  A
000CD2 0DD2 2003            12      JR  NZ,C_PAUSE1
000CD4 0DD4 21C410          10      LD  HL,PAUSE
       0DD7                     C_PAUSE1:
000CD7 0DD7 CD3706          17      CALL    MSX
000CDA 0DDA 0E07             7      LD  C,7     ;(BDOS)コンソール直接入力(_DIRIN)
000CDC 0DDC CD0500          17      CALL    SYSTEM
000CDF 0DDF FE03             7      CP  3
000CE1 0DE1 CA4C05          10      JP  Z,END_BATCH
000CE4 0DE4 C37506          10      JP  LTNL
                                
       0DE7                     C_ECHO:
000CE7 0DE7 CDFB0B          17      CALL    SPCUT
000CEA 0DEA EB               4      EX  DE,HL
000CEB 0DEB CD3706          17      CALL    MSX
000CEE 0DEE C37506          10      JP  LTNL
                                
       0DF1                     C_MKDIR:
000CF1 0DF1 CDFB0B          17      CALL    SPCUT
000CF4 0DF4 014490          10      LD  BC,09044H   ;B=新規作成+ディレクトリ/C=(BDOS)ファイルハンドルの作成(_CREATE)
000CF7 0DF7 CD0500          17      CALL    SYSTEM
000CFA 0DFA C6FF             7      ADD A,0FFH
000CFC 0DFC D8              11      RET C
000CFD 0DFD 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
000CFF 0DFF CD0500          17      CALL    SYSTEM
       0E02                     SHOW_OK:
000D02 0E02 11BA10          10      LD  DE,OK
000D05 0E05 0E09             7      LD  C,9     ;(BDOS)文字列出力
000D07 0E07 CD0500          17      CALL    SYSTEM
000D0A 0E0A C37506          10      JP  LTNL
                                
       0E0D                     C_RMDIR:
000D0D 0E0D CD520D          17      CALL    IS_FOLDER
000D10 0E10 D8              11      RET C
000D11 0E11 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除
000D13 0E13 CD0500          17      CALL    SYSTEM
000D16 0E16 C6FF             7      ADD A,0FFH
000D18 0E18 D8              11      RET C
000D19 0E19 18E7            12      JR  SHOW_OK
                                
       0E1B                     C_SET:
000D1B 0E1B CDFB0B          17      CALL    SPCUT
000D1E 0E1E ED53310E        20      LD  (CSET_PARAM),DE
       0E22                     CSET2:
000D22 0E22 1A               7      LD  A,(DE)
000D23 0E23 FE20             7      CP  020H
000D25 0E25 3838            12      JR  C,CSET_LIST
000D27 0E27 D63D             7      SUB '='
000D29 0E29 2803            12      JR  Z,CSET_SET
000D2B 0E2B 13               6      INC DE
000D2C 0E2C 18F4            12      JR  CSET2
       0E2E                     CSET_SET:
000D2E 0E2E 12               7      LD  (DE),A
000D2F 0E2F 13               6      INC DE
       0E31                     CSET_PARAM  EQU $+1
000D30 0E30 210000          10      LD  HL,0
000D33 0E33 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000D35 0E35 CD0500          17      CALL    SYSTEM
       0E38                     INIT_VAR:           ;環境変数の初期化
000D38 0E38 219B11          10      LD  HL,N_DATE
000D3B 0E3B 11A011          10      LD  DE,V_DATE
000D3E 0E3E 0610             7      LD  B,16
000D40 0E40 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D42 0E42 CD0500          17      CALL    SYSTEM
                                
000D45 0E45 21C011          10      LD  HL,N_TIME
000D48 0E48 11C511          10      LD  DE,V_TIME
000D4B 0E4B 0603             7      LD  B,3
000D4D 0E4D 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D4F 0E4F CD0500          17      CALL    SYSTEM
                                
000D52 0E52 210F11          10      LD  HL,N_APPEND
000D55 0E55 111611          10      LD  DE,V_APPEND
000D58 0E58 0640             7      LD  B,PATHX
000D5A 0E5A 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D5C 0E5C C30500          10      JP  SYSTEM
                                
       0E5F                     CSET_LIST:
000D5F 0E5F 3E0A             7      LD  A,10
000D61 0E61 32DE13          13      LD  (CSET_DATA),A
000D64 0E64 110100          10      LD  DE,1
       0E67                     CSET1:
000D67 0E67 D5              11      PUSH    DE
000D68 0E68 016DFF          10      LD  BC,0FF6DH   ;_FENV 環境変数の検索
000D6B 0E6B 21E013          10      LD  HL,DATA_COM
000D6E 0E6E 3600            10      LD  (HL),0
000D70 0E70 CD0500          17      CALL    SYSTEM
000D73 0E73 B7               4      OR  A
000D74 0E74 2030            12      JR  NZ,CSET_ERROR
000D76 0E76 21E013          10      LD  HL,DATA_COM
000D79 0E79 7E               7      LD  A,(HL)
000D7A 0E7A B7               4      OR  A
000D7B 0E7B 2829            12      JR  Z,CSET_ERROR
000D7D 0E7D CD3706          17      CALL    MSX
000D80 0E80 1E3D             7      LD  E,'='
000D82 0E82 CDCF0A          17      CALL    _PRINT
000D85 0E85 21E013          10      LD  HL,DATA_COM
000D88 0E88 11E014          10      LD  DE,DATA_COM+256
000D8B 0E8B 016BFF          10      LD  BC,0FF6BH   ;_GENV 環境変数の獲得
000D8E 0E8E CD0500          17      CALL    SYSTEM
000D91 0E91 21E014          10      LD  HL,DATA_COM+256
000D94 0E94 CD3706          17      CALL    MSX
000D97 0E97 CD7506          17      CALL    LTNL
000D9A 0E9A 3E0A             7      LD  A,10
000D9C 0E9C 32DE13          13      LD  (CSET_DATA),A
       0E9F                     CSET_NEXT:
000D9F 0E9F D1              10      POP DE
000DA0 0EA0 13               6      INC DE
000DA1 0EA1 7A               4      LD  A,D
000DA2 0EA2 B3               4      OR  E
000DA3 0EA3 20C2            12      JR  NZ,CSET1
000DA5 0EA5 C9              10      RET
       0EA6                     CSET_ERROR:
000DA6 0EA6 21DE13          10      LD  HL,CSET_DATA
000DA9 0EA9 35              11      DEC (HL)
000DAA 0EAA 20F3            12      JR  NZ,CSET_NEXT
       0EAC                     CSET_END:
000DAC 0EAC D1              10      POP DE
000DAD 0EAD C9              10      RET
                                
       0EAE                     C_FORMAT:
000DAE 0EAE 3ADF11          13      LD  A,(IS_MSX)
000DB1 0EB1 B7               4      OR  A
000DB2 0EB2 C8              11      RET Z
000DB3 0EB3 3AE011          13      LD  A,(MAJOR_VER)
000DB6 0EB6 FE02             7      CP  2
000DB8 0EB8 300B            12      JR  NC,FORMAT2
       0EBA                     FORMAT1:
000DBA 0EBA FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000DBE 0EBE DD214701        14      LD  IX,FORMAT
000DC2 0EC2 C31C00          10      JP  CALSLT
       0EC5                     FORMAT2:
000DC5 0EC5 CD6A08          17      CALL    SETFCB
000DC8 0EC8 3A5C00          13      LD  A,(FCB1)
000DCB 0ECB B7               4      OR  A
000DCC 0ECC 28EC            12      JR  Z,FORMAT1
000DCE 0ECE 47               4      LD  B,A
000DCF 0ECF AF               4      XOR A
000DD0 0ED0 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000DD2 0ED2 CD0500          17      CALL    SYSTEM
000DD5 0ED5 B7               4      OR  A
000DD6 0ED6 20E2            12      JR  NZ,FORMAT1
000DD8 0ED8 CD4006          17      CALL    MSXSLT
000DDB 0EDB 21DC11          10      LD  HL,PROMPT
000DDE 0EDE CD3706          17      CALL    MSX
       0EE1                     FORMAT3:
000DE1 0EE1 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DE3 0EE3 CD0500          17      CALL    SYSTEM
000DE6 0EE6 D631             7      SUB '0'+1
000DE8 0EE8 38F7            12      JR  C,FORMAT3
000DEA 0EEA 3C               4      INC A
000DEB 0EEB FE0A             7      CP  10
000DED 0EED 30F2            12      JR  NC,FORMAT3
000DEF 0EEF F5              11      PUSH    AF
000DF0 0EF0 CD7506          17      CALL    LTNL
000DF3 0EF3 21C410          10      LD  HL,PAUSE
000DF6 0EF6 CD3706          17      CALL    MSX
000DF9 0EF9 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DFB 0EFB CD0500          17      CALL    SYSTEM
000DFE 0EFE CD7506          17      CALL    LTNL
000E01 0F01 F1              10      POP AF
000E02 0F02 ED4B5B00        20      LD  BC,(FCB1-1)
000E06 0F06 210080          10      LD  HL,08000H
000E09 0F09 110040          10      LD  DE,04000H
000E0C 0F0C 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000E0E 0F0E C30500          10      JP  SYSTEM
                                
       0F11                     C_RAMDISK:
000E11 0F11 3ADF11          13      LD  A,(IS_MSX)
000E14 0F14 B7               4      OR  A
000E15 0F15 C8              11      RET Z
000E16 0F16 3AE011          13      LD  A,(MAJOR_VER)
000E19 0F19 FE02             7      CP  2
000E1B 0F1B D8              11      RET C
000E1C 0F1C CDFB0B          17      CALL    SPCUT
000E1F 0F1F 1A               7      LD  A,(DE)
000E20 0F20 FE30             7      CP  '0'
000E22 0F22 D8              11      RET C
000E23 0F23 FE3A             7      CP  '9'+1
000E25 0F25 3F               4      CCF
000E26 0F26 D8              11      RET C
000E27 0F27 CDE70F          17      CALL    GETNUM
000E2A 0F2A 110F00          10      LD  DE,15       ;切り上げの為
000E2D 0F2D 19              11      ADD HL,DE
000E2E 0F2E 7D               4      LD  A,L
000E2F 0F2F 0604             7      LD  B,4     ;16で割る
       0F31                     RAMDISK1:
000E31 0F31 CB3C             8      SRL H   ;/2
000E33 0F33 1F               4      RRA
000E34 0F34 10FB            13      DJNZ    RAMDISK1
000E36 0F36 FEFF             7      CP  0FFH
000E38 0F38 2001            12      JR  NZ,RAMDISK2
000E3A 0F3A 3D               4      DEC A
       0F3B                     RAMDISK2:
000E3B 0F3B 47               4      LD  B,A
000E3C 0F3C 0E68             7      LD  C,068H      ;(_RAMD)RAMディスクの作成あるいは消去
000E3E 0F3E CD0500          17      CALL    SYSTEM
000E41 0F41 B7               4      OR  A
000E42 0F42 CC020E          17      CALL    Z,SHOW_OK
000E45 0F45 C9              10      RET
                                
       0F46                     C_ATTRIB:
000E46 0F46 3ADF11          13      LD  A,(IS_MSX)
000E49 0F49 B7               4      OR  A
000E4A 0F4A C8              11      RET Z
000E4B 0F4B 3AE011          13      LD  A,(MAJOR_VER)
000E4E 0F4E FE02             7      CP  2
000E50 0F50 D8              11      RET C
000E51 0F51 ED53720F        20      LD  (ATTRIB_OPT),DE
                                                ;パス名を検索
       0F55                     ATTRIB1:
000E55 0F55 CDFB0B          17      CALL    SPCUT
000E58 0F58 1A               7      LD  A,(DE)
000E59 0F59 13               6      INC DE
000E5A 0F5A FE20             7      CP  ' '
000E5C 0F5C D8              11      RET C
000E5D 0F5D FE41             7      CP  'A'
000E5F 0F5F 3003            12      JR  NC,ATTRIB2
000E61 0F61 13               6      INC DE
000E62 0F62 18F1            12      JR  ATTRIB1
       0F64                     ATTRIB2:
000E64 0F64 1B               6      DEC DE
000E65 0F65 ED53DA0F        20      LD  (ATTRIB_PATH),DE
000E69 0F69 AF               4      XOR A
000E6A 0F6A 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000E6C 0F6C CDC603          17      CALL    SYSTEM0
000E6F 0F6F 37               4      SCF
000E70 0F70 C0              11      RET NZ
                                
000E71 0F71 110000          10      LD  DE,0
       0F72                     ATTRIB_OPT  EQU $-2
       0F74                     ATTRIB3:
000E74 0F74 CDFB0B          17      CALL    SPCUT
000E77 0F77 1A               7      LD  A,(DE)
000E78 0F78 13               6      INC DE
000E79 0F79 FE41             7      CP  'A'
000E7B 0F7B 305C            12      JR  NC,ATTRIB_WRITE
000E7D 0F7D FE2D             7      CP  '-'
000E7F 0F7F 280A            12      JR  Z,ATTRIB_M
000E81 0F81 FE2B             7      CP  '+'
000E83 0F83 282D            12      JR  Z,ATTRIB_P
000E85 0F85 FE2F             7      CP  '/'
000E87 0F87 1A               7      LD  A,(DE)
000E88 0F88 13               6      INC DE
000E89 0F89 18E9            12      JR  ATTRIB3
       0F8B                     ATTRIB_M:
000E8B 0F8B 1A               7      LD  A,(DE)
000E8C 0F8C 13               6      INC DE
000E8D 0F8D CD0E0C          17      CALL    CAP
000E90 0F90 FE41             7      CP  'A'
000E92 0F92 280E            12      JR  Z,ATTRIB_M_A
000E94 0F94 FE53             7      CP  'S'
000E96 0F96 280E            12      JR  Z,ATTRIB_M_S
000E98 0F98 FE48             7      CP  'H'
000E9A 0F9A 280E            12      JR  Z,ATTRIB_M_H
000E9C 0F9C FE52             7      CP  'R'
000E9E 0F9E 280E            12      JR  Z,ATTRIB_M_R
000EA0 0FA0 18D2            12      JR  ATTRIB3
       0FA2                     ATTRIB_M_A:
000EA2 0FA2 CBAD             8      RES 5,L
000EA4 0FA4 18CE            12      JR  ATTRIB3
       0FA6                     ATTRIB_M_S:
000EA6 0FA6 CB95             8      RES 2,L
000EA8 0FA8 18CA            12      JR  ATTRIB3
       0FAA                     ATTRIB_M_H:
000EAA 0FAA CB8D             8      RES 1,L
000EAC 0FAC 18C6            12      JR  ATTRIB3
       0FAE                     ATTRIB_M_R:
000EAE 0FAE CB85             8      RES 0,L
000EB0 0FB0 18C2            12      JR  ATTRIB3
       0FB2                     ATTRIB_P:
000EB2 0FB2 1A               7      LD  A,(DE)
000EB3 0FB3 13               6      INC DE
000EB4 0FB4 CD0E0C          17      CALL    CAP
000EB7 0FB7 FE41             7      CP  'A'
000EB9 0FB9 280E            12      JR  Z,ATTRIB_P_A
000EBB 0FBB FE53             7      CP  'S'
000EBD 0FBD 280E            12      JR  Z,ATTRIB_P_S
000EBF 0FBF FE48             7      CP  'H'
000EC1 0FC1 280E            12      JR  Z,ATTRIB_P_H
000EC3 0FC3 FE52             7      CP  'R'
000EC5 0FC5 280E            12      JR  Z,ATTRIB_P_R
000EC7 0FC7 18AB            12      JR  ATTRIB3
       0FC9                     ATTRIB_P_A:
000EC9 0FC9 CBED             8      SET 5,L
000ECB 0FCB 18A7            12      JR  ATTRIB3
       0FCD                     ATTRIB_P_S:
000ECD 0FCD CBD5             8      SET 2,L
000ECF 0FCF 18A3            12      JR  ATTRIB3
       0FD1                     ATTRIB_P_H:
000ED1 0FD1 CBCD             8      SET 1,L
000ED3 0FD3 189F            12      JR  ATTRIB3
       0FD5                     ATTRIB_P_R:
000ED5 0FD5 CBC5             8      SET 0,L
000ED7 0FD7 189B            12      JR  ATTRIB3
       0FD9                     ATTRIB_WRITE:
000ED9 0FD9 110000          10      LD  DE,0
       0FDA                     ATTRIB_PATH EQU $-2
000EDC 0FDC 3E01             7      LD  A,1
000EDE 0FDE 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000EE0 0FE0 CDC603          17      CALL    SYSTEM0
000EE3 0FE3 D8              11      RET C
000EE4 0FE4 C3020E          10      JP  SHOW_OK
                                
       0FE7                     GETNUM:
000EE7 0FE7 CDFB0B          17      CALL    SPCUT
000EEA 0FEA 210000          10      LD  HL,0
       0FED                     GETNUM1:
000EED 0FED 1A               7      LD  A,(DE)
000EEE 0FEE 13               6      INC DE
000EEF 0FEF D630             7      SUB '0'
000EF1 0FF1 D8              11      RET C
000EF2 0FF2 FE0A             7      CP  10
000EF4 0FF4 D0              11      RET NC
000EF5 0FF5 4D               4      LD  C,L
000EF6 0FF6 44               4      LD  B,H
000EF7 0FF7 29              11      ADD HL,HL   ;*2
000EF8 0FF8 29              11      ADD HL,HL   ;*4
000EF9 0FF9 09              11      ADD HL,BC   ;*5
000EFA 0FFA 29              11      ADD HL,HL   ;*10
000EFB 0FFB 4F               4      LD  C,A
000EFC 0FFC 0600             7      LD  B,0
000EFE 0FFE 09              11      ADD HL,BC
000EFF 0FFF 18EC            12      JR  GETNUM1
                                
       0012                     COMS    EQU 18
       1001                     COMTB:
000F01 1001 44202020202020          DB  "D      "   ;1
000F08 1008 CB05                    DW  C_DIR
000F0A 100A 44495220202020          DB  "DIR    "   ;2
000F11 1011 CB05                    DW  C_DIR
000F13 1013 434F5059202020          DB  "COPY   "   ;3
000F1A 101A B308                    DW  C_COPY
000F1C 101C 43442020202020          DB  "CD     "   ;4
000F23 1023 CB03                    DW  C_CD
000F25 1025 44454C20202020          DB  "DEL    "   ;5
000F2C 102C 6A05                    DW  C_DEL
000F2E 102E 50415448202020          DB  "PATH   "   ;6
000F35 1035 7F06                    DW  C_PATH
000F37 1037 52454E20202020          DB  "REN    "   ;7
000F3E 103E 9D05                    DW  C_REN
000F40 1040 54595045202020          DB  "TYPE   "   ;8
000F47 1047 5E0A                    DW  C_TYPE
000F49 1049 52454D20202020          DB  "REM    "   ;9
000F50 1050 6805                    DW  C_REM
000F52 1052 4D4F4445202020          DB  "MODE   "   ;10
000F59 1059 7F0D                    DW  C_MODE
000F5B 105B 50415553452020          DB  "PAUSE  "   ;11
000F62 1062 CC0D                    DW  C_PAUSE
000F64 1064 53455420202020          DB  "SET    "   ;12
000F6B 106B 1B0E                    DW  C_SET
000F6D 106D 4543484F202020          DB  "ECHO   "   ;13
000F74 1074 E70D                    DW  C_ECHO
000F76 1076 4D4B4449522020          DB  "MKDIR  "   ;14
000F7D 107D F10D                    DW  C_MKDIR
000F7F 107F 524D4449522020          DB  "RMDIR  "   ;15
000F86 1086 0D0E                    DW  C_RMDIR
000F88 1088 464F524D415420          DB  "FORMAT "   ;16
000F8F 108F AE0E                    DW  C_FORMAT
000F91 1091 52414D4449534B          DB  "RAMDISK"   ;17
000F98 1098 110F                    DW  C_RAMDISK
000F9A 109A 41545452494220          DB  "ATTRIB "   ;18
000FA1 10A1 460F                    DW  C_ATTRIB
                                
000FA3 10A3 2062797465732066    FREE:   DB  " bytes free  $"
            726565202024        
000FB1 10B1 2020203C4449523E    DIRMES: DB  "   <DIR>$"
            24                  
000FBA 10BA 4F4B24              OK: DB  "OK$"
000FBD 10BD 4572726F722124      COMERM: DB  "Error!$"
000FC4 10C4 537472696B652061    PAUSE:  DB  "Strike any key when ready ",0
            6E79206B65792077    
            68656E2072656164    
            792000              
                                
       10DF                     S_MONTH:
000FDF 10DF 4A616E00                DB  "Jan",0
000FE3 10E3 46656200                DB  "Feb",0
000FE7 10E7 4D617200                DB  "Mar",0
000FEB 10EB 41707200                DB  "Apr",0
000FEF 10EF 4D617900                DB  "May",0
000FF3 10F3 4A756E00                DB  "Jun",0
000FF7 10F7 4A756C00                DB  "Jul",0
000FFB 10FB 41756700                DB  "Aug",0
000FFF 10FF 53657000                DB  "Sep",0
001003 1103 4F637400                DB  "Oct",0
001007 1107 4E6F7600                DB  "Nov",0
00100B 110B 44656300                DB  "Dec",0
                                
       110F                     N_APPEND:
00100F 110F 415050454E4400          DB  "APPEND",0
       1116                     V_APPEND:
001016 1116                         DS  64
       1156                     N_PATH:
001056 1156 5041544800              DB  "PATH",0
       115B                     V_PATH:
00105B 115B                         DS  PATHX
       119B                     N_DATE:
00109B 119B 4441544500              DB  "DATE",0
       11A0                     V_DATE:
0010A0 11A0 79792D6D6D2D6464        DB  "yy-mm-dd"
0010A8 11A8                         DS  8
       11B0                     V_DATE1:
0010B0 11B0 6D6D2D64642D7979        DB  "mm-dd-yy"
       11B8                     V_DATE2:
0010B8 11B8 64642D6D6D2D7979        DB  "dd-mm-yy"
       11C0                     N_TIME:
0010C0 11C0 54494D4500              DB  "TIME",0
       11C5                     V_TIME:
0010C5 11C5 323400                  DB  "24",0
       11C8                     N_PROGRAM:
0010C8 11C8 50524F4752414D00        DB  "PROGRAM",0
       11D0                     N_PARAMETERS:
0010D0 11D0 504152414D455445        DB  "PARAMETERS",0
            525300              
                                
       11DB                     F_TIME:
0010DB 11DB 00                      DB  0
       11DC                     PROMPT:
0010DC 11DC 3F2000                  DB  "? ",0
       11DF                     IS_MSX:
0010DF 11DF 00                      DB  0
       11E0                     MAJOR_VER:
0010E0 11E0 00                      DB  0
       11E1                     SEARCH_IX:
0010E1 11E1                         DS  64  ;DOS2用
       1221                     HANDLE1:
001121 1221 0000                    DW  0
       1223                     PATH_POS:
001123 1223 0000                    DW  0
       1225                     PATH_DRV:
001125 1225 413A5C                  DB  "A:\\"
       1228                     PATH_CCP:
001128 1228                         DS  64  ;DOS2用
       1268                     PATH_PAR:
001168 1268                         DS  64  ;DOS2用
       12A8                     PATH_FN1:
0011A8 12A8                         DS  64  ;DOS2用
       12E8                     PATH_FN2:
0011E8 12E8                         DS  64  ;DOS2用
       1328                     CUR_DRV:
001228 1328 413A5C                  DB  "A:\\"
       132B                     CUR_PATH:
00122B 132B                         DS  64  ;DOS2用
       136B                     DOS2NAME:
00126B 136B                         DS  2+8+3+1 ;DOS2用
       1379                     DTA_CCP:
001279 1379                         DS  37
       139E                     DIR_CK:
00129E 139E 0000                    DW  0
                                
       13A0                     CPBUF:
0012A0 13A0 0000                LEFTX:  DW  0
0012A2 13A2 0000                DTAX:   DW  0
0012A4 13A4 20                      DB  020H    ;CPBUFで使う
0012A5 13A5 20                      DB  020H
0012A6 13A6 20                      DB  020H
0012A7 13A7 20                      DB  020H
0012A8 13A8 20                      DB  020H
0012A9 13A9 20                      DB  020H
0012AA 13AA 20                      DB  020H
                                
       13AB                     DECBF:
0012AB 13AB                         DS  5
       13B0                     FCB_BAT2:
0012B0 13B0 00                      DB  0
       13B1                     FDRV:
0012B1 13B1 00                      DB  0
       13B2                     FNAME:
0012B2 13B2                         DS  37
       13D7                     ZERO:
0012D7 13D7 00                      DB  0
       13D8                     FCB_BAT:
0012D8 13D8 B013                    DW  FCB_BAT2
       13DA                     X_PATH:
0012DA 13DA 0000                    DW  0
       13DC                     PATH_FN2_SL:
0012DC 13DC 0000                    DW  0
       13DE                     CSET_DATA:
0012DE 13DE 00                      DB  0
       13DF                     PROCESS:
0012DF 13DF 00                      DB  0
                                
       13E0                     DATA_COM:
[EOF:COMMAND.ASM:UTF_8]
