                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.21.0, LST:Full:4
                                
                                ;   似非COMMAND.COM
                                
                                    INCLUDE "DEF.ASM"
                                ;
                                ;   似非DOS
                                ;
       0026                     VER_BCD EQU 00026H
                                
       0005                     SYSTEM  EQU 00005H
       005C                     FCB1    EQU 0005CH
       006C                     FCB2    EQU 0006CH
       0080                     DTA1    EQU 00080H
                                
       000C                     RDSLT   EQU 0000CH
       001C                     CALSLT  EQU 0001CH
       006C                     INITXT  EQU 0006CH
       006F                     INIT32  EQU 0006FH
       0078                     SETTXT  EQU 00078H
       007B                     SETT32  EQU 0007BH
       0147                     FORMAT  EQU 00147H
                                
       0402                     MAPPER  EQU 00402H
                                
       F307                     FCB11   EQU 0F307H
       F37D                     BDOS    EQU 0F37DH
       F3AF                     LINL32  EQU 0F3AFH
       F3AE                     LINL40  EQU 0F3AEH
       F3B0                     LINLEN  EQU 0F3B0H
                                
       F41F                     KBUF    EQU 0F41FH; 318
       F55E                     BUF EQU 0F55EH; 258
                                
       F662                     DIMFLG  EQU 0F662H
       F663                     VALTYP  EQU 0F663H
       F672                     MEMSIZ  EQU 0F672H
       F6A7                     TEMP    EQU 0F6A7H
       F6AF                     SAVTXT  EQU 0F6AFH
       F6B1                     SAVSTK  EQU 0F6B1H
       F6B5                     DOT EQU 0F6B5H
       F6B9                     ONELIN  EQU 0F6B9H
                                
       F7C4                     TRCFLG  EQU 0F7C4H
                                
       FAF8                     EXBRSA  EQU 0FAF8H
                                
       FC9B                     INTFLG  EQU 0FC9BH
       FCA9                     CSRSW   EQU 0FCA9H
       FCC1                     EXPTBL  EQU 0FCC1H
       FFCA                     EXTBIOS EQU 0FFCAH
[EOF:DEF.ASM:UTF_8]
                                
       0040                     PATHX   EQU 64
                                
       8000                     DATA    EQU 08000H
                                
000000 0100                         ORG 00100H
000000 0100 C31601          10      JP  START
       0103                     TITLE:
000003 0103 0D0A70736575646F        DB  00DH,00AH,"pseudo COMMAND v$"
            20434F4D4D414E44    
            207624              
       0116                     START:
000016 0116 ED7B0600        20      LD  SP,(SYSTEM+1)
00001A 011A 0E6F             7      LD  C,06FH      ;(BDOS)MSX-DOS のバージョン番号の獲得
00001C 011C CD0500          17      CALL    SYSTEM
00001F 011F D8              11      RET C
000020 0120 211D01          10      LD  HL,0011DH
000023 0123 ED42            15      SBC HL,BC
000025 0125 78               4      LD  A,B
000026 0126 32DE11          13      LD  (MAJOR_VER),A
000029 0129 B5               4      OR  L
00002A 012A 32DD11          13      LD  (IS_MSX),A
00002D 012D B7               4      OR  A
00002E 012E CAC101          10      JP  Z,WSTART
000031 0131 21918A          10      LD  HL,08A91H
000034 0134 ED52            15      SBC HL,DE
000036 0136 2005            12      JR  NZ,NOTABLACUS
000038 0138 3E01             7      LD  A,1
00003A 013A 32DE11          13      LD  (MAJOR_VER),A
       013D                     NOTABLACUS:
00003D 013D 3ADD13          13      LD  A,(PROCESS)
000040 0140 0E61             7      LD  C,61H       ;(BDOS)親プロセスに戻る
000042 0142 47               4      LD  B,A
000043 0143 B7               4      OR  A
000044 0144 C40500          17      CALL    NZ,SYSTEM
000047 0147 AF               4      XOR A
000048 0148 32DD13          13      LD  (PROCESS),A
                                
00004B 014B 212B00          10      LD  HL,002BH    ;キャラクターセット・日時フォーマット・ビデオ信号の種別
00004E 014E CD0C00          17      CALL    RDSLT
000051 0151 0F               4      RRCA
000052 0152 0F               4      RRCA
000053 0153 0F               4      RRCA
000054 0154 0F               4      RRCA
000055 0155 E603             7      AND 3
000057 0157 2814            12      JR  Z,DATEOK
000059 0159 3D               4      DEC A
00005A 015A 21AE11          10      LD  HL,V_DATE1
00005D 015D 2806            12      JR  Z,DATECHG
00005F 015F 3D               4      DEC A
000060 0160 21B611          10      LD  HL,V_DATE2
000063 0163 2008            12      JR  NZ,DATEOK
       0165                     DATECHG:
000065 0165 119E11          10      LD  DE,V_DATE
000068 0168 010800          10      LD  BC,8
00006B 016B EDB0                    LDIR
       016D                     DATEOK:
00006D 016D CD360E          17      CALL    INIT_VAR
000070 0170 3AC4F7          13      LD  A,(TRCFLG)
000073 0173 B7               4      OR  A
000074 0174 2814            12      JR  Z,WSTART0
000076 0176 11BB10          10      LD  DE,COMERM
000079 0179 0E09             7      LD  C,9     ;(BDOS)文字列出力
00007B 017B CD0500          17      CALL    SYSTEM
00007E 017E 2AC4F7          16      LD  HL,(TRCFLG)
000081 0181 2600             7      LD  H,0
000083 0183 CDDB06          17      CALL    PRDEC_HL
000086 0186 AF               4      XOR A
000087 0187 32C4F7          13      LD  (TRCFLG),A
       018A                     WSTART0:
00008A 018A 2A0100          16      LD  HL,(1)
00008D 018D 2EDB             7      LD  L,256-37
00008F 018F 25               4      DEC H
000090 0190 22D613          16      LD  (FCB_BAT),HL
000093 0193 3A8000          13      LD  A,(DTA1)
000096 0196 B7               4      OR  A
000097 0197 2828            12      JR  Z,WSTART
000099 0199 110301          10      LD  DE,TITLE
00009C 019C 0E09             7      LD  C,9
00009E 019E CD0500          17      CALL    SYSTEM
                                
0000A1 01A1 212600          10      LD  HL,VER_BCD
0000A4 01A4 7C               4      LD  A,H
0000A5 01A5 CDE70A          17      CALL    PRTHX1
0000A8 01A8 3E2E             7      LD  A,'.'
0000AA 01AA CDEA0A          17      CALL    MSG_A
0000AD 01AD 7D               4      LD  A,L
0000AE 01AE CDDE0A          17      CALL    PRTHX
0000B1 01B1 3E0D             7      LD  A,00DH
0000B3 01B3 CDEA0A          17      CALL    MSG_A
0000B6 01B6 3E0A             7      LD  A,00AH
0000B8 01B8 CDEA0A          17      CALL    MSG_A
                                
0000BB 01BB 118100          10      LD  DE,DTA1+1
0000BE 01BE CD2802          17      CALL    COMANL
       01C1                     WSTART:
0000C1 01C1 210D11          10      LD  HL,N_APPEND
0000C4 01C4 111411          10      LD  DE,V_APPEND
0000C7 01C7 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000C9 01C9 CD0500          17      CALL    SYSTEM
                                
0000CC 01CC 21C611          10      LD  HL,N_PROGRAM
0000CF 01CF 11D513          10      LD  DE,ZERO
0000D2 01D2 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000D4 01D4 CD0500          17      CALL    SYSTEM
                                
0000D7 01D7 21CE11          10      LD  HL,N_PARAMETERS
0000DA 01DA 11D513          10      LD  DE,ZERO
0000DD 01DD 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000DF 01DF CD0500          17      CALL    SYSTEM
                                
0000E2 01E2 AF               4      XOR A
0000E3 01E3 32A9FC          13      LD  (CSRSW),A
                                
0000E6 01E6 CD7906          17      CALL    LTNL
       01E9                     COMMAND:
0000E9 01E9 E5              11      PUSH    HL
0000EA 01EA 2AD613          16      LD  HL,(FCB_BAT)
0000ED 01ED 7E               7      LD  A,(HL)
0000EE 01EE E1              10      POP HL
0000EF 01EF B7               4      OR  A
0000F0 01F0 C21B05          10      JP  NZ,C_BAT1
0000F3 01F3 CDC303          17      CALL    SETDTA1
0000F6 01F6 D5              11      PUSH    DE
0000F7 01F7 C5              11      PUSH    BC
0000F8 01F8 E5              11      PUSH    HL
0000F9 01F9 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0000FB 01FB CD0500          17      CALL    SYSTEM
0000FE 01FE E1              10      POP HL
0000FF 01FF C1              10      POP BC
000100 0200 C641             7      ADD A,'A'
000102 0202 CDEA0A          17      CALL    MSG_A
000105 0205 1E3E             7      LD  E,'>'
000107 0207 CDCD0A          17      CALL    _PRINT
00010A 020A D1              10      POP DE      ;DE=DTA1
00010B 020B 3E50             7      LD  A,80
00010D 020D 12               7      LD  (DE),A
00010E 020E 0E0A             7      LD  C,0AH       ;(BDOS)文字列入力
000110 0210 CD0500          17      CALL    SYSTEM
000113 0213 CD7906          17      CALL    LTNL
       0216                     COMMAND2:
000116 0216 118200          10      LD  DE,DTA1+2
000119 0219 CD2802          17      CALL    COMANL
00011C 021C 30CB            12      JR  NC,COMMAND
00011E 021E 11BB10          10      LD  DE,COMERM
000121 0221 0E09             7      LD  C,9     ;(BDOS)文字列出力
000123 0223 CD0500          17      CALL    SYSTEM
000126 0226 1899            12      JR  WSTART
                                
       0228                     COMANL:
000128 0228 CDFF0B          17      CALL    TOZERO
00012B 022B ED535502        20      LD  (COMST),DE
00012F 022F CD350B          17      CALL    FILE
000132 0232 D5              11      PUSH    DE
000133 0233 11B013          10      LD  DE,FNAME
000136 0236 1A               7      LD  A,(DE)
000137 0237 FE20             7      CP  020H
000139 0239 CAC602          10      JP  Z,SDVSW
00013C 023C 1B               6      DEC DE
00013D 023D 1A               7      LD  A,(DE)
00013E 023E C6FF             7      ADD A,0FFH
000140 0240 380A            12      JR  C,COMB
000142 0242 13               6      INC DE
                                
000143 0243 21FF0F          10      LD  HL,COMTB
000146 0246 3E12             7      LD  A,COMS
000148 0248 47               4      LD  B,A
000149 0249 CD510C          17      CALL    CPNAME
       024C                     COMB:
00014C 024C D1              10      POP DE
00014D 024D D2CC0A          10      JP  NC,JP_HL
       0250                     COMB2:
000150 0250 EB               4      EX  DE,HL
000151 0251 224A04          16      LD  (COMPAT),HL
                                
000154 0254 110000          10      LD  DE,0
       0255                     COMST   EQU $-2
000157 0257 21DE13          10      LD  HL,DATA_COM
00015A 025A 3600            10      LD  (HL),0
       025C                     COMPR1:
00015C 025C 1A               7      LD  A,(DE)
00015D 025D 13               6      INC DE
00015E 025E 23               6      INC HL
00015F 025F 77               7      LD  (HL),A
000160 0260 FE20             7      CP  020H
000162 0262 30F8            12      JR  NC,COMPR1
       0264                     COMPR2:
000164 0264 2B               6      DEC HL
000165 0265 7E               7      LD  A,(HL)
000166 0266 FE5C             7      CP  05CH
000168 0268 2014            12      JR  NZ,COMPR3
00016A 026A 3600            10      LD  (HL),0
00016C 026C 23               6      INC HL
00016D 026D EB               4      EX  DE,HL
00016E 026E CD350B          17      CALL    FILE
000171 0271 210D11          10      LD  HL,N_APPEND
000174 0274 11DF13          10      LD  DE,DATA_COM+1
000177 0277 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000179 0279 CD0500          17      CALL    SYSTEM
00017C 027C 1804            12      JR  COMPR4
       027E                     COMPR3:
00017E 027E FE20             7      CP  020H
000180 0280 30E2            12      JR  NC,COMPR2
       0282                     COMPR4:
000182 0282 CD0C04          17      CALL    CEXE4
                                
000185 0285 215411          10      LD  HL,N_PATH
000188 0288 115911          10      LD  DE,V_PATH
00018B 028B 0640             7      LD  B,PATHX
00018D 028D 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
00018F 028F CD0500          17      CALL    SYSTEM
                                
000192 0292 215911          10      LD  HL,V_PATH
000195 0295 22D813          16      LD  (X_PATH),HL
       0298                     CEX1:
000198 0298 2AD813          16      LD  HL,(X_PATH)
00019B 029B 7E               7      LD  A,(HL)
00019C 029C FE20             7      CP  020H
00019E 029E D8              11      RET C
       029F                     CEX2:
00019F 029F 7E               7      LD  A,(HL)
0001A0 02A0 FE20             7      CP  020H
0001A2 02A2 3807            12      JR  C,CEX3
0001A4 02A4 FE3B             7      CP  ';'
0001A6 02A6 2803            12      JR  Z,CEX3
0001A8 02A8 23               6      INC HL
0001A9 02A9 18F4            12      JR  CEX2
       02AB                     CEX3:
0001AB 02AB 3600            10      LD  (HL),0
0001AD 02AD FE20             7      CP  020H
0001AF 02AF 3801            12      JR  C,CEX4
0001B1 02B1 23               6      INC HL
       02B2                     CEX4:
0001B2 02B2 ED5BD813        20      LD  DE,(X_PATH)
0001B6 02B6 22D813          16      LD  (X_PATH),HL
0001B9 02B9 210D11          10      LD  HL,N_APPEND
0001BC 02BC 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0001BE 02BE CD0500          17      CALL    SYSTEM
                                
0001C1 02C1 CD0C04          17      CALL    CEXE4
0001C4 02C4 18D2            12      JR  CEX1
                                
       02C6                     SDVSW:
0001C6 02C6 F1              10      POP AF
0001C7 02C7 3AAF13          13      LD  A,(FDRV)
0001CA 02CA 3D               4      DEC A
0001CB 02CB 5F               4      LD  E,A
0001CC 02CC 0E0E             7      LD  C,00EH      ;(BDOS)カレントドライブの設定
0001CE 02CE C3CA03          10      JP  SYSTEM0
                                
       02D1                     OPEN_D2:            ;DOS2対応
0001D1 02D1 3ADE11          13      LD  A,(MAJOR_VER)
0001D4 02D4 FE02             7      CP  2
0001D6 02D6 384F            12      JR  C,OPEN
0001D8 02D8 11A612          10      LD  DE,PATH_FN1
0001DB 02DB 180A            12      JR  OPEN_D2X
       02DD                     OPEN1_D2:           ;DOS2対応
0001DD 02DD 3ADE11          13      LD  A,(MAJOR_VER)
0001E0 02E0 FE02             7      CP  2
0001E2 02E2 3840            12      JR  C,OPEN1
                                
0001E4 02E4 112612          10      LD  DE,PATH_CCP
       02E7                     OPEN_D2X:
0001E7 02E7 DD21DF11        14      LD  IX,SEARCH_IX
0001EB 02EB 014010          10      LD  BC,01040H   ;(BDOS)最初のエントリ検索
0001EE 02EE CD0500          17      CALL    SYSTEM
0001F1 02F1 F5              11      PUSH    AF
0001F2 02F2 116612          10      LD  DE,PATH_PAR
0001F5 02F5 0E5E             7      LD  C,05EH      ;(BDOS)完全なパス文字列の獲得(_WPATH)
0001F7 02F7 CD0500          17      CALL    SYSTEM
0001FA 02FA AF               4      XOR A
0001FB 02FB 77               7      LD  (HL),A
0001FC 02FC 116612          10      LD  DE,PATH_PAR
0001FF 02FF ED52            15      SBC HL,DE
000201 0301 222112          16      LD  (PATH_POS),HL
000204 0304 F1              10      POP AF
       0305                     FIB2DIRENT:
000205 0305 B7               4      OR  A
000206 0306 C0              11      RET NZ
                                
000207 0307 11E011          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
00020A 030A 217813          10      LD  HL,DTA_CCP+1
00020D 030D 0E5C             7      LD  C,05CH      ;(BDOS)ファイル名の解析
00020F 030F CD0500          17      CALL    SYSTEM
                                
000212 0312 21ED11          10      LD  HL,SEARCH_IX+14 ;(FIB)属性
000215 0315 118313          10      LD  DE,DTA_CCP+1+8+3
000218 0318 EDA0            16      LDI
00021A 031A 118E13          10      LD  DE,DTA_CCP+1+8+3+1+10
00021D 031D 010A00          10      LD  BC,2+2+2+4  ;最終変更時刻+最終変更日付+開始クラスタ+ファイルサイズ
000220 0320 EDB0                    LDIR
000222 0322 AF               4      XOR A
000223 0323 C9              10      RET
                                
       0324                     OPEN1:
000224 0324 21AF13          10      LD  HL,FDRV
       0327                     OPEN:
000227 0327 0E11             7      LD  C,011H      ;(BDOS)最初のファイルの検索
       0329                     OPEN3:
000229 0329 D5              11      PUSH    DE
00022A 032A 117713          10      LD  DE,DTA_CCP
00022D 032D CDB603          17      CALL    SETDTA
000230 0330 C5              11      PUSH    BC
000231 0331 E5              11      PUSH    HL
000232 0332 010E00          10      LD  BC,14
000235 0335 09              11      ADD HL,BC
000236 0336 224103          16      LD  (OPEN3_SWC),HL
000239 0339 E1              10      POP HL
00023A 033A C1              10      POP BC
00023B 033B EB               4      EX  DE,HL
00023C 033C CDCA03          17      CALL    SYSTEM0
00023F 033F D1              10      POP DE
000240 0340 2A0000          16      LD  HL,(0)      ;Tablacus Disk ROM Lite　階層ディレクトリ
       0341                     OPEN3_SWC   EQU $-2
000243 0343 228513          16      LD  (DTA_CCP+14),HL
000246 0346 C9              10      RET
                                
       0347                     OPEN2_D2:           ;DOS2対応
000247 0347 3ADE11          13      LD  A,(MAJOR_VER)
00024A 034A FE02             7      CP  2
00024C 034C 380B            12      JR  C,OPEN2
00024E 034E DD21DF11        14      LD  IX,SEARCH_IX
000252 0352 0E41             7      LD  C,41H       ;(BDOS)次のエントリ検索
000254 0354 CD0500          17      CALL    SYSTEM
000257 0357 18AC            12      JR  FIB2DIRENT
       0359                     OPEN2:
000259 0359 0E12             7      LD  C,012H
00025B 035B 18CC            12      JR  OPEN3
                                
       035D                     DEFCB_D2:           ;DOS2対応
00025D 035D 3ADE11          13      LD  A,(MAJOR_VER)
000260 0360 FE02             7      CP  2
000262 0362 383A            12      JR  C,DEFCB
000264 0364 216612          10      LD  HL,PATH_PAR
000267 0367 112612          10      LD  DE,PATH_CCP
00026A 036A 014000          10      LD  BC,64
00026D 036D EDB0                    LDIR
00026F 036F 2A2112          16      LD  HL,(PATH_POS)
000272 0372 112612          10      LD  DE,PATH_CCP
000275 0375 19              11      ADD HL,DE
000276 0376 060D             7      LD  B,13
000278 0378 11E011          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
       037B                     DCB4:
00027B 037B 1A               7      LD  A,(DE)
00027C 037C B7               4      OR  A
00027D 037D 2805            12      JR  Z,DCB5
00027F 037F 13               6      INC DE
000280 0380 77               7      LD  (HL),A
000281 0381 23               6      INC HL
000282 0382 18F7            12      JR  DCB4
       0384                     DCB5:
000284 0384 3600            10      LD  (HL),0
000286 0386 3AF811          13      LD  A,(SEARCH_IX+25)    ;(FIB)ドライブ番号(1-8)
000289 0389 C640             7      ADD A,040H
00028B 038B 112312          10      LD  DE,PATH_DRV
00028E 038E 12               7      LD  (DE),A
00028F 038F 0E43             7      LD  C,043H      ;_OPEN ファイルハンドルのオープン
000291 0391 3E01             7      LD  A,1     ;書き込み禁止
000293 0393 CD0500          17      CALL    SYSTEM
000296 0396 B7               4      OR  A
000297 0397 C0              11      RET NZ
000298 0398 ED431F12        20      LD  (HANDLE1),BC
00029C 039C 1815            12      JR  SETDTA100
       039E                     DEFCB:              ;Z=Ok NZ=Error
00029E 039E 117713          10      LD  DE,DTA_CCP
0002A1 03A1 CDC803          17      CALL    SYSC0F
0002A4 03A4 B7               4      OR  A
0002A5 03A5 C0              11      RET NZ
                                
0002A6 03A6 210100          10      LD  HL,1
0002A9 03A9 228513          16      LD  (DTA_CCP+14),HL
0002AC 03AC 2D               4      DEC L
0002AD 03AD 229813          16      LD  (DTA_CCP+33),HL
0002B0 03B0 229A13          16      LD  (DTA_CCP+35),HL
       03B3                     SETDTA100:
0002B3 03B3 110080          10      LD  DE,DATA
       03B6                     SETDTA:
0002B6 03B6 C5              11      PUSH    BC
0002B7 03B7 D5              11      PUSH    DE
0002B8 03B8 E5              11      PUSH    HL
0002B9 03B9 0E1A             7      LD  C,01AH      ;(BDOS)DTAの設定
0002BB 03BB CD0500          17      CALL    SYSTEM
0002BE 03BE E1              10      POP HL
0002BF 03BF D1              10      POP DE
0002C0 03C0 C1              10      POP BC
0002C1 03C1 AF               4      XOR A
0002C2 03C2 C9              10      RET
                                
       03C3                     SETDTA1:
0002C3 03C3 118000          10      LD  DE,DTA1
0002C6 03C6 18EE            12      JR  SETDTA
                                
       03C8                     SYSC0F:
0002C8 03C8 0E0F             7      LD  C,00FH      ;(BDOS)ファイルのオープン
       03CA                     SYSTEM0:
0002CA 03CA CD0500          17      CALL    SYSTEM
0002CD 03CD B7               4      OR  A
0002CE 03CE C9              10      RET
                                
       03CF                     C_CD:
0002CF 03CF CDF90B          17      CALL    SPCUT
0002D2 03D2 1A               7      LD  A,(DE)
0002D3 03D3 FE20             7      CP  020H
0002D5 03D5 DA1A06          10      JP  C,PWD
       03D8                     CD1:
0002D8 03D8 0E5A             7      LD  C,5AH       ;(BDOS)_CHDIR カレントディレクトリの変更
0002DA 03DA C30500          10      JP  SYSTEM
                                
       03DD                     S27DTA_D2:      ;DOS2対応
0002DD 03DD 3ADE11          13      LD  A,(MAJOR_VER)
0002E0 03E0 FE02             7      CP  2
0002E2 03E2 3817            12      JR  C,S27DTA
0002E4 03E4 ED4B1F12        20      LD  BC,(HANDLE1)
0002E8 03E8 110080          10      LD  DE,DATA
0002EB 03EB 0E48             7      LD  C,048H      ;(BDOS)ファイルハンドルからの読み出し(_READ)
0002ED 03ED CDCA03          17      CALL    SYSTEM0
0002F0 03F0 C8              11      RET Z
0002F1 03F1 FEC7             7      CP  0C7H        ;.EOF
0002F3 03F3 2803            12      JR  Z,S27EOF
0002F5 03F5 37               4      SCF
0002F6 03F6 9F               4      SBC A,A
0002F7 03F7 C9              10      RET
       03F8                     S27EOF:
0002F8 03F8 3E01             7      LD  A,1
0002FA 03FA C9              10      RET
                                
       03FB                     S27DTA:
0002FB 03FB 110100          10      LD  DE,1
0002FE 03FE ED538513        20      LD  (DTA_CCP+14),DE
000302 0402 117713          10      LD  DE,DTA_CCP
       0405                     S27:
000305 0405 0E27             7      LD  C,027H      ;(BDOS)ランダム・ブロック・リード
000307 0407 CD0500          17      CALL    SYSTEM
00030A 040A B7               4      OR  A
00030B 040B C9              10      RET
                                
       040C                     CEXE4:
00030C 040C 21AF13          10      LD  HL,FDRV
00030F 040F 117713          10      LD  DE,DTA_CCP
000312 0412 010900          10      LD  BC,1+8
000315 0415 EDB0                    LDIR
000317 0417 218013          10      LD  HL,DTA_CCP+9
00031A 041A 3643            10      LD  (HL),'C'
00031C 041C 23               6      INC HL
00031D 041D 364F            10      LD  (HL),'O'
00031F 041F 23               6      INC HL
000320 0420 364D            10      LD  (HL),'M'
       0422                     C_EXE:
000322 0422 CD9E03          17      CALL    DEFCB
000325 0425 C2F304          10      JP  NZ,C_BAT
000328 0428 11DE13          10      LD  DE,DATA_COM
00032B 042B CDB603          17      CALL    SETDTA
                                
00032E 042E 2A0600          16      LD  HL,(SYSTEM+1)
000331 0431 11DE13          10      LD  DE,DATA_COM
000334 0434 ED52            15      SBC HL,DE
                                
000336 0436 CDFB03          17      CALL    S27DTA
000339 0439 3D               4      DEC A
00033A 043A 37               4      SCF
00033B 043B C0              11      RET NZ
00033C 043C 7C               4      LD  A,H
00033D 043D B5               4      OR  L
00033E 043E 37               4      SCF
00033F 043F C8              11      RET Z
000340 0440 22ED04          16      LD  (COMSIZ),HL
                                
000343 0443 11DE13          10      LD  DE,DATA_COM
000346 0446 CDB603          17      CALL    SETDTA
000349 0449 110000          10      LD  DE,0
       044A                     COMPAT  EQU $-2
00034C 044C CD6808          17      CALL    SETFCB
                                
00034F 044F 210D11          10      LD  HL,N_APPEND
000352 0452 112612          10      LD  DE,PATH_CCP
000355 0455 0640             7      LD  B,PATHX
000357 0457 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000359 0459 CD0500          17      CALL    SYSTEM
00035C 045C 3A2612          13      LD  A,(PATH_CCP)
00035F 045F B7               4      OR  A
000360 0460 201D            12      JR  NZ,COM_ENV1
000362 0462 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
000364 0464 CD0500          17      CALL    SYSTEM
000367 0467 C641             7      ADD A,'A'
000369 0469 322612          13      LD  (PATH_CCP),A
00036C 046C 3E3A             7      LD  A,':'
00036E 046E 322712          13      LD  (PATH_CCP+1),A
000371 0471 3E5C             7      LD  A,05CH      ;\
000373 0473 322812          13      LD  (PATH_CCP+2),A
000376 0476 47               4      LD  B,A     ;ドライブ
000377 0477 112812          10      LD  DE,PATH_CCP+2
00037A 047A 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
00037C 047C CD0500          17      CALL    SYSTEM
       047F                     COM_ENV1:
00037F 047F 117713          10      LD  DE,DTA_CCP
000382 0482 216913          10      LD  HL,DOS2NAME
000385 0485 CD2B0A          17      CALL    FCB2FNAME
000388 0488 112612          10      LD  DE,PATH_CCP
00038B 048B 216B13          10      LD  HL,DOS2NAME+2
       048E                     COM_ENV2:
00038E 048E 1A               7      LD  A,(DE)
00038F 048F B7               4      OR  A
000390 0490 2803            12      JR  Z,COM_ENV3
000392 0492 13               6      INC DE
000393 0493 18F9            12      JR  COM_ENV2
       0495                     COM_ENV3:
000395 0495 1B               6      DEC DE
000396 0496 1A               7      LD  A,(DE)
000397 0497 13               6      INC DE
000398 0498 FE5C             7      CP  05CH
00039A 049A 2804            12      JR  Z,COM_ENV4
00039C 049C 3E5C             7      LD  A,05CH
00039E 049E 12               7      LD  (DE),A
00039F 049F 13               6      INC DE
       04A0                     COM_ENV4:
0003A0 04A0 7E               7      LD  A,(HL)
0003A1 04A1 23               6      INC HL
0003A2 04A2 12               7      LD  (DE),A
0003A3 04A3 13               6      INC DE
0003A4 04A4 B7               4      OR  A
0003A5 04A5 20F9            12      JR  NZ,COM_ENV4
                                
0003A7 04A7 21C611          10      LD  HL,N_PROGRAM
0003AA 04AA 112612          10      LD  DE,PATH_CCP
0003AD 04AD 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003AF 04AF CD0500          17      CALL    SYSTEM
                                
0003B2 04B2 21CE11          10      LD  HL,N_PARAMETERS
0003B5 04B5 118100          10      LD  DE,DTA1+1
0003B8 04B8 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003BA 04BA CD0500          17      CALL    SYSTEM
                                
0003BD 04BD 210D11          10      LD  HL,N_APPEND
0003C0 04C0 111411          10      LD  DE,V_APPEND
0003C3 04C3 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003C5 04C5 CD0500          17      CALL    SYSTEM
                                
0003C8 04C8 0E60             7      LD  C,60H       ;(BDOS)子プロセスの起動
0003CA 04CA CD0500          17      CALL    SYSTEM
0003CD 04CD B7               4      OR  A
0003CE 04CE 2004            12      JR  NZ,COMP1
0003D0 04D0 78               4      LD  A,B
0003D1 04D1 32DD13          13      LD  (PROCESS),A
       04D4                     COMP1:
0003D4 04D4 AF               4      XOR A
0003D5 04D5 67               4      LD  H,A
0003D6 04D6 6F               4      LD  L,A ;HL=0x0000
0003D7 04D7 32C4F7          13      LD  (TRCFLG),A
0003DA 04DA F3               4      DI
0003DB 04DB ED7B0600        20      LD  SP,(SYSTEM+1)
0003DF 04DF E5              11      PUSH    HL
0003E0 04E0 21EDB0          10      LD  HL,0B0EDH   ;LDIR
0003E3 04E3 22FE00          16      LD  (000FEH),HL
0003E6 04E6 21DE13          10      LD  HL,DATA_COM
0003E9 04E9 110001          10      LD  DE,00100H
0003EC 04EC 010000          10      LD  BC,0
       04ED                     COMSIZ  EQU $-2
0003EF 04EF FB               4      EI
0003F0 04F0 C3FE00          10      JP  000FEH
                                
       04F3                     C_BAT:
0003F3 04F3 218013          10      LD  HL,DTA_CCP+9
0003F6 04F6 3642            10      LD  (HL),'B'
0003F8 04F8 23               6      INC HL
0003F9 04F9 3641            10      LD  (HL),'A'
0003FB 04FB 23               6      INC HL
0003FC 04FC 3654            10      LD  (HL),'T'
                                
0003FE 04FE CD9E03          17      CALL    DEFCB
000401 0501 C0              11      RET NZ
                                
000402 0502 217713          10      LD  HL,DTA_CCP
000405 0505 7E               7      LD  A,(HL)
000406 0506 B7               4      OR  A
000407 0507 2009            12      JR  NZ,CBAT_DS
000409 0509 E5              11      PUSH    HL
00040A 050A 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
00040C 050C CD0500          17      CALL    SYSTEM
00040F 050F E1              10      POP HL
000410 0510 3C               4      INC A
000411 0511 77               7      LD  (HL),A
       0512                     CBAT_DS:
000412 0512 ED5BD613        20      LD  DE,(FCB_BAT)
000416 0516 012500          10      LD  BC,37
000419 0519 EDB0                    LDIR
       051B                     C_BAT1:
00041B 051B CDB303          17      CALL    SETDTA100
00041E 051E CD5C05          17      CALL    FGETC_BAT
000421 0521 218100          10      LD  HL,DTA1+1
000424 0524 202A            12      JR  NZ,END_BATCH
000426 0526 FE21             7      CP  021H        ;スペースや改行など制御文字を飛ばす
000428 0528 38F1            12      JR  C,C_BAT1
00042A 052A 3620            10      LD  (HL),' '
00042C 052C 23               6      INC HL
       052D                     C_BAT2:
00042D 052D 77               7      LD  (HL),A
00042E 052E 23               6      INC HL
00042F 052F 7D               4      LD  A,L
000430 0530 3C               4      INC A       ;L==0FFH
000431 0531 2809            12      JR  Z,RUN_BATCH
000433 0533 CD5C05          17      CALL    FGETC_BAT
000436 0536 2004            12      JR  NZ,RUN_BATCH
000438 0538 FE20             7      CP  020H
00043A 053A 30F1            12      JR  NC,C_BAT2
       053C                     RUN_BATCH:
00043C 053C 7D               4      LD  A,L
00043D 053D D67F             7      SUB DTA1-1
00043F 053F 328000          13      LD  (DTA1),A
000442 0542 FE04             7      CP  4
000444 0544 380A            12      JR  C,END_BATCH
000446 0546 3600            10      LD  (HL),0
000448 0548 3A9BFC          13      LD  A,(INTFLG)
00044B 054B FE03             7      CP  3
00044D 054D C21602          10      JP  NZ,COMMAND2
       0550                     END_BATCH:      ;バッチファイルを閉じる
000450 0550 2AD613          16      LD  HL,(FCB_BAT)
000453 0553 3600            10      LD  (HL),0
000455 0555 ED7B0600        20      LD  SP,(SYSTEM+1)
000459 0559 C3C101          10      JP  WSTART
                                
       055C                     FGETC_BAT:
00045C 055C ED5BD613        20      LD  DE,(FCB_BAT)
       0560                     FGETC:              ;1文字ずつ読み込む
000460 0560 E5              11      PUSH    HL      ;Z:成功
000461 0561 210100          10      LD  HL,1
000464 0564 CD0504          17      CALL    S27
000467 0567 E1              10      POP HL
000468 0568 3A0080          13      LD  A,(DATA)
00046B 056B C9              10      RET
                                
       056C                     C_REM:
00046C 056C AF               4      XOR A
00046D 056D C9              10      RET
                                
       056E                     C_DEL:
00046E 056E CD6808          17      CALL    SETFCB
000471 0571 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力
000473 0573 CD0500          17      CALL    SYSTEM
000476 0576 0600             7      LD  B,0
000478 0578 3ADE11          13      LD  A,(MAJOR_VER)
00047B 057B FE02             7      CP  2
00047D 057D 381E            12      JR  C,CDEL_DOS1
                                
00047F 057F 215C00          10      LD  HL,FCB1
000482 0582 CDD102          17      CALL    OPEN_D2
000485 0585 37               4      SCF
       0586                     DEL1:
000486 0586 C0              11      RET NZ
000487 0587 3AED11          13      LD  A,(SEARCH_IX+14);   (FIB)属性
00048A 058A CB67             8      BIT 4,A
00048C 058C 200A            12      JR  NZ,DEL2
                                
00048E 058E 11DF11          10      LD  DE,SEARCH_IX
000491 0591 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除(_DELETE)
000493 0593 CDCA03          17      CALL    SYSTEM0
000496 0596 37               4      SCF
000497 0597 C0              11      RET NZ
       0598                     DEL2:
000498 0598 CD4703          17      CALL    OPEN2_D2
00049B 059B 18E9            12      JR  DEL1
                                
       059D                     CDEL_DOS1:
00049D 059D 0E13             7      LD  C,013H
00049F 059F 1811            12      JR  CDEL1       ;(BDOS)ファイルの削除
                                
       05A1                     C_REN:
0004A1 05A1 3ADE11          13      LD  A,(MAJOR_VER)
0004A4 05A4 FE02             7      CP  2
0004A6 05A6 3013            12      JR  NC,REN_DOS2
0004A8 05A8 CD6808          17      CALL    SETFCB
0004AB 05AB 3E10             7      LD  A,010H      ;ディレクトリも対象にする(LSX-Dodgers)
0004AD 05AD 326900          13      LD  (FCB1+13),A ;属性
0004B0 05B0 0E17             7      LD  C,017H      ;(BDOS)ファイル名の変更
       05B2                     CDEL1:
0004B2 05B2 115C00          10      LD  DE,FCB1
       05B5                     REN2:
0004B5 05B5 CD0500          17      CALL    SYSTEM
0004B8 05B8 C6FF             7      ADD A,0FFH
0004BA 05BA C9              10      RET
                                
       05BB                     REN_DOS2:           ;DOS2のリネーム(ディレクトリ対応)
0004BB 05BB CDF90B          17      CALL    SPCUT
0004BE 05BE 6B               4      LD  L,E
0004BF 05BF 62               4      LD  H,D
       05C0                     REN_D2_1:
0004C0 05C0 7E               7      LD  A,(HL)
0004C1 05C1 FE21             7      CP  020H+1
0004C3 05C3 3803            12      JR  C,REN_D2_2
0004C5 05C5 23               6      INC HL
0004C6 05C6 18F8            12      JR  REN_D2_1
       05C8                     REN_D2_2:
0004C8 05C8 3600            10      LD  (HL),0
0004CA 05CA 23               6      INC HL
0004CB 05CB 0E4E             7      LD  C,04EH      ;(BDOS)ファイルあるいはサブディレクトリ名の変更(_RENAME)
0004CD 05CD 18E6            12      JR  REN2
                                
       05CF                     C_DIR:
0004CF 05CF CD070B          17      CALL    FILEC_D2
0004D2 05D2 21B013          10      LD  HL,FDRV+1
0004D5 05D5 CDB20A          17      CALL    CWILD1
0004D8 05D8 3EF1             7      LD  A,0F1H
0004DA 05DA 32BC13          13      LD  (FDRV+13),A
0004DD 05DD CDDD02          17      CALL    OPEN1_D2
       05E0                     CDIR1:
0004E0 05E0 B7               4      OR  A
0004E1 05E1 2008            12      JR  NZ,PDSKF
0004E3 05E3 CD5106          17      CALL    P_NAME
0004E6 05E6 CD4703          17      CALL    OPEN2_D2
0004E9 05E9 18F5            12      JR  CDIR1
                                
       05EB                     PDSKF:
0004EB 05EB 3AAF13          13      LD  A,(FDRV)
0004EE 05EE 5F               4      LD  E,A
0004EF 05EF 0E1B             7      LD  C,01BH      ;(BDOS)ディスク情報の獲得
0004F1 05F1 CD0500          17      CALL    SYSTEM
0004F4 05F4 4F               4      LD  C,A     ;C←1クラスタ辺りの論理セクタ数
0004F5 05F5 C601             7      ADD A,001H
0004F7 05F7 D8              11      RET C       ;Aが0FFHだった場合
0004F8 05F8 3E06             7      LD  A,8-2
       05FA                     PDS1:               ;HL=未使用クラスタの総数
0004FA 05FA 3C               4      INC A
0004FB 05FB CB19             8      RR  C
0004FD 05FD 30FB            12      JR  NC,PDS1
       05FF                     PDS2:               ;B←論理セクタのサイズの上位8ビット
0004FF 05FF 3C               4      INC A
000500 0600 CB18             8      RR  B
000502 0602 30FB            12      JR  NC,PDS2
000504 0604 47               4      LD  B,A
                                
000505 0605 110000          10      LD  DE,0
       0608                     PDS3:
000508 0608 29              11      ADD HL,HL
000509 0609 EB               4      EX  DE,HL
00050A 060A ED6A            15      ADC HL,HL
00050C 060C EB               4      EX  DE,HL
00050D 060D 10F9            13      DJNZ    PDS3
       060F                     PDSKF1:
00050F 060F CDDF06          17      CALL    PRDEC_DEHL
000512 0612 11A110          10      LD  DE,FREE
000515 0615 0E09             7      LD  C,9     ;(BDOS)文字列出力
000517 0617 CD0500          17      CALL    SYSTEM
       061A                     PWD:
00051A 061A CDBF06          17      CALL    PUTDRV
00051D 061D 3E5C             7      LD  A,05CH      ;\
00051F 061F CDEA0A          17      CALL    MSG_A
       0622                     PDSKF2:             ;MSX-DOS2
000522 0622 110080          10      LD  DE,DATA
000525 0625 AF               4      XOR A
000526 0626 12               7      LD  (DE),A
000527 0627 3AAF13          13      LD  A,(FDRV)
00052A 062A 47               4      LD  B,A     ;ドライブ
00052B 062B 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
00052D 062D CD0500          17      CALL    SYSTEM
000530 0630 210080          10      LD  HL,DATA
                                
000533 0633 CD3B06          17      CALL    MSX
000536 0636 1841            12      JR  LTNL
                                
       0638                     MSX1:
000538 0638 CDEA0A          17      CALL    MSG_A
       063B                     MSX:
00053B 063B 7E               7      LD  A,(HL)
00053C 063C 23               6      INC HL
00053D 063D B7               4      OR  A
00053E 063E 20F8            12      JR  NZ,MSX1
000540 0640 C9              10      RET
                                
       0641                     MSXSLT1:
000541 0641 CDEA0A          17      CALL    MSG_A
       0644                     MSXSLT:
000544 0644 C5              11      PUSH    BC
000545 0645 E5              11      PUSH    HL
000546 0646 78               4      LD  A,B
000547 0647 CD0C00          17      CALL    RDSLT
00054A 064A E1              10      POP HL
00054B 064B C1              10      POP BC
00054C 064C 23               6      INC HL
00054D 064D B7               4      OR  A
00054E 064E 20F1            12      JR  NZ,MSXSLT1
000550 0650 C9              10      RET
                                
       0651                     P_NAME:
000551 0651 217813          10      LD  HL,DTA_CCP+1
000554 0654 7E               7      LD  A,(HL)
000555 0655 FE2E             7      CP  '.'
000557 0657 C8              11      RET Z
000558 0658 CD3507          17      CALL    FPRNT
00055B 065B 3A8313          13      LD  A,(DTA_CCP+12)
00055E 065E CB67             8      BIT 4,A
000560 0660 280A            12      JR  Z,DIR3
000562 0662 11AF10          10      LD  DE,DIRMES
000565 0665 0E09             7      LD  C,9     ;(BDOS)文字列出力
000567 0667 CD0500          17      CALL    SYSTEM
00056A 066A 180A            12      JR  DIR6
       066C                     DIR3:
00056C 066C ED5B9613        20      LD  DE,(DTA_CCP+1+01EH)
000570 0670 2A9413          16      LD  HL,(DTA_CCP+1+01CH)
000573 0673 CDDF06          17      CALL    PRDEC_DEHL
       0676                     DIR6:
000576 0676 CD5107          17      CALL    PRTTMS
                                
       0679                     LTNL:
000579 0679 1E0D             7      LD  E,00DH
00057B 067B CDCD0A          17      CALL    _PRINT
00057E 067E 1E0A             7      LD  E,00AH
000580 0680 C3CD0A          10      JP  _PRINT
                                
       0683                     C_PATH:
000583 0683 CDF90B          17      CALL    SPCUT
000586 0686 FE21             7      CP  021H
000588 0688 301C            12      JR  NC,CPATH0
                                
00058A 068A 215411          10      LD  HL,N_PATH
00058D 068D 115911          10      LD  DE,V_PATH
000590 0690 0640             7      LD  B,PATHX
000592 0692 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000594 0694 CD0500          17      CALL    SYSTEM
000597 0697 215911          10      LD  HL,V_PATH
       069A                     CPATHP:
00059A 069A 7E               7      LD  A,(HL)
00059B 069B 23               6      INC HL
00059C 069C FE20             7      CP  020H
00059E 069E 3F               4      CCF
00059F 069F 30D8            12      JR  NC,LTNL
0005A1 06A1 CDEA0A          17      CALL    MSG_A
0005A4 06A4 18F4            12      JR  CPATHP
       06A6                     CPATH0:
0005A6 06A6 215911          10      LD  HL,V_PATH
0005A9 06A9 FE3B             7      CP  ';'
0005AB 06AB 2001            12      JR  NZ,CPATH1
0005AD 06AD 13               6      INC DE
       06AE                     CPATH1:
0005AE 06AE EB               4      EX  DE,HL
0005AF 06AF 014000          10      LD  BC,PATHX
0005B2 06B2 EDB0                    LDIR
                                
0005B4 06B4 215411          10      LD  HL,N_PATH
0005B7 06B7 115911          10      LD  DE,V_PATH
0005BA 06BA 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0005BC 06BC C30500          10      JP  SYSTEM
                                
       06BF                     PUTDRV:
0005BF 06BF 3AAF13          13      LD  A,(FDRV)
0005C2 06C2 B7               4      OR  A
0005C3 06C3 200C            12      JR  NZ,PUTDRV1
0005C5 06C5 C5              11      PUSH    BC
0005C6 06C6 D5              11      PUSH    DE
0005C7 06C7 E5              11      PUSH    HL
0005C8 06C8 0E19             7      LD  C,019H
0005CA 06CA CD0500          17      CALL    SYSTEM
0005CD 06CD E1              10      POP HL
0005CE 06CE D1              10      POP DE
0005CF 06CF C1              10      POP BC
0005D0 06D0 3C               4      INC A
       06D1                     PUTDRV1:
0005D1 06D1 C640             7      ADD A,'A'-1
0005D3 06D3 CDEA0A          17      CALL    MSG_A
0005D6 06D6 3E3A             7      LD  A,':'
       06D8                     MSG_AR:
0005D8 06D8 C3EA0A          10      JP  MSG_A
                                
       06DB                     PRDEC_HL:
0005DB 06DB AF               4      XOR A
       06DC                     PRDEC_AHL:
0005DC 06DC 5F               4      LD  E,A
0005DD 06DD 1600             7      LD  D,0
       06DF                     PRDEC_DEHL:
0005DF 06DF 3E02             7      LD  A,2
0005E1 06E1 322A07          13      LD  (DEC6+1),A
0005E4 06E4 AF               4      XOR A
0005E5 06E5 E5              11      PUSH    HL
0005E6 06E6 21A913          10      LD  HL,DECBF
0005E9 06E9 0605             7      LD  B,5
0005EB 06EB CDC00B          17      CALL    FILL_MEMORY
0005EE 06EE E1              10      POP HL
                                
0005EF 06EF 0E20             7      LD  C,32
       06F1                     DEC1:
0005F1 06F1 29              11      ADD HL,HL
0005F2 06F2 EB               4      EX  DE,HL
0005F3 06F3 ED6A            15      ADC HL,HL
0005F5 06F5 EB               4      EX  DE,HL
0005F6 06F6 E5              11      PUSH    HL
0005F7 06F7 21AD13          10      LD  HL,DECBF+4
0005FA 06FA 0605             7      LD  B,5
       06FC                     DEC2:
0005FC 06FC 7E               7      LD  A,(HL)
0005FD 06FD 8F               4      ADC A,A
0005FE 06FE 27               4      DAA
0005FF 06FF 77               7      LD  (HL),A
000600 0700 2B               6      DEC HL
000601 0701 10F9            13      DJNZ    DEC2
000603 0703 E1              10      POP HL
000604 0704 0D               4      DEC C
000605 0705 20EA            12      JR  NZ,DEC1
                                
000607 0707 21A913          10      LD  HL,DECBF
00060A 070A 3E20             7      LD  A,020H
00060C 070C 0604             7      LD  B,4
       070E                     DEC3:
00060E 070E CD1B07          17      CALL    DEC4
000611 0711 CD1B07          17      CALL    DEC4
000614 0714 23               6      INC HL
000615 0715 10F7            13      DJNZ    DEC3
       0717                     DECX:
000617 0717 CD1B07          17      CALL    DEC4
00061A 071A AF               4      XOR A
       071B                     DEC4:
00061B 071B ED6F            18      RLD
00061D 071D FE20             7      CP  020H
00061F 071F 2808            12      JR  Z,DEC6
000621 0721 F630             7      OR  030H
       0723                     DEC5:
000623 0723 18B3            12      JR  MSG_AR
       0725                     DEC7:
000625 0725 3E20             7      LD  A,020H
000627 0727 18AF            12      JR  MSG_AR
       0729                     DEC6:
000629 0729 3E02             7      LD  A,2
00062B 072B B7               4      OR  A
00062C 072C 28F7            12      JR  Z,DEC7
00062E 072E 3D               4      DEC A
00062F 072F 322A07          13      LD  (DEC6+1),A
000632 0732 3E20             7      LD  A,020H
000634 0734 C9              10      RET
                                
       0735                     FPRNT:
000635 0735 0608             7      LD  B,8
000637 0737 CD4607          17      CALL    P_N1
00063A 073A 7E               7      LD  A,(HL)
00063B 073B FE20             7      CP  020H
00063D 073D 2802            12      JR  Z,FPR1
00063F 073F 3E2E             7      LD  A,'.'
       0741                     FPR1:
000641 0741 CDEA0A          17      CALL    MSG_A
000644 0744 0603             7      LD  B,3
                                
       0746                     P_N1:
000646 0746 7E               7      LD  A,(HL)
000647 0747 CD180C          17      CALL    CAP3
00064A 074A CDEA0A          17      CALL    MSG_A
00064D 074D 23               6      INC HL
00064E 074E 10F6            13      DJNZ    P_N1
000650 0750 C9              10      RET
                                
       0751                     PRTTMS:
000651 0751 3E20             7      LD  A,020H
000653 0753 CDEA0A          17      CALL    MSG_A
                                
000656 0756 2A9013          16      LD  HL,(DTA_CCP+1+24)
000659 0759 7D               4      LD  A,L
00065A 075A B7               4      OR  A
00065B 075B C8              11      RET Z
00065C 075C CB3C             8      SRL H
00065E 075E 17               4      RLA
00065F 075F 17               4      RLA
000660 0760 17               4      RLA
000661 0761 17               4      RLA
000662 0762 E60F             7      AND 00FH
000664 0764 57               4      LD  D,A
000665 0765 DD219E11        14      LD  IX,V_DATE
       0769                     PRTTMS1:
000669 0769 DD7E00          19      LD  A,(IX+0)
00066C 076C B7               4      OR  A
00066D 076D 2808            12      JR  Z,PRTTMS2
00066F 076F CDF207          17      CALL    PR_DATE
000672 0772 CD5D08          17      CALL    PR_DATE_SPLITER
000675 0775 18F2            12      JR  PRTTMS1
       0777                     PRTTMS2:
                                
000677 0777 CDF70C          17      CALL    GET_WIDTH
00067A 077A FE21             7      CP  32+1
00067C 077C 3005            12      JR  NC,SHOW_TIME
00067E 077E 3E1D             7      LD  A,01DH
000680 0780 C3EA0A          10      JP  MSG_A
       0783                     SHOW_TIME:
000683 0783 2A8E13          16      LD  HL,(DTA_CCP+1+22)
                                
000686 0786 3E20             7      LD  A,020H
000688 0788 CDEA0A          17      CALL    MSG_A
00068B 078B 7C               4      LD  A,H
00068C 078C 65               4      LD  H,L
00068D 078D 1F               4      RRA
00068E 078E CB1D             8      RR  L
000690 0790 1F               4      RRA
000691 0791 CB1D             8      RR  L
000693 0793 1F               4      RRA
000694 0794 CB1D             8      RR  L
000696 0796 E61F             7      AND 01FH
000698 0798 4F               4      LD  C,A
000699 0799 3AC311          13      LD  A,(V_TIME)
00069C 079C FE31             7      CP  '1'
00069E 079E 79               4      LD  A,C
00069F 079F 200B            12      JR  NZ,TIME24
0006A1 07A1 FE0C             7      CP  12
0006A3 07A3 3802            12      JR  C,TIME12
0006A5 07A5 D60C             7      SUB 12
       07A7                     TIME12:
0006A7 07A7 B7               4      OR  A
0006A8 07A8 2002            12      JR  NZ,TIME24
0006AA 07AA C60C             7      ADD A,12
       07AC                     TIME24:
0006AC 07AC C5              11      PUSH    BC
0006AD 07AD CDDD07          17      CALL    PRDEC_A
0006B0 07B0 3E3A             7      LD  A,':'
0006B2 07B2 CDEA0A          17      CALL    MSG_A
0006B5 07B5 7D               4      LD  A,L
0006B6 07B6 0F               4      RRCA
0006B7 07B7 0F               4      RRCA
0006B8 07B8 E63F             7      AND 03FH
0006BA 07BA CDDD07          17      CALL    PRDEC_A
                                
0006BD 07BD 3E3A             7      LD  A,':'
0006BF 07BF CDEA0A          17      CALL    MSG_A
0006C2 07C2 7C               4      LD  A,H
0006C3 07C3 E61F             7      AND 01FH
0006C5 07C5 87               4      ADD A,A
0006C6 07C6 CDDD07          17      CALL    PRDEC_A
                                
0006C9 07C9 3AC311          13      LD  A,(V_TIME)
0006CC 07CC FE31             7      CP  '1'
0006CE 07CE C1              10      POP BC
0006CF 07CF C0              11      RET NZ
0006D0 07D0 79               4      LD  A,C
0006D1 07D1 1E61             7      LD  E,'a'
0006D3 07D3 FE0C             7      CP  12
0006D5 07D5 DACD0A          10      JP  C,_PRINT
0006D8 07D8 1E70             7      LD  E,'p'
0006DA 07DA C3CD0A          10      JP  _PRINT
                                
                                ;   PRINT10
                                
       07DD                     PRDEC_A:
0006DD 07DD E5              11      PUSH    HL
0006DE 07DE 0608             7      LD  B,8
0006E0 07E0 4F               4      LD  C,A
0006E1 07E1 AF               4      XOR A
       07E2                     PRTA1:
0006E2 07E2 CB01             8      RLC C
0006E4 07E4 8F               4      ADC A,A
0006E5 07E5 27               4      DAA
0006E6 07E6 10FA            13      DJNZ    PRTA1
0006E8 07E8 21A913          10      LD  HL,DECBF
0006EB 07EB 77               7      LD  (HL),A
0006EC 07EC AF               4      XOR A
0006ED 07ED CD1707          17      CALL    DECX
0006F0 07F0 E1              10      POP HL
0006F1 07F1 C9              10      RET
                                
       07F2                     PR_DATE:
0006F2 07F2 DD7E00          19      LD  A,(IX+0)
0006F5 07F5 FE20             7      CP  020H
0006F7 07F7 D8              11      RET C
0006F8 07F8 CD0C0C          17      CALL    CAP
0006FB 07FB FE44             7      CP  'D'
0006FD 07FD 2848            12      JR  Z,PR_DAY
0006FF 07FF FE4D             7      CP  'M'
000701 0801 2820            12      JR  Z,PR_MONTH
000703 0803 FE59             7      CP  'Y'
000705 0805 2046            12      JR  NZ,PR_DATE1
000707 0807 4F               4      LD  C,A
000708 0808 DD7E02          19      LD  A,(IX+2)
00070B 080B CD0C0C          17      CALL    CAP
00070E 080E B9               4      CP  C
00070F 080F 200A            12      JR  NZ,YEAR2
000711 0811 7C               4      LD  A,H     ;YEAR
000712 0812 C6EC             7      ADD A,80+256-100
000714 0814 3E13             7      LD  A,19
000716 0816 CE00             7      ADC A,0
000718 0818 CDDD07          17      CALL    PRDEC_A     ;年4桁
       081B                     YEAR2:
00071B 081B 7C               4      LD  A,H     ;YEAR
00071C 081C C650             7      ADD A,80
00071E 081E CDDD07          17      CALL    PRDEC_A
000721 0821 182A            12      JR  PR_DATE1
       0823                     PR_MONTH:
000723 0823 4F               4      LD  C,A
000724 0824 DD7E02          19      LD  A,(IX+2)
000727 0827 CD0C0C          17      CALL    CAP
00072A 082A B9               4      CP  C
00072B 082B 2014            12      JR  NZ,MONTH2
00072D 082D E5              11      PUSH    HL      ;月を文字列で表示 Jan等
00072E 082E D5              11      PUSH    DE
00072F 082F 7A               4      LD  A,D
000730 0830 3D               4      DEC A
000731 0831 87               4      ADD A,A
000732 0832 87               4      ADD A,A
000733 0833 21DD10          10      LD  HL,S_MONTH
000736 0836 1600             7      LD  D,0
000738 0838 5F               4      LD  E,A
000739 0839 19              11      ADD HL,DE
00073A 083A CD3B06          17      CALL    MSX
00073D 083D D1              10      POP DE
00073E 083E E1              10      POP HL
00073F 083F 180C            12      JR  PR_DATE1
       0841                     MONTH2:
000741 0841 7A               4      LD  A,D     ;月を数字で表示
000742 0842 CDDD07          17      CALL    PRDEC_A
000745 0845 1806            12      JR  PR_DATE1
       0847                     PR_DAY:
000747 0847 7D               4      LD  A,L
000748 0848 E61F             7      AND 01FH
00074A 084A CDDD07          17      CALL    PRDEC_A
       084D                     PR_DATE1:
00074D 084D DD23            10      INC IX
00074F 084F DD7E00          19      LD  A,(IX+0)
000752 0852 CD0C0C          17      CALL    CAP
000755 0855 FE41             7      CP  'A'
000757 0857 D8              11      RET C
000758 0858 FE5B             7      CP  'Z'+1
00075A 085A 38F1            12      JR  C,PR_DATE1
00075C 085C C9              10      RET
       085D                     PR_DATE_SPLITER:
00075D 085D DD7E00          19      LD  A,(IX+0)
000760 0860 FE20             7      CP  020H
000762 0862 D8              11      RET C
000763 0863 DD23            10      INC IX
000765 0865 C3EA0A          10      JP  MSG_A
                                
       0868                     SETFCB:
000768 0868 CDF90B          17      CALL    SPCUT
00076B 086B 1A               7      LD  A,(DE)
00076C 086C FE20             7      CP  020H
00076E 086E 3801            12      JR  C,SETFCBA
000770 0870 1B               6      DEC DE
       0871                     SETFCBA:
000771 0871 D5              11      PUSH    DE
000772 0872 215C00          10      LD  HL,FCB1
000775 0875 115D00          10      LD  DE,FCB1+1
000778 0878 012300          10      LD  BC,00023H
00077B 087B 70               7      LD  (HL),B      ;B=0
00077C 087C EDB0                    LDIR
00077E 087E D1              10      POP DE
00077F 087F D5              11      PUSH    DE
000780 0880 215C00          10      LD  HL,FCB1
000783 0883 DD21A612        14      LD  IX,PATH_FN1
000787 0887 CD9D0C          17      CALL    _SYS29      ;ファイル名の解析
00078A 088A 216C00          10      LD  HL,FCB2
00078D 088D DD21E612        14      LD  IX,PATH_FN2
000791 0891 CD9D0C          17      CALL    _SYS29      ;ファイル名の解析
000794 0894 E1              10      POP HL
000795 0895 010050          10      LD  BC,05000H
000798 0898 118100          10      LD  DE,00081H
       089B                     SETFCB1:
00079B 089B 7E               7      LD  A,(HL)
00079C 089C 23               6      INC HL
00079D 089D FE20             7      CP  020H
00079F 089F 3805            12      JR  C,SETFCB2
0007A1 08A1 12               7      LD  (DE),A
0007A2 08A2 13               6      INC DE
0007A3 08A3 0C               4      INC C
0007A4 08A4 10F5            13      DJNZ    SETFCB1
       08A6                     SETFCB2:
0007A6 08A6 79               4      LD  A,C
0007A7 08A7 328000          13      LD  (DTA1),A
0007AA 08AA 04               4      INC B
0007AB 08AB AF               4      XOR A
       08AC                     SETFCB3:
0007AC 08AC 12               7      LD  (DE),A
0007AD 08AD 13               6      INC DE
0007AE 08AE 10FC            13      DJNZ    SETFCB3
0007B0 08B0 C9              10      RET
                                
       08B1                     C_COPY:
0007B1 08B1 CD6808          17      CALL    SETFCB
0007B4 08B4 3ADE11          13      LD  A,(MAJOR_VER)
0007B7 08B7 FE02             7      CP  2
0007B9 08B9 380D            12      JR  C,COPYI0
0007BB 08BB CD0A0D          17      CALL    IS_FOLDER_FN2
0007BE 08BE 3808            12      JR  C,COPYI0
0007C0 08C0 21B013          10      LD  HL,FDRV+1
0007C3 08C3 060B             7      LD  B,8+3
0007C5 08C5 CDBE0B          17      CALL    FILE10
       08C8                     COPYI0:
0007C8 08C8 3AAF13          13      LD  A,(FDRV)
0007CB 08CB 47               4      LD  B,A
0007CC 08CC B7               4      OR  A
0007CD 08CD 200B            12      JR  NZ,COPYI1
0007CF 08CF C5              11      PUSH    BC
0007D0 08D0 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0007D2 08D2 CD0500          17      CALL    SYSTEM
0007D5 08D5 3C               4      INC A
0007D6 08D6 32AF13          13      LD  (FDRV),A
0007D9 08D9 C1              10      POP BC
       08DA                     COPYI1:
0007DA 08DA C640             7      ADD A,040H
0007DC 08DC 322613          13      LD  (CUR_DRV),A
0007DF 08DF 112913          10      LD  DE,CUR_PATH
0007E2 08E2 0E59             7      LD  C,059H      ;(BDOS)カレントディレクトリの獲得(_GETCD)
0007E4 08E4 CD0500          17      CALL    SYSTEM
0007E7 08E7 CDF908          17      CALL    COPYSUB
       08EA                     RES_CUR_PATH:
0007EA 08EA 112613          10      LD  DE,CUR_DRV
       08ED                     SET_CUR_PATH:
0007ED 08ED F5              11      PUSH    AF
0007EE 08EE 3AAF13          13      LD  A,(FDRV)
0007F1 08F1 47               4      LD  B,A
0007F2 08F2 0E5A             7      LD  C,05AH      ;(BDOS)カレントディレクトリの変更(_CHDIR)
0007F4 08F4 CD0500          17      CALL    SYSTEM
0007F7 08F7 F1              10      POP AF
0007F8 08F8 C9              10      RET
       08F9                     COPYSUB:
0007F9 08F9 11D513          10      LD  DE,ZERO
0007FC 08FC CD2D0B          17      CALL    FILEC2
0007FF 08FF 216C00          10      LD  HL,FCB2
000802 0902 CDE10C          17      CALL    S29X1
                                
000805 0905 3E10             7      LD  A,010H
000807 0907 326900          13      LD  (FCB1+13),A
00080A 090A 216D00          10      LD  HL,FCB2+1
00080D 090D CDB20A          17      CALL    CWILD1
       0910                     COPY0:
000810 0910 CDAF0A          17      CALL    CWILD
000813 0913 215C00          10      LD  HL,FCB1
000816 0916 CDD102          17      CALL    OPEN_D2
000819 0919 37               4      SCF
       091A                     COPY1:
00081A 091A C0              11      RET NZ
00081B 091B CD5D03          17      CALL    DEFCB_D2
                                
00081E 091E 3A8313          13      LD  A,(DTA_CCP+12)
000821 0921 CB67             8      BIT 4,A
000823 0923 2821            12      JR  Z,COPY1A
                                
000825 0925 215D00          10      LD  HL,FCB1+1
000828 0928 CD450C          17      CALL    CHKWILD
00082B 092B 3811            12      JR  C,COPY9
                                
00082D 092D 3E20             7      LD  A,020H
00082F 092F 325D00          13      LD  (FCB1+1),A
000832 0932 2A9113          16      LD  HL,(DTA_CCP+26)
000835 0935 23               6      INC HL
000836 0936 226A00          16      LD  (FCB1+14),HL
000839 0939 18D5            12      JR  COPY0
                                
       093B                     COPY8:
00083B 093B CD000E          17      CALL    SHOW_OK
       093E                     COPY9:
00083E 093E CDEA08          17      CALL    RES_CUR_PATH
000841 0941 CD4703          17      CALL    OPEN2_D2
000844 0944 18D4            12      JR  COPY1
                                
       0946                     COPY1A:
000846 0946 216C00          10      LD  HL,FCB2
000849 0949 11AF13          10      LD  DE,FDRV
00084C 094C 017913          10      LD  BC,DTA_CCP+2
00084F 094F EDA0            16      LDI
000851 0951 3E0B             7      LD  A,11
       0953                     COPY2:
000853 0953 F5              11      PUSH    AF
000854 0954 7E               7      LD  A,(HL)
000855 0955 FE3F             7      CP  '?'
000857 0957 2001            12      JR  NZ,COPY3
000859 0959 0A               7      LD  A,(BC)
       095A                     COPY3:
00085A 095A 12               7      LD  (DE),A
00085B 095B 03               6      INC BC
00085C 095C 13               6      INC DE
00085D 095D 23               6      INC HL
00085E 095E F1              10      POP AF
00085F 095F 3D               4      DEC A
000860 0960 20F1            12      JR  NZ,COPY2
000862 0962 010500          10      LD  BC,16-11
000865 0965 EDB0                    LDIR
       0967                     PUTNAME:
000867 0967 215D00          10      LD  HL,FCB1+1
00086A 096A CD450C          17      CALL    CHKWILD
00086D 096D 300B            12      JR  NC,PUTN1
00086F 096F 21B013          10      LD  HL,FDRV+1
000872 0972 CD3507          17      CALL    FPRNT
000875 0975 3E20             7      LD  A,020H
000877 0977 CDEA0A          17      CALL    MSG_A
       097A                     PUTN1:
00087A 097A 11E612          10      LD  DE,PATH_FN2
00087D 097D CDED08          17      CALL    SET_CUR_PATH
                                
000880 0980 11AF13          10      LD  DE,FDRV
000883 0983 0E16             7      LD  C,016H      ;(BDOS)ファイルの作成
000885 0985 CDCA03          17      CALL    SYSTEM0
000888 0988 C2290A          10      JP  NZ,COPYE2
00088B 098B 67               4      LD  H,A     ;A=0
00088C 098C 6F               4      LD  L,A
00088D 098D 22D013          16      LD  (FDRV+33),HL    ;(FCB)ランダム・レコード
000890 0990 22D213          16      LD  (FDRV+35),HL
000893 0993 2C               4      INC L       ;HL=1
000894 0994 22BD13          16      LD  (FDRV+14),HL    ;(FCB)レコード・サイズ
       0997                     COPY6:
000897 0997 CDC10A          17      CALL    BUFSIZ
00089A 099A CDDD03          17      CALL    S27DTA_D2
00089D 099D 47               4      LD  B,A
00089E 099E 3C               4      INC A
00089F 099F CA180A          10      JP  Z,COPYE
0008A2 09A2 7C               4      LD  A,H
0008A3 09A3 B5               4      OR  L
0008A4 09A4 280F            12      JR  Z,COPY7
0008A6 09A6 11AF13          10      LD  DE,FDRV
0008A9 09A9 C5              11      PUSH    BC
0008AA 09AA 0E26             7      LD  C,026H      ;(BDOS)ランダム・ブロック・ライト
0008AC 09AC CD0500          17      CALL    SYSTEM
0008AF 09AF C1              10      POP BC
0008B0 09B0 B7               4      OR  A
0008B1 09B1 2065            12      JR  NZ,COPYE
0008B3 09B3 10E2            13      DJNZ    COPY6
       09B5                     COPY7:
0008B5 09B5 3ADE11          13      LD  A,(MAJOR_VER)
0008B8 09B8 FE02             7      CP  2
0008BA 09BA 3011            12      JR  NC,COPY7_MSX2   ;DOS2はFCBの仕様が違う
0008BC 09BC 3A8413          13      LD  A,(DTA_CCP+13)  ;(FCB)属性(アトリビュート)
0008BF 09BF 32BC13          13      LD  (FDRV+13),A ;(FCB)属性(アトリビュート)
0008C2 09C2 218B13          10      LD  HL,DTA_CCP+20
0008C5 09C5 11C313          10      LD  DE,FDRV+20  ;(FCB)更新日時
0008C8 09C8 010400          10      LD  BC,4
0008CB 09CB EDB0                    LDIR
       09CD                     COPY7_MSX2:
0008CD 09CD 11AF13          10      LD  DE,FDRV
0008D0 09D0 0E10             7      LD  C,010H      ;(BDOS)ファイルのクローズ
0008D2 09D2 CDCA03          17      CALL    SYSTEM0
                                
0008D5 09D5 2041            12      JR  NZ,COPYE
0008D7 09D7 3ADE11          13      LD  A,(MAJOR_VER)
0008DA 09DA FE02             7      CP  2
0008DC 09DC 3837            12      JR  C,COPY_DOS2DT
                                
0008DE 09DE ED4B1F12        20      LD  BC,(HANDLE1)
0008E2 09E2 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
0008E4 09E4 CD0500          17      CALL    SYSTEM
                                
0008E7 09E7 11E612          10      LD  DE,PATH_FN2
0008EA 09EA CDED08          17      CALL    SET_CUR_PATH
                                
0008ED 09ED 11AF13          10      LD  DE,FDRV
0008F0 09F0 216913          10      LD  HL,DOS2NAME
0008F3 09F3 CD2B0A          17      CALL    FCB2FNAME
                                
0008F6 09F6 3AED11          13      LD  A,(SEARCH_IX+14);   (FIB)属性
0008F9 09F9 6F               4      LD  L,A
0008FA 09FA 116913          10      LD  DE,DOS2NAME
0008FD 09FD 3E01             7      LD  A,1
0008FF 09FF 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000901 0A01 CDCA03          17      CALL    SYSTEM0
                                
000904 0A04 DD2AEE11        20      LD  IX,(SEARCH_IX+15)   ;(FIB)更新時間
000908 0A08 2AF011          16      LD  HL,(SEARCH_IX+17)   ;(FIB)更新日
00090B 0A0B 116913          10      LD  DE,DOS2NAME
00090E 0A0E 3E01             7      LD  A,1
000910 0A10 0E51             7      LD  C,51H       ;(BDOS)_FTIME ファイルの日付および時刻の獲得・設定
000912 0A12 CDCA03          17      CALL    SYSTEM0
       0A15                     COPY_DOS2DT:
000915 0A15 C33B09          10      JP  COPY8
                                
       0A18                     COPYE:
000918 0A18 ED4B1F12        20      LD  BC,(HANDLE1)
00091C 0A1C 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
00091E 0A1E CD0500          17      CALL    SYSTEM
000921 0A21 11AF13          10      LD  DE,FDRV
000924 0A24 0E13             7      LD  C,013H      ;(BDOS)ファイルの削除
000926 0A26 CD0500          17      CALL    SYSTEM
       0A29                     COPYE2:
000929 0A29 37               4      SCF
00092A 0A2A C9              10      RET
                                
       0A2B                     FCB2FNAME:
00092B 0A2B 1A               7      LD  A,(DE)
00092C 0A2C 13               6      INC DE
00092D 0A2D C640             7      ADD A,040H
00092F 0A2F 77               7      LD  (HL),A
000930 0A30 23               6      INC HL
000931 0A31 363A            10      LD  (HL),':'
000933 0A33 23               6      INC HL
                                
000934 0A34 0608             7      LD  B,8
       0A36                     FCB2FNAME1:
000936 0A36 1A               7      LD  A,(DE)
000937 0A37 FE21             7      CP  020H+1
000939 0A39 3807            12      JR  C,FCB2FNAME2
00093B 0A3B 13               6      INC DE
00093C 0A3C 77               7      LD  (HL),A
00093D 0A3D 23               6      INC HL
00093E 0A3E 10F6            13      DJNZ    FCB2FNAME1
000940 0A40 1803            12      JR  FCB2FNAME3
       0A42                     FCB2FNAME2:
000942 0A42 13               6      INC DE
000943 0A43 10FD            13      DJNZ    FCB2FNAME2
       0A45                     FCB2FNAME3:
000945 0A45 1A               7      LD  A,(DE)
000946 0A46 FE21             7      CP  020H+1
000948 0A48 380F            12      JR  C,FCB2FNAME5
00094A 0A4A 362E            10      LD  (HL),'.'
00094C 0A4C 23               6      INC HL
00094D 0A4D 0603             7      LD  B,3
       0A4F                     FCB2FNAME4:
00094F 0A4F 1A               7      LD  A,(DE)
000950 0A50 13               6      INC DE
000951 0A51 FE21             7      CP  020H+1
000953 0A53 3804            12      JR  C,FCB2FNAME5
000955 0A55 77               7      LD  (HL),A
000956 0A56 23               6      INC HL
000957 0A57 10F6            13      DJNZ    FCB2FNAME4
       0A59                     FCB2FNAME5:
000959 0A59 3600            10      LD  (HL),0
00095B 0A5B C9              10      RET
                                
       0A5C                     C_TYPE:
00095C 0A5C CD6808          17      CALL    SETFCB
00095F 0A5F 215C00          10      LD  HL,FCB1
000962 0A62 CDD102          17      CALL    OPEN_D2
000965 0A65 37               4      SCF
000966 0A66 C0              11      RET NZ
000967 0A67 CD6C0A          17      CALL    TYPE1
00096A 0A6A AF               4      XOR A
00096B 0A6B C9              10      RET
       0A6C                     TYPE1:
00096C 0A6C C0              11      RET NZ
00096D 0A6D CD5D03          17      CALL    DEFCB_D2
000970 0A70 3E1A             7      LD  A,01AH
000972 0A72 CDEA0A          17      CALL    MSG_A
       0A75                     TYPE2:
000975 0A75 CDC10A          17      CALL    BUFSIZ
000978 0A78 CDDD03          17      CALL    S27DTA_D2
00097B 0A7B C6FE             7      ADD A,0FEH
00097D 0A7D D8              11      RET C
00097E 0A7E 7C               4      LD  A,H
00097F 0A7F B5               4      OR  L
000980 0A80 281A            12      JR  Z,TYPEE
000982 0A82 010080          10      LD  BC,DATA
       0A85                     TYPE3:
000985 0A85 0A               7      LD  A,(BC)
000986 0A86 03               6      INC BC
000987 0A87 FE1A             7      CP  01AH
000989 0A89 2811            12      JR  Z,TYPEE
00098B 0A8B 5F               4      LD  E,A
00098C 0A8C C5              11      PUSH    BC
00098D 0A8D E5              11      PUSH    HL
00098E 0A8E 0E02             7      LD  C,2     ;(BDOS)コンソール出力
000990 0A90 CD0500          17      CALL    SYSTEM
000993 0A93 E1              10      POP HL
000994 0A94 C1              10      POP BC
000995 0A95 2B               6      DEC HL
000996 0A96 7C               4      LD  A,H
000997 0A97 B5               4      OR  L
000998 0A98 20EB            12      JR  NZ,TYPE3
00099A 0A9A 18D9            12      JR  TYPE2
       0A9C                     TYPEE:
00099C 0A9C 3ADE11          13      LD  A,(MAJOR_VER)   ;DOS2対応
00099F 0A9F FE02             7      CP  2
0009A1 0AA1 3806            12      JR  C,TYPEE2
0009A3 0AA3 ED4B1F12        20      LD  BC,(HANDLE1)
0009A7 0AA7 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
       0AA9                     TYPEE2:
0009A9 0AA9 CD4703          17      CALL    OPEN2_D2
0009AC 0AAC A7               4      AND A
0009AD 0AAD 18BD            12      JR  TYPE1
                                
       0AAF                     CWILD:
0009AF 0AAF 215D00          10      LD  HL,FCB1+1
       0AB2                     CWILD1:
0009B2 0AB2 7E               7      LD  A,(HL)
0009B3 0AB3 FE20             7      CP  020H
0009B5 0AB5 C0              11      RET NZ
       0AB6                     CWILD2:
0009B6 0AB6 54               4      LD  D,H
0009B7 0AB7 5D               4      LD  E,L
0009B8 0AB8 13               6      INC DE
0009B9 0AB9 010A00          10      LD  BC,10
0009BC 0ABC 363F            10      LD  (HL),'?'
0009BE 0ABE EDB0                    LDIR
0009C0 0AC0 C9              10      RET
                                
       0AC1                     BUFSIZ:
0009C1 0AC1 3A0700          13      LD  A,(SYSTEM+2)
0009C4 0AC4 D681             7      SUB (DATA/256)+1
0009C6 0AC6 E6F8             7      AND 0F8H
0009C8 0AC8 67               4      LD  H,A
0009C9 0AC9 2E00             7      LD  L,0
0009CB 0ACB C9              10      RET
                                
0009CC 0ACC E9               4  JP_HL:  JP  (HL)
                                
       0ACD                     _PRINT:
0009CD 0ACD C5              11      PUSH    BC
0009CE 0ACE D5              11      PUSH    DE
0009CF 0ACF E5              11      PUSH    HL
0009D0 0AD0 DDE5            15      PUSH    IX
0009D2 0AD2 0E06             7      LD  C,6
0009D4 0AD4 CD0500          17      CALL    SYSTEM
0009D7 0AD7 DDE1            14      POP IX
0009D9 0AD9 E1              10      POP HL
0009DA 0ADA D1              10      POP DE
0009DB 0ADB C1              10      POP BC
0009DC 0ADC B7               4      OR  A
0009DD 0ADD C9              10      RET
                                
       0ADE                     PRTHX:
0009DE 0ADE F5              11      PUSH    AF
0009DF 0ADF 07               4      RLCA
0009E0 0AE0 07               4      RLCA
0009E1 0AE1 07               4      RLCA
0009E2 0AE2 07               4      RLCA
0009E3 0AE3 CDE70A          17      CALL    PRTHX1
0009E6 0AE6 F1              10      POP AF
       0AE7                     PRTHX1:
0009E7 0AE7 CDFD0A          17      CALL    ASC
       0AEA                     MSG_A:
0009EA 0AEA F5              11      PUSH    AF
0009EB 0AEB C5              11      PUSH    BC
0009EC 0AEC D5              11      PUSH    DE
0009ED 0AED E5              11      PUSH    HL
0009EE 0AEE DDE5            15      PUSH    IX
0009F0 0AF0 5F               4      LD  E,A
0009F1 0AF1 0E02             7      LD  C,2
0009F3 0AF3 CD0500          17      CALL    SYSTEM
0009F6 0AF6 DDE1            14      POP IX
0009F8 0AF8 E1              10      POP HL
0009F9 0AF9 D1              10      POP DE
0009FA 0AFA C1              10      POP BC
0009FB 0AFB F1              10      POP AF
0009FC 0AFC C9              10      RET
                                
       0AFD                     ASC:
0009FD 0AFD E60F             7      AND 00FH
0009FF 0AFF F630             7      OR  '0'
000A01 0B01 FE39             7      CP  '9'
000A03 0B03 D8              11      RET C
000A04 0B04 C607             7      ADD A,7
000A06 0B06 C9              10      RET
                                ;       FILE
       0B07                     FILEC_D2:       ;DOS2対応
000A07 0B07 3ADE11          13      LD  A,(MAJOR_VER)
000A0A 0B0A FE02             7      CP  2
000A0C 0B0C 381C            12      JR  C,FILEC
000A0E 0B0E C5              11      PUSH    BC
000A0F 0B0F D5              11      PUSH    DE
000A10 0B10 E5              11      PUSH    HL
000A11 0B11 CDF90B          17      CALL    SPCUT
000A14 0B14 212612          10      LD  HL,PATH_CCP
000A17 0B17 0640             7      LD  B,64
       0B19                     PATHCD1:
000A19 0B19 1A               7      LD  A,(DE)
000A1A 0B1A 13               6      INC DE
000A1B 0B1B FE20             7      CP  020H
000A1D 0B1D 3002            12      JR  NC,PATHCD2
000A1F 0B1F 3E00             7      LD  A,0
       0B21                     PATHCD2:
000A21 0B21 77               7      LD  (HL),A
000A22 0B22 3803            12      JR  C,PATHCD3
000A24 0B24 23               6      INC HL
000A25 0B25 10F2            13      DJNZ    PATHCD1
       0B27                     PATHCD3:
000A27 0B27 E1              10      POP HL
000A28 0B28 D1              10      POP DE
000A29 0B29 C1              10      POP BC
       0B2A                     FILEC:
000A2A 0B2A CD350B          17      CALL    FILE
       0B2D                     FILEC2:
000A2D 0B2D 3AB013          13      LD  A,(FDRV+1)
000A30 0B30 FE20             7      CP  020H
000A32 0B32 C8              11      RET Z
000A33 0B33 1840            12      JR  SETDIR1
                                
       0B35                     FILE:
000A35 0B35 3ADE11          13      LD  A,(MAJOR_VER)   ;Tablacus Disk ROM Lite
000A38 0B38 FE01             7      CP  1
000A3A 0B3A 283A            12      JR  Z,FILE_TDRL
       0B3C                     FILEX:
000A3C 0B3C AF               4      XOR A
000A3D 0B3D 32AF13          13      LD  (FDRV),A
000A40 0B40 67               4      LD  H,A
000A41 0B41 6F               4      LD  L,A
000A42 0B42 22BD13          16      LD  (FDRV+14),HL
000A45 0B45 CDF90B          17      CALL    SPCUT
000A48 0B48 CDDE0B          17      CALL    CCHK3
000A4B 0B4B 2812            12      JR  Z,DEVI1
000A4D 0B4D 13               6      INC DE
000A4E 0B4E 1A               7      LD  A,(DE)
000A4F 0B4F 1B               6      DEC DE
000A50 0B50 FE3A             7      CP  ':'
000A52 0B52 200B            12      JR  NZ,DEVI1
000A54 0B54 1A               7      LD  A,(DE)      ;DRIVE
000A55 0B55 CD0C0C          17      CALL    CAP
000A58 0B58 D640             7      SUB '@'
000A5A 0B5A 13               6      INC DE
000A5B 0B5B 13               6      INC DE
000A5C 0B5C 32AF13          13      LD  (FDRV),A
       0B5F                     DEVI1:
000A5F 0B5F 1A               7      LD  A,(DE)
000A60 0B60 D65C             7      SUB 05CH        ;\
000A62 0B62 2009            12      JR  NZ,NOROOT
000A64 0B64 6F               4      LD  L,A     ;A=0でH=0のはずなのでHL=0
000A65 0B65 22C913          16      LD  (FDRV+26),HL
000A68 0B68 2C               4      INC L
000A69 0B69 22BD13          16      LD  (FDRV+14),HL
000A6C 0B6C 13               6      INC DE
       0B6D                     NOROOT:
                                
       0B6D                     SETDIR:
000A6D 0B6D CD7E0B          17      CALL    FILED
000A70 0B70 1A               7      LD  A,(DE)
000A71 0B71 FE5C             7      CP  05CH        ;\
000A73 0B73 C0              11      RET NZ
000A74 0B74 13               6      INC DE
       0B75                     SETDIR1:
000A75 0B75 C9              10      RET
                                
       0B76                     FILE_TDRL:
000A76 0B76 21AF13          10      LD  HL,FDRV
000A79 0B79 0E29             7      LD  C,029H      ;(BDOS) パス名の解析
000A7B 0B7B C30500          10      JP  SYSTEM
                                
       0B7E                     FILED:
000A7E 0B7E CDC50B          17      CALL    FILEI
                                
000A81 0B81 0608             7      LD  B,8
       0B83                     FILE2:
000A83 0B83 CDD30B          17      CALL    CCHKF
000A86 0B86 C8              11      RET Z
000A87 0B87 FE2A             7      CP  '*'
000A89 0B89 282E            12      JR  Z,FILE9
000A8B 0B8B FE2E             7      CP  '.'
000A8D 0B8D 280C            12      JR  Z,FILE4
000A8F 0B8F 77               7      LD  (HL),A
000A90 0B90 23               6      INC HL
000A91 0B91 10F0            13      DJNZ    FILE2
                                
       0B93                     FILE3:
000A93 0B93 CDD30B          17      CALL    CCHKF
000A96 0B96 C8              11      RET Z
000A97 0B97 FE2E             7      CP  '.'
000A99 0B99 20F8            12      JR  NZ,FILE3
                                
       0B9B                     FILE4:
000A9B 0B9B 21B813          10      LD  HL,FNAME+8
000A9E 0B9E 0603             7      LD  B,3
                                
       0BA0                     FILE4L:
000AA0 0BA0 CDD30B          17      CALL    CCHKF
000AA3 0BA3 C8              11      RET Z
000AA4 0BA4 FE2E             7      CP  '.'
000AA6 0BA6 2008            12      JR  NZ,FILE12
000AA8 0BA8 32B013          13      LD  (FNAME),A   ;Parent directory(..)
000AAB 0BAB 32B113          13      LD  (FNAME+1),A
000AAE 0BAE 3E20             7      LD  A,020H
       0BB0                     FILE12:
000AB0 0BB0 FE2A             7      CP  '*'
000AB2 0BB2 280A            12      JR  Z,FILE10
000AB4 0BB4 77               7      LD  (HL),A
000AB5 0BB5 23               6      INC HL
000AB6 0BB6 10E8            13      DJNZ    FILE4L
000AB8 0BB8 C9              10      RET
                                
       0BB9                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000AB9 0BB9 CDBE0B          17      CALL    FILE10
000ABC 0BBC 18D5            12      JR  FILE3
                                
       0BBE                     FILE10:
000ABE 0BBE 3E3F             7      LD  A,'?'
                                
       0BC0                     FILL_MEMORY:                ;HLからBバイトAで埋める
000AC0 0BC0 77               7      LD  (HL),A
000AC1 0BC1 23               6      INC HL
000AC2 0BC2 10FC            13      DJNZ    FILL_MEMORY
000AC4 0BC4 C9              10      RET
                                
       0BC5                     FILEI:              ;名前＋拡張子をスペースで初期化
000AC5 0BC5 3E20             7      LD  A,020H
000AC7 0BC7 01000B          10      LD  BC,11*256
000ACA 0BCA 21B013          10      LD  HL,FNAME
000ACD 0BCD E5              11      PUSH    HL
000ACE 0BCE CDC00B          17      CALL    FILL_MEMORY
000AD1 0BD1 E1              10      POP HL
000AD2 0BD2 C9              10      RET
                                
       0BD3                     CCHKF:
000AD3 0BD3 1A               7      LD  A,(DE)
000AD4 0BD4 CDDB0B          17      CALL    CCHK2
000AD7 0BD7 C8              11      RET Z
000AD8 0BD8 C32E0C          10      JP  FKAN
                                
       0BDB                     CCHK2:
000ADB 0BDB 0C               4      INC C
000ADC 0BDC 0D               4      DEC C
000ADD 0BDD C0              11      RET NZ
       0BDE                     CCHK3:              ;ZF=1 で使えない文字
000ADE 0BDE FE2B             7      CP  '+'
000AE0 0BE0 C8              11      RET Z
000AE1 0BE1 FE2C             7      CP  ','
000AE3 0BE3 C8              11      RET Z
000AE4 0BE4 FE2F             7      CP  '/'
000AE6 0BE6 C8              11      RET Z
000AE7 0BE7 FE3A             7      CP  ':'
000AE9 0BE9 C8              11      RET Z
000AEA 0BEA FE3B             7      CP  ';'
000AEC 0BEC C8              11      RET Z
000AED 0BED FE3D             7      CP  '='
000AEF 0BEF C8              11      RET Z
000AF0 0BF0 FE5C             7      CP  05CH    ;\
000AF2 0BF2 C8              11      RET Z
000AF3 0BF3 FE20             7      CP  020H
000AF5 0BF5 D0              11      RET NC
000AF6 0BF6 BF               4      CP  A       ;Z=1
000AF7 0BF7 C9              10      RET
                                
       0BF8                     SS1:
000AF8 0BF8 13               6      INC DE
       0BF9                     SPCUT:              ;スペースをカット
000AF9 0BF9 1A               7      LD  A,(DE)
000AFA 0BFA FE20             7      CP  020H
000AFC 0BFC 28FA            12      JR  Z,SS1
000AFE 0BFE C9              10      RET
                                
       0BFF                     TOZERO:
000AFF 0BFF D5              11      PUSH    DE
       0C00                     TZ1:
000B00 0C00 1A               7      LD  A,(DE)
000B01 0C01 FE20             7      CP  20H
000B03 0C03 3803            12      JR  C,TZ2
000B05 0C05 13               6      INC DE
000B06 0C06 18F8            12      JR  TZ1
       0C08                     TZ2:
000B08 0C08 AF               4      XOR A
000B09 0C09 12               7      LD  (DE),A
000B0A 0C0A D1              10      POP DE
000B0B 0C0B C9              10      RET
                                
       0C0C                     CAP:
000B0C 0C0C FE61             7      CP  'a'
000B0E 0C0E D8              11      RET C
000B0F 0C0F FE7B             7      CP  'z'+1
000B11 0C11 D0              11      RET NC
000B12 0C12 D620             7      SUB 020H
000B14 0C14 C9              10      RET
       0C15                     CAP2:
000B15 0C15 CD0C0C          17      CALL    CAP
       0C18                     CAP3:
000B18 0C18 CD210C          17      CALL    CAP4
000B1B 0C1B FE21             7      CP  021H
000B1D 0C1D D0              11      RET NC
000B1E 0C1E 3E20             7      LD  A,020H
000B20 0C20 C9              10      RET
       0C21                     CAP4:
000B21 0C21 FE05             7      CP  5
000B23 0C23 C0              11      RET NZ
000B24 0C24 3EE5             7      LD  A,0E5H
000B26 0C26 C9              10      RET
                                
       0C27                     FKANC:
000B27 0C27 CB41             8      BIT 0,C
000B29 0C29 CC150C          17      CALL    Z,CAP2
000B2C 0C2C 1801            12      JR  FKANX
       0C2E                     FKAN:           ;漢字チェック
000B2E 0C2E 13               6      INC DE
       0C2F                     FKANX:
000B2F 0C2F CB41             8      BIT 0,C
000B31 0C31 CB81             8      RES 0,C
000B33 0C33 C0              11      RET NZ
000B34 0C34 FE80             7      CP  080H
000B36 0C36 D8              11      RET C
000B37 0C37 FEA0             7      CP  0A0H
000B39 0C39 3803            12      JR  C,FKAN1
000B3B 0C3B FEE0             7      CP  0E0H
000B3D 0C3D D8              11      RET C
       0C3E                     FKAN1:
000B3E 0C3E 0C               4      INC C
000B3F 0C3F A7               4      AND A
000B40 0C40 C9              10      RET
                                
       0C41                     CHKWILDX:
000B41 0C41 FDE5            15      PUSH    IY
000B43 0C43 E1              10      POP HL
000B44 0C44 23               6      INC HL
       0C45                     CHKWILD:
000B45 0C45 060B             7      LD  B,11
000B47 0C47 3E3F             7      LD  A,'?'
       0C49                     CHKWIL1:
000B49 0C49 BE               7      CP  (HL)
000B4A 0C4A 23               6      INC HL
000B4B 0C4B 37               4      SCF
000B4C 0C4C C8              11      RET Z
000B4D 0C4D 10FA            13      DJNZ    CHKWIL1
000B4F 0C4F AF               4      XOR A
000B50 0C50 C9              10      RET
                                
       0C51                     CPNAME:
000B51 0C51 C5              11      PUSH    BC
000B52 0C52 D5              11      PUSH    DE
000B53 0C53 119E13          10      LD  DE,CPBUF
000B56 0C56 010700          10      LD  BC,7
000B59 0C59 EDB0                    LDIR
000B5B 0C5B D1              10      POP DE
000B5C 0C5C D5              11      PUSH    DE
000B5D 0C5D E5              11      PUSH    HL
000B5E 0C5E 219E13          10      LD  HL,CPBUF
000B61 0C61 CD740C          17      CALL    CPFILE
000B64 0C64 E1              10      POP HL
000B65 0C65 D1              10      POP DE
000B66 0C66 C1              10      POP BC
000B67 0C67 2005            12      JR  NZ,CPNAME1
000B69 0C69 7E               7      LD  A,(HL)
000B6A 0C6A 23               6      INC HL
000B6B 0C6B 66               7      LD  H,(HL)
000B6C 0C6C 6F               4      LD  L,A
000B6D 0C6D C9              10      RET
       0C6E                     CPNAME1:
000B6E 0C6E 23               6      INC HL
000B6F 0C6F 23               6      INC HL
000B70 0C70 10DF            13      DJNZ    CPNAME
000B72 0C72 37               4      SCF
000B73 0C73 C9              10      RET
                                
       0C74                     CPFILE:
000B74 0C74 C5              11      PUSH    BC
000B75 0C75 01000B          10      LD  BC,00B00H
       0C78                     CPSTR1:
000B78 0C78 1A               7      LD  A,(DE)
000B79 0C79 FE3F             7      CP  '?'     ;Wild card
000B7B 0C7B 2812            12      JR  Z,CPSTR2
000B7D 0C7D 7E               7      LD  A,(HL)
000B7E 0C7E CD270C          17      CALL    FKANC
000B81 0C81 E5              11      PUSH    HL
000B82 0C82 67               4      LD  H,A
000B83 0C83 1A               7      LD  A,(DE)
000B84 0C84 CB01             8      RLC C
000B86 0C86 CD270C          17      CALL    FKANC
000B89 0C89 CB09             8      RRC C
000B8B 0C8B BC               4      CP  H       ;CP (HL),(DE)
000B8C 0C8C E1              10      POP HL
000B8D 0C8D 2004            12      JR  NZ,CPSTR3
       0C8F                     CPSTR2:
000B8F 0C8F 13               6      INC DE
000B90 0C90 23               6      INC HL
000B91 0C91 10E5            13      DJNZ    CPSTR1
       0C93                     CPSTR3:
000B93 0C93 C1              10      POP BC
000B94 0C94 C9              10      RET
                                
       0C95                     CPFILE2:
000B95 0C95 FD7E0D          19      LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
000B98 0C98 F6E1             7      OR  0E1H
000B9A 0C9A 2F               4      CPL
000B9B 0C9B A6               7      AND (HL)
000B9C 0C9C C9              10      RET
                                
       0C9D                     _SYS29:     ;(BDOS)ファイル名の解析
000B9D 0C9D C5              11      PUSH    BC
000B9E 0C9E D5              11      PUSH    DE
000B9F 0C9F 0640             7      LD  B,64
000BA1 0CA1 CDF90B          17      CALL    SPCUT
000BA4 0CA4 DD229C13        20      LD  (DIR_CK),IX
       0CA8                     D2FN1:
000BA8 0CA8 1A               7      LD  A,(DE)
000BA9 0CA9 FE21             7      CP  020H+1
000BAB 0CAB 3808            12      JR  C,D2FN2
000BAD 0CAD 13               6      INC DE
000BAE 0CAE DD7700          19      LD  (IX+0),A
000BB1 0CB1 DD23            10      INC IX
000BB3 0CB3 10F3            13      DJNZ    D2FN1
       0CB5                     D2FN2:
000BB5 0CB5 DD360000        19      LD  (IX+0),0
000BB9 0CB9 DD7EFF          19      LD  A,(IX-1)
000BBC 0CBC FE5C             7      CP  05CH        ;\
000BBE 0CBE 2018            12      JR  NZ,D2FN3
000BC0 0CC0 DD7EFE          19      LD  A,(IX-2)
000BC3 0CC3 FE3A             7      CP  ':'
000BC5 0CC5 2811            12      JR  Z,D2FN3
                                
000BC7 0CC7 DD36FF00        19      LD  (IX-1),0
000BCB 0CCB ED5B9C13        20      LD  DE,(DIR_CK)
000BCF 0CCF CD500D          17      CALL    IS_FOLDER
000BD2 0CD2 3804            12      JR  C,D2FN3
       0CD4                     D2FN4:
000BD4 0CD4 DD36FF5C        19      LD  (IX-1),05CH ;\
       0CD8                     D2FN3:
000BD8 0CD8 D1              10      POP DE
000BD9 0CD9 C1              10      POP BC
000BDA 0CDA C5              11      PUSH    BC
000BDB 0CDB E5              11      PUSH    HL
000BDC 0CDC CD350B          17      CALL    FILE
000BDF 0CDF E1              10      POP HL
000BE0 0CE0 C1              10      POP BC
       0CE1                     S29X1:
000BE1 0CE1 C5              11      PUSH    BC
000BE2 0CE2 D5              11      PUSH    DE
000BE3 0CE3 E5              11      PUSH    HL
000BE4 0CE4 EB               4      EX  DE,HL
000BE5 0CE5 21AF13          10      LD  HL,FDRV
000BE8 0CE8 010D00          10      LD  BC,13
000BEB 0CEB EDB0                    LDIR
000BED 0CED 70               7      LD  (HL),B      ;B=0
000BEE 0CEE 0E03             7      LD  C,3
000BF0 0CF0 EDB0                    LDIR
000BF2 0CF2 E1              10      POP HL
000BF3 0CF3 D1              10      POP DE
000BF4 0CF4 C1              10      POP BC
000BF5 0CF5 AF               4      XOR A
000BF6 0CF6 C9              10      RET
       0CF7                     GET_WIDTH:
000BF7 0CF7 3ADD11          13      LD  A,(IS_MSX)
000BFA 0CFA B7               4      OR  A
000BFB 0CFB 2804            12      JR  Z,NOT_MSX
000BFD 0CFD 3AB0F3          13      LD  A,(LINLEN)
000C00 0D00 C9              10      RET
       0D01                     NOT_MSX:
000C01 0D01 E5              11      PUSH    HL
000C02 0D02 2A0100          16      LD  HL,(1)
000C05 0D05 2EB1             7      LD  L,0B1H
000C07 0D07 7E               7      LD  A,(HL)
000C08 0D08 E1              10      POP HL
000C09 0D09 C9              10      RET
                                
       0D0A                     IS_FOLDER_FN2:
000C0A 0D0A 11E612          10      LD  DE,PATH_FN2
000C0D 0D0D CD670D          17      CALL    IS_FOLDER2
000C10 0D10 D8              11      RET C
                                
000C11 0D11 110000          10      LD  DE,0
000C14 0D14 ED53DA13        20      LD  (PATH_FN2_SL),DE
000C18 0D18 11E612          10      LD  DE,PATH_FN2
       0D1B                     IF2_1:
000C1B 0D1B 1A               7      LD  A,(DE)
000C1C 0D1C 13               6      INC DE
000C1D 0D1D FE5C             7      CP  '\\'
000C1F 0D1F 2004            12      JR  NZ,IF2_2
000C21 0D21 ED53DA13        20      LD  (PATH_FN2_SL),DE
       0D25                     IF2_2:
000C25 0D25 B7               4      OR  A
000C26 0D26 20F3            12      JR  NZ,IF2_1
000C28 0D28 ED5BDA13        20      LD  DE,(PATH_FN2_SL)
000C2C 0D2C 7A               4      LD  A,D
000C2D 0D2D B3               4      OR  E
000C2E 0D2E 280F            12      JR  Z,IS_FOLDER_FN2_E
000C30 0D30 AF               4      XOR A
000C31 0D31 1B               6      DEC DE
000C32 0D32 12               7      LD  (DE),A
                                
000C33 0D33 11E612          10      LD  DE,PATH_FN2
000C36 0D36 CD500D          17      CALL    IS_FOLDER
000C39 0D39 3009            12      JR  NC,IS2_3
000C3B 0D3B 3E5C             7      LD  A,'\\'
000C3D 0D3D 1B               6      DEC DE
000C3E 0D3E 12               7      LD  (DE),A
       0D3F                     IS_FOLDER_FN2_E:
000C3F 0D3F 11E612          10      LD  DE,PATH_FN2
000C42 0D42 37               4      SCF
000C43 0D43 C9              10      RET
       0D44                     IS2_3:
000C44 0D44 ED5BDA13        20      LD  DE,(PATH_FN2_SL)
000C48 0D48 216C00          10      LD  HL,FCB2
000C4B 0D4B CD9D0C          17      CALL    _SYS29
000C4E 0D4E 37               4      SCF
000C4F 0D4F C9              10      RET
                                
       0D50                     IS_FOLDER:          ;out CF=0:Folder
000C50 0D50 CDF90B          17      CALL    SPCUT
000C53 0D53 1A               7      LD  A,(DE)
000C54 0D54 C6FF             7      ADD A,0FFH
000C56 0D56 D0              11      RET NC
000C57 0D57 AF               4      XOR A
000C58 0D58 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C5A 0D5A D5              11      PUSH    DE
000C5B 0D5B CDCA03          17      CALL    SYSTEM0
000C5E 0D5E D1              10      POP DE
000C5F 0D5F 37               4      SCF
000C60 0D60 C0              11      RET NZ
000C61 0D61 7D               4      LD  A,L
000C62 0D62 E610             7      AND 010H
000C64 0D64 D601             7      SUB 1
000C66 0D66 C9              10      RET
                                
       0D67                     IS_FOLDER2:         ;out CF=0:Folder
000C67 0D67 CDF90B          17      CALL    SPCUT
000C6A 0D6A 1A               7      LD  A,(DE)
000C6B 0D6B C6FF             7      ADD A,0FFH
000C6D 0D6D D0              11      RET NC
000C6E 0D6E AF               4      XOR A
000C6F 0D6F 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C71 0D71 D5              11      PUSH    DE
000C72 0D72 CDCA03          17      CALL    SYSTEM0
000C75 0D75 D1              10      POP DE
000C76 0D76 C0              11      RET NZ
000C77 0D77 7D               4      LD  A,L
000C78 0D78 E610             7      AND 010H
000C7A 0D7A D601             7      SUB 1
000C7C 0D7C C9              10      RET
                                
       0D7D                     C_MODE:
000C7D 0D7D 3ADD11          13      LD  A,(IS_MSX)
000C80 0D80 B7               4      OR  A
000C81 0D81 C8              11      RET Z
000C82 0D82 0E29             7      LD  C,41
000C84 0D84 3AF8FA          13      LD  A,(EXBRSA)
000C87 0D87 B7               4      OR  A
000C88 0D88 2802            12      JR  Z,MODE_MSX1
000C8A 0D8A 0E51             7      LD  C,81
       0D8C                     MODE_MSX1:
000C8C 0D8C C5              11      PUSH    BC
000C8D 0D8D CDE50F          17      CALL    GETNUM
000C90 0D90 C1              10      POP BC
000C91 0D91 7D               4      LD  A,L
000C92 0D92 B9               4      CP  C
000C93 0D93 301C            12      JR  NC,MODE1
000C95 0D95 B7               4      OR  A
000C96 0D96 2819            12      JR  Z,MODE1
000C98 0D98 FE21             7      CP  33
000C9A 0D9A 381E            12      JR  C,MODE32
000C9C 0D9C 32AEF3          13      LD  (LINL40),A
000C9F 0D9F DD216C00        14      LD  IX,INITXT
000CA3 0DA3 CDAA0D          17      CALL    CALLROM
000CA6 0DA6 DD217800        14      LD  IX,SETTXT
       0DAA                     CALLROM:
000CAA 0DAA FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000CAE 0DAE C31C00          10      JP  CALSLT
       0DB1                     MODE1:
000CB1 0DB1 3AB0F3          13      LD  A,(LINLEN)
000CB4 0DB4 CDDD07          17      CALL    PRDEC_A
000CB7 0DB7 C37906          10      JP  LTNL
       0DBA                     MODE32:
000CBA 0DBA 32AFF3          13      LD  (LINL32),A
000CBD 0DBD DD216F00        14      LD  IX,INIT32
000CC1 0DC1 CDAA0D          17      CALL    CALLROM
000CC4 0DC4 DD217B00        14      LD  IX,SETT32
000CC8 0DC8 18E0            12      JR  CALLROM
                                
       0DCA                     C_PAUSE:
000CCA 0DCA CDF90B          17      CALL    SPCUT
000CCD 0DCD EB               4      EX  DE,HL
000CCE 0DCE 7E               7      LD  A,(HL)
000CCF 0DCF B7               4      OR  A
000CD0 0DD0 2003            12      JR  NZ,C_PAUSE1
000CD2 0DD2 21C210          10      LD  HL,PAUSE
       0DD5                     C_PAUSE1:
000CD5 0DD5 CD3B06          17      CALL    MSX
000CD8 0DD8 0E07             7      LD  C,7     ;(BDOS)コンソール直接入力(_DIRIN)
000CDA 0DDA CD0500          17      CALL    SYSTEM
000CDD 0DDD FE03             7      CP  3
000CDF 0DDF CA5005          10      JP  Z,END_BATCH
000CE2 0DE2 C37906          10      JP  LTNL
                                
       0DE5                     C_ECHO:
000CE5 0DE5 CDF90B          17      CALL    SPCUT
000CE8 0DE8 EB               4      EX  DE,HL
000CE9 0DE9 CD3B06          17      CALL    MSX
000CEC 0DEC C37906          10      JP  LTNL
                                
       0DEF                     C_MKDIR:
000CEF 0DEF CDF90B          17      CALL    SPCUT
000CF2 0DF2 014490          10      LD  BC,09044H   ;B=新規作成+ディレクトリ/C=(BDOS)ファイルハンドルの作成(_CREATE)
000CF5 0DF5 CD0500          17      CALL    SYSTEM
000CF8 0DF8 C6FF             7      ADD A,0FFH
000CFA 0DFA D8              11      RET C
000CFB 0DFB 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
000CFD 0DFD CD0500          17      CALL    SYSTEM
       0E00                     SHOW_OK:
000D00 0E00 11B810          10      LD  DE,OK
000D03 0E03 0E09             7      LD  C,9     ;(BDOS)文字列出力
000D05 0E05 CD0500          17      CALL    SYSTEM
000D08 0E08 C37906          10      JP  LTNL
                                
       0E0B                     C_RMDIR:
000D0B 0E0B CD500D          17      CALL    IS_FOLDER
000D0E 0E0E D8              11      RET C
000D0F 0E0F 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除
000D11 0E11 CD0500          17      CALL    SYSTEM
000D14 0E14 C6FF             7      ADD A,0FFH
000D16 0E16 D8              11      RET C
000D17 0E17 18E7            12      JR  SHOW_OK
                                
       0E19                     C_SET:
000D19 0E19 CDF90B          17      CALL    SPCUT
000D1C 0E1C ED532F0E        20      LD  (CSET_PARAM),DE
       0E20                     CSET2:
000D20 0E20 1A               7      LD  A,(DE)
000D21 0E21 FE20             7      CP  020H
000D23 0E23 3838            12      JR  C,CSET_LIST
000D25 0E25 D63D             7      SUB '='
000D27 0E27 2803            12      JR  Z,CSET_SET
000D29 0E29 13               6      INC DE
000D2A 0E2A 18F4            12      JR  CSET2
       0E2C                     CSET_SET:
000D2C 0E2C 12               7      LD  (DE),A
000D2D 0E2D 13               6      INC DE
       0E2F                     CSET_PARAM  EQU $+1
000D2E 0E2E 210000          10      LD  HL,0
000D31 0E31 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000D33 0E33 CD0500          17      CALL    SYSTEM
       0E36                     INIT_VAR:           ;環境変数の初期化
000D36 0E36 219911          10      LD  HL,N_DATE
000D39 0E39 119E11          10      LD  DE,V_DATE
000D3C 0E3C 0610             7      LD  B,16
000D3E 0E3E 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D40 0E40 CD0500          17      CALL    SYSTEM
                                
000D43 0E43 21BE11          10      LD  HL,N_TIME
000D46 0E46 11C311          10      LD  DE,V_TIME
000D49 0E49 0603             7      LD  B,3
000D4B 0E4B 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D4D 0E4D CD0500          17      CALL    SYSTEM
                                
000D50 0E50 210D11          10      LD  HL,N_APPEND
000D53 0E53 111411          10      LD  DE,V_APPEND
000D56 0E56 0640             7      LD  B,PATHX
000D58 0E58 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D5A 0E5A C30500          10      JP  SYSTEM
                                
       0E5D                     CSET_LIST:
000D5D 0E5D 3E0A             7      LD  A,10
000D5F 0E5F 32DC13          13      LD  (CSET_DATA),A
000D62 0E62 110100          10      LD  DE,1
       0E65                     CSET1:
000D65 0E65 D5              11      PUSH    DE
000D66 0E66 016DFF          10      LD  BC,0FF6DH   ;_FENV 環境変数の検索
000D69 0E69 21DE13          10      LD  HL,DATA_COM
000D6C 0E6C 3600            10      LD  (HL),0
000D6E 0E6E CD0500          17      CALL    SYSTEM
000D71 0E71 B7               4      OR  A
000D72 0E72 2030            12      JR  NZ,CSET_ERROR
000D74 0E74 21DE13          10      LD  HL,DATA_COM
000D77 0E77 7E               7      LD  A,(HL)
000D78 0E78 B7               4      OR  A
000D79 0E79 2829            12      JR  Z,CSET_ERROR
000D7B 0E7B CD3B06          17      CALL    MSX
000D7E 0E7E 1E3D             7      LD  E,'='
000D80 0E80 CDCD0A          17      CALL    _PRINT
000D83 0E83 21DE13          10      LD  HL,DATA_COM
000D86 0E86 11DE14          10      LD  DE,DATA_COM+256
000D89 0E89 016BFF          10      LD  BC,0FF6BH   ;_GENV 環境変数の獲得
000D8C 0E8C CD0500          17      CALL    SYSTEM
000D8F 0E8F 21DE14          10      LD  HL,DATA_COM+256
000D92 0E92 CD3B06          17      CALL    MSX
000D95 0E95 CD7906          17      CALL    LTNL
000D98 0E98 3E0A             7      LD  A,10
000D9A 0E9A 32DC13          13      LD  (CSET_DATA),A
       0E9D                     CSET_NEXT:
000D9D 0E9D D1              10      POP DE
000D9E 0E9E 13               6      INC DE
000D9F 0E9F 7A               4      LD  A,D
000DA0 0EA0 B3               4      OR  E
000DA1 0EA1 20C2            12      JR  NZ,CSET1
000DA3 0EA3 C9              10      RET
       0EA4                     CSET_ERROR:
000DA4 0EA4 21DC13          10      LD  HL,CSET_DATA
000DA7 0EA7 35              11      DEC (HL)
000DA8 0EA8 20F3            12      JR  NZ,CSET_NEXT
       0EAA                     CSET_END:
000DAA 0EAA D1              10      POP DE
000DAB 0EAB C9              10      RET
                                
       0EAC                     C_FORMAT:
000DAC 0EAC 3ADD11          13      LD  A,(IS_MSX)
000DAF 0EAF B7               4      OR  A
000DB0 0EB0 C8              11      RET Z
000DB1 0EB1 3ADE11          13      LD  A,(MAJOR_VER)
000DB4 0EB4 FE02             7      CP  2
000DB6 0EB6 300B            12      JR  NC,FORMAT2
       0EB8                     FORMAT1:
000DB8 0EB8 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000DBC 0EBC DD214701        14      LD  IX,FORMAT
000DC0 0EC0 C31C00          10      JP  CALSLT
       0EC3                     FORMAT2:
000DC3 0EC3 CD6808          17      CALL    SETFCB
000DC6 0EC6 3A5C00          13      LD  A,(FCB1)
000DC9 0EC9 B7               4      OR  A
000DCA 0ECA 28EC            12      JR  Z,FORMAT1
000DCC 0ECC 47               4      LD  B,A
000DCD 0ECD AF               4      XOR A
000DCE 0ECE 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000DD0 0ED0 CD0500          17      CALL    SYSTEM
000DD3 0ED3 B7               4      OR  A
000DD4 0ED4 20E2            12      JR  NZ,FORMAT1
000DD6 0ED6 CD4406          17      CALL    MSXSLT
000DD9 0ED9 21DA11          10      LD  HL,PROMPT
000DDC 0EDC CD3B06          17      CALL    MSX
       0EDF                     FORMAT3:
000DDF 0EDF 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DE1 0EE1 CD0500          17      CALL    SYSTEM
000DE4 0EE4 D631             7      SUB '0'+1
000DE6 0EE6 38F7            12      JR  C,FORMAT3
000DE8 0EE8 3C               4      INC A
000DE9 0EE9 FE0A             7      CP  10
000DEB 0EEB 30F2            12      JR  NC,FORMAT3
000DED 0EED F5              11      PUSH    AF
000DEE 0EEE CD7906          17      CALL    LTNL
000DF1 0EF1 21C210          10      LD  HL,PAUSE
000DF4 0EF4 CD3B06          17      CALL    MSX
000DF7 0EF7 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DF9 0EF9 CD0500          17      CALL    SYSTEM
000DFC 0EFC CD7906          17      CALL    LTNL
000DFF 0EFF F1              10      POP AF
000E00 0F00 ED4B5B00        20      LD  BC,(FCB1-1)
000E04 0F04 210080          10      LD  HL,08000H
000E07 0F07 110040          10      LD  DE,04000H
000E0A 0F0A 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000E0C 0F0C C30500          10      JP  SYSTEM
                                
       0F0F                     C_RAMDISK:
000E0F 0F0F 3ADD11          13      LD  A,(IS_MSX)
000E12 0F12 B7               4      OR  A
000E13 0F13 C8              11      RET Z
000E14 0F14 3ADE11          13      LD  A,(MAJOR_VER)
000E17 0F17 FE02             7      CP  2
000E19 0F19 D8              11      RET C
000E1A 0F1A CDF90B          17      CALL    SPCUT
000E1D 0F1D 1A               7      LD  A,(DE)
000E1E 0F1E FE30             7      CP  '0'
000E20 0F20 D8              11      RET C
000E21 0F21 FE3A             7      CP  '9'+1
000E23 0F23 3F               4      CCF
000E24 0F24 D8              11      RET C
000E25 0F25 CDE50F          17      CALL    GETNUM
000E28 0F28 110F00          10      LD  DE,15       ;切り上げの為
000E2B 0F2B 19              11      ADD HL,DE
000E2C 0F2C 7D               4      LD  A,L
000E2D 0F2D 0604             7      LD  B,4     ;16で割る
       0F2F                     RAMDISK1:
000E2F 0F2F CB3C             8      SRL H   ;/2
000E31 0F31 1F               4      RRA
000E32 0F32 10FB            13      DJNZ    RAMDISK1
000E34 0F34 FEFF             7      CP  0FFH
000E36 0F36 2001            12      JR  NZ,RAMDISK2
000E38 0F38 3D               4      DEC A
       0F39                     RAMDISK2:
000E39 0F39 47               4      LD  B,A
000E3A 0F3A 0E68             7      LD  C,068H      ;(_RAMD)RAMディスクの作成あるいは消去
000E3C 0F3C CD0500          17      CALL    SYSTEM
000E3F 0F3F B7               4      OR  A
000E40 0F40 CC000E          17      CALL    Z,SHOW_OK
000E43 0F43 C9              10      RET
                                
       0F44                     C_ATTRIB:
000E44 0F44 3ADD11          13      LD  A,(IS_MSX)
000E47 0F47 B7               4      OR  A
000E48 0F48 C8              11      RET Z
000E49 0F49 3ADE11          13      LD  A,(MAJOR_VER)
000E4C 0F4C FE02             7      CP  2
000E4E 0F4E D8              11      RET C
000E4F 0F4F ED53700F        20      LD  (ATTRIB_OPT),DE
                                                ;パス名を検索
       0F53                     ATTRIB1:
000E53 0F53 CDF90B          17      CALL    SPCUT
000E56 0F56 1A               7      LD  A,(DE)
000E57 0F57 13               6      INC DE
000E58 0F58 FE20             7      CP  ' '
000E5A 0F5A D8              11      RET C
000E5B 0F5B FE41             7      CP  'A'
000E5D 0F5D 3003            12      JR  NC,ATTRIB2
000E5F 0F5F 13               6      INC DE
000E60 0F60 18F1            12      JR  ATTRIB1
       0F62                     ATTRIB2:
000E62 0F62 1B               6      DEC DE
000E63 0F63 ED53D80F        20      LD  (ATTRIB_PATH),DE
000E67 0F67 AF               4      XOR A
000E68 0F68 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000E6A 0F6A CDCA03          17      CALL    SYSTEM0
000E6D 0F6D 37               4      SCF
000E6E 0F6E C0              11      RET NZ
                                
000E6F 0F6F 110000          10      LD  DE,0
       0F70                     ATTRIB_OPT  EQU $-2
       0F72                     ATTRIB3:
000E72 0F72 CDF90B          17      CALL    SPCUT
000E75 0F75 1A               7      LD  A,(DE)
000E76 0F76 13               6      INC DE
000E77 0F77 FE41             7      CP  'A'
000E79 0F79 305C            12      JR  NC,ATTRIB_WRITE
000E7B 0F7B FE2D             7      CP  '-'
000E7D 0F7D 280A            12      JR  Z,ATTRIB_M
000E7F 0F7F FE2B             7      CP  '+'
000E81 0F81 282D            12      JR  Z,ATTRIB_P
000E83 0F83 FE2F             7      CP  '/'
000E85 0F85 1A               7      LD  A,(DE)
000E86 0F86 13               6      INC DE
000E87 0F87 18E9            12      JR  ATTRIB3
       0F89                     ATTRIB_M:
000E89 0F89 1A               7      LD  A,(DE)
000E8A 0F8A 13               6      INC DE
000E8B 0F8B CD0C0C          17      CALL    CAP
000E8E 0F8E FE41             7      CP  'A'
000E90 0F90 280E            12      JR  Z,ATTRIB_M_A
000E92 0F92 FE53             7      CP  'S'
000E94 0F94 280E            12      JR  Z,ATTRIB_M_S
000E96 0F96 FE48             7      CP  'H'
000E98 0F98 280E            12      JR  Z,ATTRIB_M_H
000E9A 0F9A FE52             7      CP  'R'
000E9C 0F9C 280E            12      JR  Z,ATTRIB_M_R
000E9E 0F9E 18D2            12      JR  ATTRIB3
       0FA0                     ATTRIB_M_A:
000EA0 0FA0 CBAD             8      RES 5,L
000EA2 0FA2 18CE            12      JR  ATTRIB3
       0FA4                     ATTRIB_M_S:
000EA4 0FA4 CB95             8      RES 2,L
000EA6 0FA6 18CA            12      JR  ATTRIB3
       0FA8                     ATTRIB_M_H:
000EA8 0FA8 CB8D             8      RES 1,L
000EAA 0FAA 18C6            12      JR  ATTRIB3
       0FAC                     ATTRIB_M_R:
000EAC 0FAC CB85             8      RES 0,L
000EAE 0FAE 18C2            12      JR  ATTRIB3
       0FB0                     ATTRIB_P:
000EB0 0FB0 1A               7      LD  A,(DE)
000EB1 0FB1 13               6      INC DE
000EB2 0FB2 CD0C0C          17      CALL    CAP
000EB5 0FB5 FE41             7      CP  'A'
000EB7 0FB7 280E            12      JR  Z,ATTRIB_P_A
000EB9 0FB9 FE53             7      CP  'S'
000EBB 0FBB 280E            12      JR  Z,ATTRIB_P_S
000EBD 0FBD FE48             7      CP  'H'
000EBF 0FBF 280E            12      JR  Z,ATTRIB_P_H
000EC1 0FC1 FE52             7      CP  'R'
000EC3 0FC3 280E            12      JR  Z,ATTRIB_P_R
000EC5 0FC5 18AB            12      JR  ATTRIB3
       0FC7                     ATTRIB_P_A:
000EC7 0FC7 CBED             8      SET 5,L
000EC9 0FC9 18A7            12      JR  ATTRIB3
       0FCB                     ATTRIB_P_S:
000ECB 0FCB CBD5             8      SET 2,L
000ECD 0FCD 18A3            12      JR  ATTRIB3
       0FCF                     ATTRIB_P_H:
000ECF 0FCF CBCD             8      SET 1,L
000ED1 0FD1 189F            12      JR  ATTRIB3
       0FD3                     ATTRIB_P_R:
000ED3 0FD3 CBC5             8      SET 0,L
000ED5 0FD5 189B            12      JR  ATTRIB3
       0FD7                     ATTRIB_WRITE:
000ED7 0FD7 110000          10      LD  DE,0
       0FD8                     ATTRIB_PATH EQU $-2
000EDA 0FDA 3E01             7      LD  A,1
000EDC 0FDC 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000EDE 0FDE CDCA03          17      CALL    SYSTEM0
000EE1 0FE1 D8              11      RET C
000EE2 0FE2 C3000E          10      JP  SHOW_OK
                                
       0FE5                     GETNUM:
000EE5 0FE5 CDF90B          17      CALL    SPCUT
000EE8 0FE8 210000          10      LD  HL,0
       0FEB                     GETNUM1:
000EEB 0FEB 1A               7      LD  A,(DE)
000EEC 0FEC 13               6      INC DE
000EED 0FED D630             7      SUB '0'
000EEF 0FEF D8              11      RET C
000EF0 0FF0 FE0A             7      CP  10
000EF2 0FF2 D0              11      RET NC
000EF3 0FF3 4D               4      LD  C,L
000EF4 0FF4 44               4      LD  B,H
000EF5 0FF5 29              11      ADD HL,HL   ;*2
000EF6 0FF6 29              11      ADD HL,HL   ;*4
000EF7 0FF7 09              11      ADD HL,BC   ;*5
000EF8 0FF8 29              11      ADD HL,HL   ;*10
000EF9 0FF9 4F               4      LD  C,A
000EFA 0FFA 0600             7      LD  B,0
000EFC 0FFC 09              11      ADD HL,BC
000EFD 0FFD 18EC            12      JR  GETNUM1
                                
       0012                     COMS    EQU 18
       0FFF                     COMTB:
000EFF 0FFF 44202020202020          DB  "D      "   ;1
000F06 1006 CF05                    DW  C_DIR
000F08 1008 44495220202020          DB  "DIR    "   ;2
000F0F 100F CF05                    DW  C_DIR
000F11 1011 434F5059202020          DB  "COPY   "   ;3
000F18 1018 B108                    DW  C_COPY
000F1A 101A 43442020202020          DB  "CD     "   ;4
000F21 1021 CF03                    DW  C_CD
000F23 1023 44454C20202020          DB  "DEL    "   ;5
000F2A 102A 6E05                    DW  C_DEL
000F2C 102C 50415448202020          DB  "PATH   "   ;6
000F33 1033 8306                    DW  C_PATH
000F35 1035 52454E20202020          DB  "REN    "   ;7
000F3C 103C A105                    DW  C_REN
000F3E 103E 54595045202020          DB  "TYPE   "   ;8
000F45 1045 5C0A                    DW  C_TYPE
000F47 1047 52454D20202020          DB  "REM    "   ;9
000F4E 104E 6C05                    DW  C_REM
000F50 1050 4D4F4445202020          DB  "MODE   "   ;10
000F57 1057 7D0D                    DW  C_MODE
000F59 1059 50415553452020          DB  "PAUSE  "   ;11
000F60 1060 CA0D                    DW  C_PAUSE
000F62 1062 53455420202020          DB  "SET    "   ;12
000F69 1069 190E                    DW  C_SET
000F6B 106B 4543484F202020          DB  "ECHO   "   ;13
000F72 1072 E50D                    DW  C_ECHO
000F74 1074 4D4B4449522020          DB  "MKDIR  "   ;14
000F7B 107B EF0D                    DW  C_MKDIR
000F7D 107D 524D4449522020          DB  "RMDIR  "   ;15
000F84 1084 0B0E                    DW  C_RMDIR
000F86 1086 464F524D415420          DB  "FORMAT "   ;16
000F8D 108D AC0E                    DW  C_FORMAT
000F8F 108F 52414D4449534B          DB  "RAMDISK"   ;17
000F96 1096 0F0F                    DW  C_RAMDISK
000F98 1098 41545452494220          DB  "ATTRIB "   ;18
000F9F 109F 440F                    DW  C_ATTRIB
                                
000FA1 10A1 2062797465732066    FREE:   DB  " bytes free  $"
            726565202024        
000FAF 10AF 2020203C4449523E    DIRMES: DB  "   <DIR>$"
            24                  
000FB8 10B8 4F4B24              OK: DB  "OK$"
000FBB 10BB 4572726F722124      COMERM: DB  "Error!$"
000FC2 10C2 537472696B652061    PAUSE:  DB  "Strike any key when ready ",0
            6E79206B65792077    
            68656E2072656164    
            792000              
                                
       10DD                     S_MONTH:
000FDD 10DD 4A616E00                DB  "Jan",0
000FE1 10E1 46656200                DB  "Feb",0
000FE5 10E5 4D617200                DB  "Mar",0
000FE9 10E9 41707200                DB  "Apr",0
000FED 10ED 4D617900                DB  "May",0
000FF1 10F1 4A756E00                DB  "Jun",0
000FF5 10F5 4A756C00                DB  "Jul",0
000FF9 10F9 41756700                DB  "Aug",0
000FFD 10FD 53657000                DB  "Sep",0
001001 1101 4F637400                DB  "Oct",0
001005 1105 4E6F7600                DB  "Nov",0
001009 1109 44656300                DB  "Dec",0
                                
       110D                     N_APPEND:
00100D 110D 415050454E4400          DB  "APPEND",0
       1114                     V_APPEND:
001014 1114                         DS  64
       1154                     N_PATH:
001054 1154 5041544800              DB  "PATH",0
       1159                     V_PATH:
001059 1159                         DS  PATHX
       1199                     N_DATE:
001099 1199 4441544500              DB  "DATE",0
       119E                     V_DATE:
00109E 119E 79792D6D6D2D6464        DB  "yy-mm-dd"
0010A6 11A6                         DS  8
       11AE                     V_DATE1:
0010AE 11AE 6D6D2D64642D7979        DB  "mm-dd-yy"
       11B6                     V_DATE2:
0010B6 11B6 64642D6D6D2D7979        DB  "dd-mm-yy"
       11BE                     N_TIME:
0010BE 11BE 54494D4500              DB  "TIME",0
       11C3                     V_TIME:
0010C3 11C3 323400                  DB  "24",0
       11C6                     N_PROGRAM:
0010C6 11C6 50524F4752414D00        DB  "PROGRAM",0
       11CE                     N_PARAMETERS:
0010CE 11CE 504152414D455445        DB  "PARAMETERS",0
            525300              
                                
       11D9                     F_TIME:
0010D9 11D9 00                      DB  0
       11DA                     PROMPT:
0010DA 11DA 3F2000                  DB  "? ",0
       11DD                     IS_MSX:
0010DD 11DD 00                      DB  0
       11DE                     MAJOR_VER:
0010DE 11DE 00                      DB  0
       11DF                     SEARCH_IX:
0010DF 11DF                         DS  64  ;DOS2用
       121F                     HANDLE1:
00111F 121F 0000                    DW  0
       1221                     PATH_POS:
001121 1221 0000                    DW  0
       1223                     PATH_DRV:
001123 1223 413A5C                  DB  "A:\\"
       1226                     PATH_CCP:
001126 1226                         DS  64  ;DOS2用
       1266                     PATH_PAR:
001166 1266                         DS  64  ;DOS2用
       12A6                     PATH_FN1:
0011A6 12A6                         DS  64  ;DOS2用
       12E6                     PATH_FN2:
0011E6 12E6                         DS  64  ;DOS2用
       1326                     CUR_DRV:
001226 1326 413A5C                  DB  "A:\\"
       1329                     CUR_PATH:
001229 1329                         DS  64  ;DOS2用
       1369                     DOS2NAME:
001269 1369                         DS  2+8+3+1 ;DOS2用
       1377                     DTA_CCP:
001277 1377                         DS  37
       139C                     DIR_CK:
00129C 139C 0000                    DW  0
                                
       139E                     CPBUF:
00129E 139E 0000                LEFTX:  DW  0
0012A0 13A0 0000                DTAX:   DW  0
0012A2 13A2 20                      DB  020H    ;CPBUFで使う
0012A3 13A3 20                      DB  020H
0012A4 13A4 20                      DB  020H
0012A5 13A5 20                      DB  020H
0012A6 13A6 20                      DB  020H
0012A7 13A7 20                      DB  020H
0012A8 13A8 20                      DB  020H
                                
       13A9                     DECBF:
0012A9 13A9                         DS  5
       13AE                     FCB_BAT2:
0012AE 13AE 00                      DB  0
       13AF                     FDRV:
0012AF 13AF 00                      DB  0
       13B0                     FNAME:
0012B0 13B0                         DS  37
       13D5                     ZERO:
0012D5 13D5 00                      DB  0
       13D6                     FCB_BAT:
0012D6 13D6 AE13                    DW  FCB_BAT2
       13D8                     X_PATH:
0012D8 13D8 0000                    DW  0
       13DA                     PATH_FN2_SL:
0012DA 13DA 0000                    DW  0
       13DC                     CSET_DATA:
0012DC 13DC 00                      DB  0
       13DD                     PROCESS:
0012DD 13DD 00                      DB  0
                                
       13DE                     DATA_COM:
[EOF:COMMAND.ASM:UTF_8]
