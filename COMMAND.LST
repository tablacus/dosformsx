                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.21.0, LST:Full:4
                                
                                ;   似非COMMAND.COM
                                
                                    INCLUDE "DEF.ASM"
                                ;
                                ;   似非DOS
                                ;
       0024                     VER_BCD EQU 00024H
                                
       0005                     SYSTEM  EQU 00005H
       005C                     FCB1    EQU 0005CH
       006C                     FCB2    EQU 0006CH
       0080                     DTA1    EQU 00080H
                                
       000C                     RDSLT   EQU 0000CH
       001C                     CALSLT  EQU 0001CH
       006C                     INITXT  EQU 0006CH
       006F                     INIT32  EQU 0006FH
       0078                     SETTXT  EQU 00078H
       007B                     SETT32  EQU 0007BH
       0147                     FORMAT  EQU 00147H
                                
       0402                     MAPPER  EQU 00402H
                                
       F307                     FCB11   EQU 0F307H
       F37D                     BDOS    EQU 0F37DH
       F3AF                     LINL32  EQU 0F3AFH
       F3AE                     LINL40  EQU 0F3AEH
       F3B0                     LINLEN  EQU 0F3B0H
                                
       F41F                     KBUF    EQU 0F41FH; 318
       F55E                     BUF EQU 0F55EH; 258
                                
       F662                     DIMFLG  EQU 0F662H
       F663                     VALTYP  EQU 0F663H
       F672                     MEMSIZ  EQU 0F672H
       F6A7                     TEMP    EQU 0F6A7H
       F6AF                     SAVTXT  EQU 0F6AFH
       F6B1                     SAVSTK  EQU 0F6B1H
       F6B5                     DOT EQU 0F6B5H
       F6B9                     ONELIN  EQU 0F6B9H
                                
       F7C4                     TRCFLG  EQU 0F7C4H
                                
       FAF8                     EXBRSA  EQU 0FAF8H
                                
       FC9B                     INTFLG  EQU 0FC9BH
       FCC1                     EXPTBL  EQU 0FCC1H
       FFCA                     EXTBIOS EQU 0FFCAH
[EOF:DEF.ASM:UTF_8]
                                
       0040                     PATHX   EQU 64
                                
       8000                     DATA    EQU 08000H
                                
000000 0100                         ORG 00100H
000000 0100 C31601          10      JP  START
       0103                     TITLE:
000003 0103 0D0A70736575646F        DB  00DH,00AH,"pseudo COMMAND v$"
            20434F4D4D414E44    
            207624              
       0116                     START:
000016 0116 ED7B0600        20      LD  SP,(SYSTEM+1)
00001A 011A 0E6F             7      LD  C,06FH      ;(BDOS)MSX-DOS のバージョン番号の獲得
00001C 011C CD0500          17      CALL    SYSTEM
00001F 011F D8              11      RET C
000020 0120 211D01          10      LD  HL,0011DH
000023 0123 ED42            15      SBC HL,BC
000025 0125 78               4      LD  A,B
000026 0126 32DA11          13      LD  (MAJOR_VER),A
000029 0129 B5               4      OR  L
00002A 012A 32D911          13      LD  (IS_MSX),A
00002D 012D B7               4      OR  A
00002E 012E CAC101          10      JP  Z,WSTART
000031 0131 21918A          10      LD  HL,08A91H
000034 0134 ED52            15      SBC HL,DE
000036 0136 2005            12      JR  NZ,NOTABLACUS
000038 0138 3E01             7      LD  A,1
00003A 013A 32DA11          13      LD  (MAJOR_VER),A
       013D                     NOTABLACUS:
00003D 013D 3AD913          13      LD  A,(PROCESS)
000040 0140 0E61             7      LD  C,61H       ;(BDOS)親プロセスに戻る
000042 0142 47               4      LD  B,A
000043 0143 B7               4      OR  A
000044 0144 C40500          17      CALL    NZ,SYSTEM
000047 0147 AF               4      XOR A
000048 0148 32D913          13      LD  (PROCESS),A
                                
00004B 014B 212B00          10      LD  HL,002BH    ;キャラクターセット・日時フォーマット・ビデオ信号の種別
00004E 014E CD0C00          17      CALL    RDSLT
000051 0151 0F               4      RRCA
000052 0152 0F               4      RRCA
000053 0153 0F               4      RRCA
000054 0154 0F               4      RRCA
000055 0155 E603             7      AND 3
000057 0157 2814            12      JR  Z,DATEOK
000059 0159 3D               4      DEC A
00005A 015A 21AA11          10      LD  HL,V_DATE1
00005D 015D 2806            12      JR  Z,DATECHG
00005F 015F 3D               4      DEC A
000060 0160 21B211          10      LD  HL,V_DATE2
000063 0163 2008            12      JR  NZ,DATEOK
       0165                     DATECHG:
000065 0165 119A11          10      LD  DE,V_DATE
000068 0168 010800          10      LD  BC,8
00006B 016B EDB0                    LDIR
       016D                     DATEOK:
00006D 016D CD320E          17      CALL    INIT_VAR
000070 0170 3AC4F7          13      LD  A,(TRCFLG)
000073 0173 B7               4      OR  A
000074 0174 2814            12      JR  Z,WSTART0
000076 0176 11B710          10      LD  DE,COMERM
000079 0179 0E09             7      LD  C,9     ;(BDOS)文字列出力
00007B 017B CD0500          17      CALL    SYSTEM
00007E 017E 2AC4F7          16      LD  HL,(TRCFLG)
000081 0181 2600             7      LD  H,0
000083 0183 CDD706          17      CALL    PRDEC_HL
000086 0186 AF               4      XOR A
000087 0187 32C4F7          13      LD  (TRCFLG),A
       018A                     WSTART0:
00008A 018A 2A0100          16      LD  HL,(1)
00008D 018D 2EDB             7      LD  L,256-37
00008F 018F 25               4      DEC H
000090 0190 22D213          16      LD  (FCB_BAT),HL
000093 0193 3A8000          13      LD  A,(DTA1)
000096 0196 B7               4      OR  A
000097 0197 2828            12      JR  Z,WSTART
000099 0199 110301          10      LD  DE,TITLE
00009C 019C 0E09             7      LD  C,9
00009E 019E CD0500          17      CALL    SYSTEM
                                
0000A1 01A1 212400          10      LD  HL,VER_BCD
0000A4 01A4 7C               4      LD  A,H
0000A5 01A5 CDE30A          17      CALL    PRTHX1
0000A8 01A8 3E2E             7      LD  A,'.'
0000AA 01AA CDE60A          17      CALL    MSG_A
0000AD 01AD 7D               4      LD  A,L
0000AE 01AE CDDA0A          17      CALL    PRTHX
0000B1 01B1 3E0D             7      LD  A,00DH
0000B3 01B3 CDE60A          17      CALL    MSG_A
0000B6 01B6 3E0A             7      LD  A,00AH
0000B8 01B8 CDE60A          17      CALL    MSG_A
                                
0000BB 01BB 118100          10      LD  DE,DTA1+1
0000BE 01BE CD2402          17      CALL    COMANL
       01C1                     WSTART:
0000C1 01C1 210911          10      LD  HL,N_APPEND
0000C4 01C4 111011          10      LD  DE,V_APPEND
0000C7 01C7 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000C9 01C9 CD0500          17      CALL    SYSTEM
                                
0000CC 01CC 21C211          10      LD  HL,N_PROGRAM
0000CF 01CF 11D113          10      LD  DE,ZERO
0000D2 01D2 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000D4 01D4 CD0500          17      CALL    SYSTEM
                                
0000D7 01D7 21CA11          10      LD  HL,N_PARAMETERS
0000DA 01DA 11D113          10      LD  DE,ZERO
0000DD 01DD 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0000DF 01DF CD0500          17      CALL    SYSTEM
                                
0000E2 01E2 CD7506          17      CALL    LTNL
       01E5                     COMMAND:
0000E5 01E5 E5              11      PUSH    HL
0000E6 01E6 2AD213          16      LD  HL,(FCB_BAT)
0000E9 01E9 7E               7      LD  A,(HL)
0000EA 01EA E1              10      POP HL
0000EB 01EB B7               4      OR  A
0000EC 01EC C21705          10      JP  NZ,C_BAT1
0000EF 01EF CDBF03          17      CALL    SETDTA1
0000F2 01F2 D5              11      PUSH    DE
0000F3 01F3 C5              11      PUSH    BC
0000F4 01F4 E5              11      PUSH    HL
0000F5 01F5 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0000F7 01F7 CD0500          17      CALL    SYSTEM
0000FA 01FA E1              10      POP HL
0000FB 01FB C1              10      POP BC
0000FC 01FC C641             7      ADD A,'A'
0000FE 01FE CDE60A          17      CALL    MSG_A
000101 0201 1E3E             7      LD  E,'>'
000103 0203 CDC90A          17      CALL    _PRINT
000106 0206 D1              10      POP DE      ;DE=DTA1
000107 0207 3E50             7      LD  A,80
000109 0209 12               7      LD  (DE),A
00010A 020A 0E0A             7      LD  C,0AH       ;(BDOS)文字列入力
00010C 020C CD0500          17      CALL    SYSTEM
00010F 020F CD7506          17      CALL    LTNL
       0212                     COMMAND2:
000112 0212 118200          10      LD  DE,DTA1+2
000115 0215 CD2402          17      CALL    COMANL
000118 0218 30CB            12      JR  NC,COMMAND
00011A 021A 11B710          10      LD  DE,COMERM
00011D 021D 0E09             7      LD  C,9     ;(BDOS)文字列出力
00011F 021F CD0500          17      CALL    SYSTEM
000122 0222 189D            12      JR  WSTART
                                
       0224                     COMANL:
000124 0224 CDFB0B          17      CALL    TOZERO
000127 0227 ED535102        20      LD  (COMST),DE
00012B 022B CD310B          17      CALL    FILE
00012E 022E D5              11      PUSH    DE
00012F 022F 11AC13          10      LD  DE,FNAME
000132 0232 1A               7      LD  A,(DE)
000133 0233 FE20             7      CP  020H
000135 0235 CAC202          10      JP  Z,SDVSW
000138 0238 1B               6      DEC DE
000139 0239 1A               7      LD  A,(DE)
00013A 023A C6FF             7      ADD A,0FFH
00013C 023C 380A            12      JR  C,COMB
00013E 023E 13               6      INC DE
                                
00013F 023F 21FB0F          10      LD  HL,COMTB
000142 0242 3E12             7      LD  A,COMS
000144 0244 47               4      LD  B,A
000145 0245 CD4D0C          17      CALL    CPNAME
       0248                     COMB:
000148 0248 D1              10      POP DE
000149 0249 D2C80A          10      JP  NC,JP_HL
       024C                     COMB2:
00014C 024C EB               4      EX  DE,HL
00014D 024D 224604          16      LD  (COMPAT),HL
                                
000150 0250 110000          10      LD  DE,0
       0251                     COMST   EQU $-2
000153 0253 21DA13          10      LD  HL,DATA_COM
000156 0256 3600            10      LD  (HL),0
       0258                     COMPR1:
000158 0258 1A               7      LD  A,(DE)
000159 0259 13               6      INC DE
00015A 025A 23               6      INC HL
00015B 025B 77               7      LD  (HL),A
00015C 025C FE20             7      CP  020H
00015E 025E 30F8            12      JR  NC,COMPR1
       0260                     COMPR2:
000160 0260 2B               6      DEC HL
000161 0261 7E               7      LD  A,(HL)
000162 0262 FE5C             7      CP  05CH
000164 0264 2014            12      JR  NZ,COMPR3
000166 0266 3600            10      LD  (HL),0
000168 0268 23               6      INC HL
000169 0269 EB               4      EX  DE,HL
00016A 026A CD310B          17      CALL    FILE
00016D 026D 210911          10      LD  HL,N_APPEND
000170 0270 11DB13          10      LD  DE,DATA_COM+1
000173 0273 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000175 0275 CD0500          17      CALL    SYSTEM
000178 0278 1804            12      JR  COMPR4
       027A                     COMPR3:
00017A 027A FE20             7      CP  020H
00017C 027C 30E2            12      JR  NC,COMPR2
       027E                     COMPR4:
00017E 027E CD0804          17      CALL    CEXE4
                                
000181 0281 215011          10      LD  HL,N_PATH
000184 0284 115511          10      LD  DE,V_PATH
000187 0287 0640             7      LD  B,PATHX
000189 0289 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
00018B 028B CD0500          17      CALL    SYSTEM
                                
00018E 028E 215511          10      LD  HL,V_PATH
000191 0291 22D413          16      LD  (X_PATH),HL
       0294                     CEX1:
000194 0294 2AD413          16      LD  HL,(X_PATH)
000197 0297 7E               7      LD  A,(HL)
000198 0298 FE20             7      CP  020H
00019A 029A D8              11      RET C
       029B                     CEX2:
00019B 029B 7E               7      LD  A,(HL)
00019C 029C FE20             7      CP  020H
00019E 029E 3807            12      JR  C,CEX3
0001A0 02A0 FE3B             7      CP  ';'
0001A2 02A2 2803            12      JR  Z,CEX3
0001A4 02A4 23               6      INC HL
0001A5 02A5 18F4            12      JR  CEX2
       02A7                     CEX3:
0001A7 02A7 3600            10      LD  (HL),0
0001A9 02A9 FE20             7      CP  020H
0001AB 02AB 3801            12      JR  C,CEX4
0001AD 02AD 23               6      INC HL
       02AE                     CEX4:
0001AE 02AE ED5BD413        20      LD  DE,(X_PATH)
0001B2 02B2 22D413          16      LD  (X_PATH),HL
0001B5 02B5 210911          10      LD  HL,N_APPEND
0001B8 02B8 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0001BA 02BA CD0500          17      CALL    SYSTEM
                                
0001BD 02BD CD0804          17      CALL    CEXE4
0001C0 02C0 18D2            12      JR  CEX1
                                
       02C2                     SDVSW:
0001C2 02C2 F1              10      POP AF
0001C3 02C3 3AAB13          13      LD  A,(FDRV)
0001C6 02C6 3D               4      DEC A
0001C7 02C7 5F               4      LD  E,A
0001C8 02C8 0E0E             7      LD  C,00EH      ;(BDOS)カレントドライブの設定
0001CA 02CA C3C603          10      JP  SYSTEM0
                                
       02CD                     OPEN_D2:            ;DOS2対応
0001CD 02CD 3ADA11          13      LD  A,(MAJOR_VER)
0001D0 02D0 FE02             7      CP  2
0001D2 02D2 384F            12      JR  C,OPEN
0001D4 02D4 11A212          10      LD  DE,PATH_FN1
0001D7 02D7 180A            12      JR  OPEN_D2X
       02D9                     OPEN1_D2:           ;DOS2対応
0001D9 02D9 3ADA11          13      LD  A,(MAJOR_VER)
0001DC 02DC FE02             7      CP  2
0001DE 02DE 3840            12      JR  C,OPEN1
                                
0001E0 02E0 112212          10      LD  DE,PATH_CCP
       02E3                     OPEN_D2X:
0001E3 02E3 DD21DB11        14      LD  IX,SEARCH_IX
0001E7 02E7 014010          10      LD  BC,01040H   ;(BDOS)最初のエントリ検索
0001EA 02EA CD0500          17      CALL    SYSTEM
0001ED 02ED F5              11      PUSH    AF
0001EE 02EE 116212          10      LD  DE,PATH_PAR
0001F1 02F1 0E5E             7      LD  C,05EH      ;(BDOS)完全なパス文字列の獲得(_WPATH)
0001F3 02F3 CD0500          17      CALL    SYSTEM
0001F6 02F6 AF               4      XOR A
0001F7 02F7 77               7      LD  (HL),A
0001F8 02F8 116212          10      LD  DE,PATH_PAR
0001FB 02FB ED52            15      SBC HL,DE
0001FD 02FD 221D12          16      LD  (PATH_POS),HL
000200 0300 F1              10      POP AF
       0301                     FIB2DIRENT:
000201 0301 B7               4      OR  A
000202 0302 C0              11      RET NZ
                                
000203 0303 11DC11          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
000206 0306 217413          10      LD  HL,DTA_CCP+1
000209 0309 0E5C             7      LD  C,05CH      ;(BDOS)ファイル名の解析
00020B 030B CD0500          17      CALL    SYSTEM
                                
00020E 030E 21E911          10      LD  HL,SEARCH_IX+14 ;(FIB)属性
000211 0311 117F13          10      LD  DE,DTA_CCP+1+8+3
000214 0314 EDA0            16      LDI
000216 0316 118A13          10      LD  DE,DTA_CCP+1+8+3+1+10
000219 0319 010A00          10      LD  BC,2+2+2+4  ;最終変更時刻+最終変更日付+開始クラスタ+ファイルサイズ
00021C 031C EDB0                    LDIR
00021E 031E AF               4      XOR A
00021F 031F C9              10      RET
                                
       0320                     OPEN1:
000220 0320 21AB13          10      LD  HL,FDRV
       0323                     OPEN:
000223 0323 0E11             7      LD  C,011H      ;(BDOS)最初のファイルの検索
       0325                     OPEN3:
000225 0325 D5              11      PUSH    DE
000226 0326 117313          10      LD  DE,DTA_CCP
000229 0329 CDB203          17      CALL    SETDTA
00022C 032C C5              11      PUSH    BC
00022D 032D E5              11      PUSH    HL
00022E 032E 010E00          10      LD  BC,14
000231 0331 09              11      ADD HL,BC
000232 0332 223D03          16      LD  (OPEN3_SWC),HL
000235 0335 E1              10      POP HL
000236 0336 C1              10      POP BC
000237 0337 EB               4      EX  DE,HL
000238 0338 CDC603          17      CALL    SYSTEM0
00023B 033B D1              10      POP DE
00023C 033C 2A0000          16      LD  HL,(0)      ;Tablacus Disk ROM Lite　階層ディレクトリ
       033D                     OPEN3_SWC   EQU $-2
00023F 033F 228113          16      LD  (DTA_CCP+14),HL
000242 0342 C9              10      RET
                                
       0343                     OPEN2_D2:           ;DOS2対応
000243 0343 3ADA11          13      LD  A,(MAJOR_VER)
000246 0346 FE02             7      CP  2
000248 0348 380B            12      JR  C,OPEN2
00024A 034A DD21DB11        14      LD  IX,SEARCH_IX
00024E 034E 0E41             7      LD  C,41H       ;(BDOS)次のエントリ検索
000250 0350 CD0500          17      CALL    SYSTEM
000253 0353 18AC            12      JR  FIB2DIRENT
       0355                     OPEN2:
000255 0355 0E12             7      LD  C,012H
000257 0357 18CC            12      JR  OPEN3
                                
       0359                     DEFCB_D2:           ;DOS2対応
000259 0359 3ADA11          13      LD  A,(MAJOR_VER)
00025C 035C FE02             7      CP  2
00025E 035E 383A            12      JR  C,DEFCB
000260 0360 216212          10      LD  HL,PATH_PAR
000263 0363 112212          10      LD  DE,PATH_CCP
000266 0366 014000          10      LD  BC,64
000269 0369 EDB0                    LDIR
00026B 036B 2A1D12          16      LD  HL,(PATH_POS)
00026E 036E 112212          10      LD  DE,PATH_CCP
000271 0371 19              11      ADD HL,DE
000272 0372 060D             7      LD  B,13
000274 0374 11DC11          10      LD  DE,SEARCH_IX+1  ;(FIB)ファイル名
       0377                     DCB4:
000277 0377 1A               7      LD  A,(DE)
000278 0378 B7               4      OR  A
000279 0379 2805            12      JR  Z,DCB5
00027B 037B 13               6      INC DE
00027C 037C 77               7      LD  (HL),A
00027D 037D 23               6      INC HL
00027E 037E 18F7            12      JR  DCB4
       0380                     DCB5:
000280 0380 3600            10      LD  (HL),0
000282 0382 3AF411          13      LD  A,(SEARCH_IX+25)    ;(FIB)ドライブ番号(1-8)
000285 0385 C640             7      ADD A,040H
000287 0387 111F12          10      LD  DE,PATH_DRV
00028A 038A 12               7      LD  (DE),A
00028B 038B 0E43             7      LD  C,043H      ;_OPEN ファイルハンドルのオープン
00028D 038D 3E01             7      LD  A,1     ;書き込み禁止
00028F 038F CD0500          17      CALL    SYSTEM
000292 0392 B7               4      OR  A
000293 0393 C0              11      RET NZ
000294 0394 ED431B12        20      LD  (HANDLE1),BC
000298 0398 1815            12      JR  SETDTA100
       039A                     DEFCB:              ;Z=Ok NZ=Error
00029A 039A 117313          10      LD  DE,DTA_CCP
00029D 039D CDC403          17      CALL    SYSC0F
0002A0 03A0 B7               4      OR  A
0002A1 03A1 C0              11      RET NZ
                                
0002A2 03A2 210100          10      LD  HL,1
0002A5 03A5 228113          16      LD  (DTA_CCP+14),HL
0002A8 03A8 2D               4      DEC L
0002A9 03A9 229413          16      LD  (DTA_CCP+33),HL
0002AC 03AC 229613          16      LD  (DTA_CCP+35),HL
       03AF                     SETDTA100:
0002AF 03AF 110080          10      LD  DE,DATA
       03B2                     SETDTA:
0002B2 03B2 C5              11      PUSH    BC
0002B3 03B3 D5              11      PUSH    DE
0002B4 03B4 E5              11      PUSH    HL
0002B5 03B5 0E1A             7      LD  C,01AH      ;(BDOS)DTAの設定
0002B7 03B7 CD0500          17      CALL    SYSTEM
0002BA 03BA E1              10      POP HL
0002BB 03BB D1              10      POP DE
0002BC 03BC C1              10      POP BC
0002BD 03BD AF               4      XOR A
0002BE 03BE C9              10      RET
                                
       03BF                     SETDTA1:
0002BF 03BF 118000          10      LD  DE,DTA1
0002C2 03C2 18EE            12      JR  SETDTA
                                
       03C4                     SYSC0F:
0002C4 03C4 0E0F             7      LD  C,00FH      ;(BDOS)ファイルのオープン
       03C6                     SYSTEM0:
0002C6 03C6 CD0500          17      CALL    SYSTEM
0002C9 03C9 B7               4      OR  A
0002CA 03CA C9              10      RET
                                
       03CB                     C_CD:
0002CB 03CB CDF50B          17      CALL    SPCUT
0002CE 03CE 1A               7      LD  A,(DE)
0002CF 03CF FE20             7      CP  020H
0002D1 03D1 DA1606          10      JP  C,PWD
       03D4                     CD1:
0002D4 03D4 0E5A             7      LD  C,5AH       ;(BDOS)_CHDIR カレントディレクトリの変更
0002D6 03D6 C30500          10      JP  SYSTEM
                                
       03D9                     S27DTA_D2:      ;DOS2対応
0002D9 03D9 3ADA11          13      LD  A,(MAJOR_VER)
0002DC 03DC FE02             7      CP  2
0002DE 03DE 3817            12      JR  C,S27DTA
0002E0 03E0 ED4B1B12        20      LD  BC,(HANDLE1)
0002E4 03E4 110080          10      LD  DE,DATA
0002E7 03E7 0E48             7      LD  C,048H      ;(BDOS)ファイルハンドルからの読み出し(_READ)
0002E9 03E9 CDC603          17      CALL    SYSTEM0
0002EC 03EC C8              11      RET Z
0002ED 03ED FEC7             7      CP  0C7H        ;.EOF
0002EF 03EF 2803            12      JR  Z,S27EOF
0002F1 03F1 37               4      SCF
0002F2 03F2 9F               4      SBC A,A
0002F3 03F3 C9              10      RET
       03F4                     S27EOF:
0002F4 03F4 3E01             7      LD  A,1
0002F6 03F6 C9              10      RET
                                
       03F7                     S27DTA:
0002F7 03F7 110100          10      LD  DE,1
0002FA 03FA ED538113        20      LD  (DTA_CCP+14),DE
0002FE 03FE 117313          10      LD  DE,DTA_CCP
       0401                     S27:
000301 0401 0E27             7      LD  C,027H      ;(BDOS)ランダム・ブロック・リード
000303 0403 CD0500          17      CALL    SYSTEM
000306 0406 B7               4      OR  A
000307 0407 C9              10      RET
                                
       0408                     CEXE4:
000308 0408 21AB13          10      LD  HL,FDRV
00030B 040B 117313          10      LD  DE,DTA_CCP
00030E 040E 010900          10      LD  BC,1+8
000311 0411 EDB0                    LDIR
000313 0413 217C13          10      LD  HL,DTA_CCP+9
000316 0416 3643            10      LD  (HL),'C'
000318 0418 23               6      INC HL
000319 0419 364F            10      LD  (HL),'O'
00031B 041B 23               6      INC HL
00031C 041C 364D            10      LD  (HL),'M'
       041E                     C_EXE:
00031E 041E CD9A03          17      CALL    DEFCB
000321 0421 C2EF04          10      JP  NZ,C_BAT
000324 0424 11DA13          10      LD  DE,DATA_COM
000327 0427 CDB203          17      CALL    SETDTA
                                
00032A 042A 2A0600          16      LD  HL,(SYSTEM+1)
00032D 042D 11DA13          10      LD  DE,DATA_COM
000330 0430 ED52            15      SBC HL,DE
                                
000332 0432 CDF703          17      CALL    S27DTA
000335 0435 3D               4      DEC A
000336 0436 37               4      SCF
000337 0437 C0              11      RET NZ
000338 0438 7C               4      LD  A,H
000339 0439 B5               4      OR  L
00033A 043A 37               4      SCF
00033B 043B C8              11      RET Z
00033C 043C 22E904          16      LD  (COMSIZ),HL
                                
00033F 043F 11DA13          10      LD  DE,DATA_COM
000342 0442 CDB203          17      CALL    SETDTA
000345 0445 110000          10      LD  DE,0
       0446                     COMPAT  EQU $-2
000348 0448 CD6408          17      CALL    SETFCB
                                
00034B 044B 210911          10      LD  HL,N_APPEND
00034E 044E 112212          10      LD  DE,PATH_CCP
000351 0451 0640             7      LD  B,PATHX
000353 0453 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000355 0455 CD0500          17      CALL    SYSTEM
000358 0458 3A2212          13      LD  A,(PATH_CCP)
00035B 045B B7               4      OR  A
00035C 045C 201D            12      JR  NZ,COM_ENV1
00035E 045E 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
000360 0460 CD0500          17      CALL    SYSTEM
000363 0463 C641             7      ADD A,'A'
000365 0465 322212          13      LD  (PATH_CCP),A
000368 0468 3E3A             7      LD  A,':'
00036A 046A 322312          13      LD  (PATH_CCP+1),A
00036D 046D 3E5C             7      LD  A,05CH      ;\
00036F 046F 322412          13      LD  (PATH_CCP+2),A
000372 0472 47               4      LD  B,A     ;ドライブ
000373 0473 112412          10      LD  DE,PATH_CCP+2
000376 0476 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
000378 0478 CD0500          17      CALL    SYSTEM
       047B                     COM_ENV1:
00037B 047B 117313          10      LD  DE,DTA_CCP
00037E 047E 216513          10      LD  HL,DOS2NAME
000381 0481 CD270A          17      CALL    FCB2FNAME
000384 0484 112212          10      LD  DE,PATH_CCP
000387 0487 216713          10      LD  HL,DOS2NAME+2
       048A                     COM_ENV2:
00038A 048A 1A               7      LD  A,(DE)
00038B 048B B7               4      OR  A
00038C 048C 2803            12      JR  Z,COM_ENV3
00038E 048E 13               6      INC DE
00038F 048F 18F9            12      JR  COM_ENV2
       0491                     COM_ENV3:
000391 0491 1B               6      DEC DE
000392 0492 1A               7      LD  A,(DE)
000393 0493 13               6      INC DE
000394 0494 FE5C             7      CP  05CH
000396 0496 2804            12      JR  Z,COM_ENV4
000398 0498 3E5C             7      LD  A,05CH
00039A 049A 12               7      LD  (DE),A
00039B 049B 13               6      INC DE
       049C                     COM_ENV4:
00039C 049C 7E               7      LD  A,(HL)
00039D 049D 23               6      INC HL
00039E 049E 12               7      LD  (DE),A
00039F 049F 13               6      INC DE
0003A0 04A0 B7               4      OR  A
0003A1 04A1 20F9            12      JR  NZ,COM_ENV4
                                
0003A3 04A3 21C211          10      LD  HL,N_PROGRAM
0003A6 04A6 112212          10      LD  DE,PATH_CCP
0003A9 04A9 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003AB 04AB CD0500          17      CALL    SYSTEM
                                
0003AE 04AE 21CA11          10      LD  HL,N_PARAMETERS
0003B1 04B1 118100          10      LD  DE,DTA1+1
0003B4 04B4 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003B6 04B6 CD0500          17      CALL    SYSTEM
                                
0003B9 04B9 210911          10      LD  HL,N_APPEND
0003BC 04BC 111011          10      LD  DE,V_APPEND
0003BF 04BF 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0003C1 04C1 CD0500          17      CALL    SYSTEM
                                
0003C4 04C4 0E60             7      LD  C,60H       ;(BDOS)子プロセスの起動
0003C6 04C6 CD0500          17      CALL    SYSTEM
0003C9 04C9 B7               4      OR  A
0003CA 04CA 2004            12      JR  NZ,COMP1
0003CC 04CC 78               4      LD  A,B
0003CD 04CD 32D913          13      LD  (PROCESS),A
       04D0                     COMP1:
0003D0 04D0 AF               4      XOR A
0003D1 04D1 67               4      LD  H,A
0003D2 04D2 6F               4      LD  L,A ;HL=0x0000
0003D3 04D3 32C4F7          13      LD  (TRCFLG),A
0003D6 04D6 F3               4      DI
0003D7 04D7 ED7B0600        20      LD  SP,(SYSTEM+1)
0003DB 04DB E5              11      PUSH    HL
0003DC 04DC 21EDB0          10      LD  HL,0B0EDH   ;LDIR
0003DF 04DF 22FE00          16      LD  (000FEH),HL
0003E2 04E2 21DA13          10      LD  HL,DATA_COM
0003E5 04E5 110001          10      LD  DE,00100H
0003E8 04E8 010000          10      LD  BC,0
       04E9                     COMSIZ  EQU $-2
0003EB 04EB FB               4      EI
0003EC 04EC C3FE00          10      JP  000FEH
                                
       04EF                     C_BAT:
0003EF 04EF 217C13          10      LD  HL,DTA_CCP+9
0003F2 04F2 3642            10      LD  (HL),'B'
0003F4 04F4 23               6      INC HL
0003F5 04F5 3641            10      LD  (HL),'A'
0003F7 04F7 23               6      INC HL
0003F8 04F8 3654            10      LD  (HL),'T'
                                
0003FA 04FA CD9A03          17      CALL    DEFCB
0003FD 04FD C0              11      RET NZ
                                
0003FE 04FE 217313          10      LD  HL,DTA_CCP
000401 0501 7E               7      LD  A,(HL)
000402 0502 B7               4      OR  A
000403 0503 2009            12      JR  NZ,CBAT_DS
000405 0505 E5              11      PUSH    HL
000406 0506 0E19             7      LD  C,019H      ;(BDOS)カレントドライブ番号の獲得(_CURDRV)
000408 0508 CD0500          17      CALL    SYSTEM
00040B 050B E1              10      POP HL
00040C 050C 3C               4      INC A
00040D 050D 77               7      LD  (HL),A
       050E                     CBAT_DS:
00040E 050E ED5BD213        20      LD  DE,(FCB_BAT)
000412 0512 012500          10      LD  BC,37
000415 0515 EDB0                    LDIR
       0517                     C_BAT1:
000417 0517 CDAF03          17      CALL    SETDTA100
00041A 051A CD5805          17      CALL    FGETC_BAT
00041D 051D 218100          10      LD  HL,DTA1+1
000420 0520 202A            12      JR  NZ,END_BATCH
000422 0522 FE21             7      CP  021H        ;スペースや改行など制御文字を飛ばす
000424 0524 38F1            12      JR  C,C_BAT1
000426 0526 3620            10      LD  (HL),' '
000428 0528 23               6      INC HL
       0529                     C_BAT2:
000429 0529 77               7      LD  (HL),A
00042A 052A 23               6      INC HL
00042B 052B 7D               4      LD  A,L
00042C 052C 3C               4      INC A       ;L==0FFH
00042D 052D 2809            12      JR  Z,RUN_BATCH
00042F 052F CD5805          17      CALL    FGETC_BAT
000432 0532 2004            12      JR  NZ,RUN_BATCH
000434 0534 FE20             7      CP  020H
000436 0536 30F1            12      JR  NC,C_BAT2
       0538                     RUN_BATCH:
000438 0538 7D               4      LD  A,L
000439 0539 D67F             7      SUB DTA1-1
00043B 053B 328000          13      LD  (DTA1),A
00043E 053E FE04             7      CP  4
000440 0540 380A            12      JR  C,END_BATCH
000442 0542 3600            10      LD  (HL),0
000444 0544 3A9BFC          13      LD  A,(INTFLG)
000447 0547 FE03             7      CP  3
000449 0549 C21202          10      JP  NZ,COMMAND2
       054C                     END_BATCH:      ;バッチファイルを閉じる
00044C 054C 2AD213          16      LD  HL,(FCB_BAT)
00044F 054F 3600            10      LD  (HL),0
000451 0551 ED7B0600        20      LD  SP,(SYSTEM+1)
000455 0555 C3C101          10      JP  WSTART
                                
       0558                     FGETC_BAT:
000458 0558 ED5BD213        20      LD  DE,(FCB_BAT)
       055C                     FGETC:              ;1文字ずつ読み込む
00045C 055C E5              11      PUSH    HL      ;Z:成功
00045D 055D 210100          10      LD  HL,1
000460 0560 CD0104          17      CALL    S27
000463 0563 E1              10      POP HL
000464 0564 3A0080          13      LD  A,(DATA)
000467 0567 C9              10      RET
                                
       0568                     C_REM:
000468 0568 AF               4      XOR A
000469 0569 C9              10      RET
                                
       056A                     C_DEL:
00046A 056A CD6408          17      CALL    SETFCB
00046D 056D 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力
00046F 056F CD0500          17      CALL    SYSTEM
000472 0572 0600             7      LD  B,0
000474 0574 3ADA11          13      LD  A,(MAJOR_VER)
000477 0577 FE02             7      CP  2
000479 0579 381E            12      JR  C,CDEL_DOS1
                                
00047B 057B 215C00          10      LD  HL,FCB1
00047E 057E CDCD02          17      CALL    OPEN_D2
000481 0581 37               4      SCF
       0582                     DEL1:
000482 0582 C0              11      RET NZ
000483 0583 3AE911          13      LD  A,(SEARCH_IX+14);   (FIB)属性
000486 0586 CB67             8      BIT 4,A
000488 0588 200A            12      JR  NZ,DEL2
                                
00048A 058A 11DB11          10      LD  DE,SEARCH_IX
00048D 058D 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除(_DELETE)
00048F 058F CDC603          17      CALL    SYSTEM0
000492 0592 37               4      SCF
000493 0593 C0              11      RET NZ
       0594                     DEL2:
000494 0594 CD4303          17      CALL    OPEN2_D2
000497 0597 18E9            12      JR  DEL1
                                
       0599                     CDEL_DOS1:
000499 0599 0E13             7      LD  C,013H
00049B 059B 1811            12      JR  CDEL1       ;(BDOS)ファイルの削除
                                
       059D                     C_REN:
00049D 059D 3ADA11          13      LD  A,(MAJOR_VER)
0004A0 05A0 FE02             7      CP  2
0004A2 05A2 3013            12      JR  NC,REN_DOS2
0004A4 05A4 CD6408          17      CALL    SETFCB
0004A7 05A7 3E10             7      LD  A,010H      ;ディレクトリも対象にする(LSX-Dodgers)
0004A9 05A9 326900          13      LD  (FCB1+13),A ;属性
0004AC 05AC 0E17             7      LD  C,017H      ;(BDOS)ファイル名の変更
       05AE                     CDEL1:
0004AE 05AE 115C00          10      LD  DE,FCB1
       05B1                     REN2:
0004B1 05B1 CD0500          17      CALL    SYSTEM
0004B4 05B4 C6FF             7      ADD A,0FFH
0004B6 05B6 C9              10      RET
                                
       05B7                     REN_DOS2:           ;DOS2のリネーム(ディレクトリ対応)
0004B7 05B7 CDF50B          17      CALL    SPCUT
0004BA 05BA 6B               4      LD  L,E
0004BB 05BB 62               4      LD  H,D
       05BC                     REN_D2_1:
0004BC 05BC 7E               7      LD  A,(HL)
0004BD 05BD FE21             7      CP  020H+1
0004BF 05BF 3803            12      JR  C,REN_D2_2
0004C1 05C1 23               6      INC HL
0004C2 05C2 18F8            12      JR  REN_D2_1
       05C4                     REN_D2_2:
0004C4 05C4 3600            10      LD  (HL),0
0004C6 05C6 23               6      INC HL
0004C7 05C7 0E4E             7      LD  C,04EH      ;(BDOS)ファイルあるいはサブディレクトリ名の変更(_RENAME)
0004C9 05C9 18E6            12      JR  REN2
                                
       05CB                     C_DIR:
0004CB 05CB CD030B          17      CALL    FILEC_D2
0004CE 05CE 21AC13          10      LD  HL,FDRV+1
0004D1 05D1 CDAE0A          17      CALL    CWILD1
0004D4 05D4 3EF1             7      LD  A,0F1H
0004D6 05D6 32B813          13      LD  (FDRV+13),A
0004D9 05D9 CDD902          17      CALL    OPEN1_D2
       05DC                     CDIR1:
0004DC 05DC B7               4      OR  A
0004DD 05DD 2008            12      JR  NZ,PDSKF
0004DF 05DF CD4D06          17      CALL    P_NAME
0004E2 05E2 CD4303          17      CALL    OPEN2_D2
0004E5 05E5 18F5            12      JR  CDIR1
                                
       05E7                     PDSKF:
0004E7 05E7 3AAB13          13      LD  A,(FDRV)
0004EA 05EA 5F               4      LD  E,A
0004EB 05EB 0E1B             7      LD  C,01BH      ;(BDOS)ディスク情報の獲得
0004ED 05ED CD0500          17      CALL    SYSTEM
0004F0 05F0 4F               4      LD  C,A     ;C←1クラスタ辺りの論理セクタ数
0004F1 05F1 C601             7      ADD A,001H
0004F3 05F3 D8              11      RET C       ;Aが0FFHだった場合
0004F4 05F4 3E06             7      LD  A,8-2
       05F6                     PDS1:               ;HL=未使用クラスタの総数
0004F6 05F6 3C               4      INC A
0004F7 05F7 CB19             8      RR  C
0004F9 05F9 30FB            12      JR  NC,PDS1
       05FB                     PDS2:               ;B←論理セクタのサイズの上位8ビット
0004FB 05FB 3C               4      INC A
0004FC 05FC CB18             8      RR  B
0004FE 05FE 30FB            12      JR  NC,PDS2
000500 0600 47               4      LD  B,A
                                
000501 0601 110000          10      LD  DE,0
       0604                     PDS3:
000504 0604 29              11      ADD HL,HL
000505 0605 EB               4      EX  DE,HL
000506 0606 ED6A            15      ADC HL,HL
000508 0608 EB               4      EX  DE,HL
000509 0609 10F9            13      DJNZ    PDS3
       060B                     PDSKF1:
00050B 060B CDDB06          17      CALL    PRDEC_DEHL
00050E 060E 119D10          10      LD  DE,FREE
000511 0611 0E09             7      LD  C,9     ;(BDOS)文字列出力
000513 0613 CD0500          17      CALL    SYSTEM
       0616                     PWD:
000516 0616 CDBB06          17      CALL    PUTDRV
000519 0619 3E5C             7      LD  A,05CH      ;\
00051B 061B CDE60A          17      CALL    MSG_A
       061E                     PDSKF2:             ;MSX-DOS2
00051E 061E 110080          10      LD  DE,DATA
000521 0621 AF               4      XOR A
000522 0622 12               7      LD  (DE),A
000523 0623 3AAB13          13      LD  A,(FDRV)
000526 0626 47               4      LD  B,A     ;ドライブ
000527 0627 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
000529 0629 CD0500          17      CALL    SYSTEM
00052C 062C 210080          10      LD  HL,DATA
                                
00052F 062F CD3706          17      CALL    MSX
000532 0632 1841            12      JR  LTNL
                                
       0634                     MSX1:
000534 0634 CDE60A          17      CALL    MSG_A
       0637                     MSX:
000537 0637 7E               7      LD  A,(HL)
000538 0638 23               6      INC HL
000539 0639 B7               4      OR  A
00053A 063A 20F8            12      JR  NZ,MSX1
00053C 063C C9              10      RET
                                
       063D                     MSXSLT1:
00053D 063D CDE60A          17      CALL    MSG_A
       0640                     MSXSLT:
000540 0640 C5              11      PUSH    BC
000541 0641 E5              11      PUSH    HL
000542 0642 78               4      LD  A,B
000543 0643 CD0C00          17      CALL    RDSLT
000546 0646 E1              10      POP HL
000547 0647 C1              10      POP BC
000548 0648 23               6      INC HL
000549 0649 B7               4      OR  A
00054A 064A 20F1            12      JR  NZ,MSXSLT1
00054C 064C C9              10      RET
                                
       064D                     P_NAME:
00054D 064D 217413          10      LD  HL,DTA_CCP+1
000550 0650 7E               7      LD  A,(HL)
000551 0651 FE2E             7      CP  '.'
000553 0653 C8              11      RET Z
000554 0654 CD3107          17      CALL    FPRNT
000557 0657 3A7F13          13      LD  A,(DTA_CCP+12)
00055A 065A CB67             8      BIT 4,A
00055C 065C 280A            12      JR  Z,DIR3
00055E 065E 11AB10          10      LD  DE,DIRMES
000561 0661 0E09             7      LD  C,9     ;(BDOS)文字列出力
000563 0663 CD0500          17      CALL    SYSTEM
000566 0666 180A            12      JR  DIR6
       0668                     DIR3:
000568 0668 ED5B9213        20      LD  DE,(DTA_CCP+1+01EH)
00056C 066C 2A9013          16      LD  HL,(DTA_CCP+1+01CH)
00056F 066F CDDB06          17      CALL    PRDEC_DEHL
       0672                     DIR6:
000572 0672 CD4D07          17      CALL    PRTTMS
                                
       0675                     LTNL:
000575 0675 1E0D             7      LD  E,00DH
000577 0677 CDC90A          17      CALL    _PRINT
00057A 067A 1E0A             7      LD  E,00AH
00057C 067C C3C90A          10      JP  _PRINT
                                
       067F                     C_PATH:
00057F 067F CDF50B          17      CALL    SPCUT
000582 0682 FE21             7      CP  021H
000584 0684 301C            12      JR  NC,CPATH0
                                
000586 0686 215011          10      LD  HL,N_PATH
000589 0689 115511          10      LD  DE,V_PATH
00058C 068C 0640             7      LD  B,PATHX
00058E 068E 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000590 0690 CD0500          17      CALL    SYSTEM
000593 0693 215511          10      LD  HL,V_PATH
       0696                     CPATHP:
000596 0696 7E               7      LD  A,(HL)
000597 0697 23               6      INC HL
000598 0698 FE20             7      CP  020H
00059A 069A 3F               4      CCF
00059B 069B 30D8            12      JR  NC,LTNL
00059D 069D CDE60A          17      CALL    MSG_A
0005A0 06A0 18F4            12      JR  CPATHP
       06A2                     CPATH0:
0005A2 06A2 215511          10      LD  HL,V_PATH
0005A5 06A5 FE3B             7      CP  ';'
0005A7 06A7 2001            12      JR  NZ,CPATH1
0005A9 06A9 13               6      INC DE
       06AA                     CPATH1:
0005AA 06AA EB               4      EX  DE,HL
0005AB 06AB 014000          10      LD  BC,PATHX
0005AE 06AE EDB0                    LDIR
                                
0005B0 06B0 215011          10      LD  HL,N_PATH
0005B3 06B3 115511          10      LD  DE,V_PATH
0005B6 06B6 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
0005B8 06B8 C30500          10      JP  SYSTEM
                                
       06BB                     PUTDRV:
0005BB 06BB 3AAB13          13      LD  A,(FDRV)
0005BE 06BE B7               4      OR  A
0005BF 06BF 200C            12      JR  NZ,PUTDRV1
0005C1 06C1 C5              11      PUSH    BC
0005C2 06C2 D5              11      PUSH    DE
0005C3 06C3 E5              11      PUSH    HL
0005C4 06C4 0E19             7      LD  C,019H
0005C6 06C6 CD0500          17      CALL    SYSTEM
0005C9 06C9 E1              10      POP HL
0005CA 06CA D1              10      POP DE
0005CB 06CB C1              10      POP BC
0005CC 06CC 3C               4      INC A
       06CD                     PUTDRV1:
0005CD 06CD C640             7      ADD A,'A'-1
0005CF 06CF CDE60A          17      CALL    MSG_A
0005D2 06D2 3E3A             7      LD  A,':'
       06D4                     MSG_AR:
0005D4 06D4 C3E60A          10      JP  MSG_A
                                
       06D7                     PRDEC_HL:
0005D7 06D7 AF               4      XOR A
       06D8                     PRDEC_AHL:
0005D8 06D8 5F               4      LD  E,A
0005D9 06D9 1600             7      LD  D,0
       06DB                     PRDEC_DEHL:
0005DB 06DB 3E02             7      LD  A,2
0005DD 06DD 322607          13      LD  (DEC6+1),A
0005E0 06E0 AF               4      XOR A
0005E1 06E1 E5              11      PUSH    HL
0005E2 06E2 21A513          10      LD  HL,DECBF
0005E5 06E5 0605             7      LD  B,5
0005E7 06E7 CDBC0B          17      CALL    FILL_MEMORY
0005EA 06EA E1              10      POP HL
                                
0005EB 06EB 0E20             7      LD  C,32
       06ED                     DEC1:
0005ED 06ED 29              11      ADD HL,HL
0005EE 06EE EB               4      EX  DE,HL
0005EF 06EF ED6A            15      ADC HL,HL
0005F1 06F1 EB               4      EX  DE,HL
0005F2 06F2 E5              11      PUSH    HL
0005F3 06F3 21A913          10      LD  HL,DECBF+4
0005F6 06F6 0605             7      LD  B,5
       06F8                     DEC2:
0005F8 06F8 7E               7      LD  A,(HL)
0005F9 06F9 8F               4      ADC A,A
0005FA 06FA 27               4      DAA
0005FB 06FB 77               7      LD  (HL),A
0005FC 06FC 2B               6      DEC HL
0005FD 06FD 10F9            13      DJNZ    DEC2
0005FF 06FF E1              10      POP HL
000600 0700 0D               4      DEC C
000601 0701 20EA            12      JR  NZ,DEC1
                                
000603 0703 21A513          10      LD  HL,DECBF
000606 0706 3E20             7      LD  A,020H
000608 0708 0604             7      LD  B,4
       070A                     DEC3:
00060A 070A CD1707          17      CALL    DEC4
00060D 070D CD1707          17      CALL    DEC4
000610 0710 23               6      INC HL
000611 0711 10F7            13      DJNZ    DEC3
       0713                     DECX:
000613 0713 CD1707          17      CALL    DEC4
000616 0716 AF               4      XOR A
       0717                     DEC4:
000617 0717 ED6F            18      RLD
000619 0719 FE20             7      CP  020H
00061B 071B 2808            12      JR  Z,DEC6
00061D 071D F630             7      OR  030H
       071F                     DEC5:
00061F 071F 18B3            12      JR  MSG_AR
       0721                     DEC7:
000621 0721 3E20             7      LD  A,020H
000623 0723 18AF            12      JR  MSG_AR
       0725                     DEC6:
000625 0725 3E02             7      LD  A,2
000627 0727 B7               4      OR  A
000628 0728 28F7            12      JR  Z,DEC7
00062A 072A 3D               4      DEC A
00062B 072B 322607          13      LD  (DEC6+1),A
00062E 072E 3E20             7      LD  A,020H
000630 0730 C9              10      RET
                                
       0731                     FPRNT:
000631 0731 0608             7      LD  B,8
000633 0733 CD4207          17      CALL    P_N1
000636 0736 7E               7      LD  A,(HL)
000637 0737 FE20             7      CP  020H
000639 0739 2802            12      JR  Z,FPR1
00063B 073B 3E2E             7      LD  A,'.'
       073D                     FPR1:
00063D 073D CDE60A          17      CALL    MSG_A
000640 0740 0603             7      LD  B,3
                                
       0742                     P_N1:
000642 0742 7E               7      LD  A,(HL)
000643 0743 CD140C          17      CALL    CAP3
000646 0746 CDE60A          17      CALL    MSG_A
000649 0749 23               6      INC HL
00064A 074A 10F6            13      DJNZ    P_N1
00064C 074C C9              10      RET
                                
       074D                     PRTTMS:
00064D 074D 3E20             7      LD  A,020H
00064F 074F CDE60A          17      CALL    MSG_A
                                
000652 0752 2A8C13          16      LD  HL,(DTA_CCP+1+24)
000655 0755 7D               4      LD  A,L
000656 0756 B7               4      OR  A
000657 0757 C8              11      RET Z
000658 0758 CB3C             8      SRL H
00065A 075A 17               4      RLA
00065B 075B 17               4      RLA
00065C 075C 17               4      RLA
00065D 075D 17               4      RLA
00065E 075E E60F             7      AND 00FH
000660 0760 57               4      LD  D,A
000661 0761 DD219A11        14      LD  IX,V_DATE
       0765                     PRTTMS1:
000665 0765 DD7E00          19      LD  A,(IX+0)
000668 0768 B7               4      OR  A
000669 0769 2808            12      JR  Z,PRTTMS2
00066B 076B CDEE07          17      CALL    PR_DATE
00066E 076E CD5908          17      CALL    PR_DATE_SPLITER
000671 0771 18F2            12      JR  PRTTMS1
       0773                     PRTTMS2:
                                
000673 0773 CDF30C          17      CALL    GET_WIDTH
000676 0776 FE21             7      CP  32+1
000678 0778 3005            12      JR  NC,SHOW_TIME
00067A 077A 3E1D             7      LD  A,01DH
00067C 077C C3E60A          10      JP  MSG_A
       077F                     SHOW_TIME:
00067F 077F 2A8A13          16      LD  HL,(DTA_CCP+1+22)
                                
000682 0782 3E20             7      LD  A,020H
000684 0784 CDE60A          17      CALL    MSG_A
000687 0787 7C               4      LD  A,H
000688 0788 65               4      LD  H,L
000689 0789 1F               4      RRA
00068A 078A CB1D             8      RR  L
00068C 078C 1F               4      RRA
00068D 078D CB1D             8      RR  L
00068F 078F 1F               4      RRA
000690 0790 CB1D             8      RR  L
000692 0792 E61F             7      AND 01FH
000694 0794 4F               4      LD  C,A
000695 0795 3ABF11          13      LD  A,(V_TIME)
000698 0798 FE31             7      CP  '1'
00069A 079A 79               4      LD  A,C
00069B 079B 200B            12      JR  NZ,TIME24
00069D 079D FE0C             7      CP  12
00069F 079F 3802            12      JR  C,TIME12
0006A1 07A1 D60C             7      SUB 12
       07A3                     TIME12:
0006A3 07A3 B7               4      OR  A
0006A4 07A4 2002            12      JR  NZ,TIME24
0006A6 07A6 C60C             7      ADD A,12
       07A8                     TIME24:
0006A8 07A8 C5              11      PUSH    BC
0006A9 07A9 CDD907          17      CALL    PRDEC_A
0006AC 07AC 3E3A             7      LD  A,':'
0006AE 07AE CDE60A          17      CALL    MSG_A
0006B1 07B1 7D               4      LD  A,L
0006B2 07B2 0F               4      RRCA
0006B3 07B3 0F               4      RRCA
0006B4 07B4 E63F             7      AND 03FH
0006B6 07B6 CDD907          17      CALL    PRDEC_A
                                
0006B9 07B9 3E3A             7      LD  A,':'
0006BB 07BB CDE60A          17      CALL    MSG_A
0006BE 07BE 7C               4      LD  A,H
0006BF 07BF E61F             7      AND 01FH
0006C1 07C1 87               4      ADD A,A
0006C2 07C2 CDD907          17      CALL    PRDEC_A
                                
0006C5 07C5 3ABF11          13      LD  A,(V_TIME)
0006C8 07C8 FE31             7      CP  '1'
0006CA 07CA C1              10      POP BC
0006CB 07CB C0              11      RET NZ
0006CC 07CC 79               4      LD  A,C
0006CD 07CD 1E61             7      LD  E,'a'
0006CF 07CF FE0C             7      CP  12
0006D1 07D1 DAC90A          10      JP  C,_PRINT
0006D4 07D4 1E70             7      LD  E,'p'
0006D6 07D6 C3C90A          10      JP  _PRINT
                                
                                ;   PRINT10
                                
       07D9                     PRDEC_A:
0006D9 07D9 E5              11      PUSH    HL
0006DA 07DA 0608             7      LD  B,8
0006DC 07DC 4F               4      LD  C,A
0006DD 07DD AF               4      XOR A
       07DE                     PRTA1:
0006DE 07DE CB01             8      RLC C
0006E0 07E0 8F               4      ADC A,A
0006E1 07E1 27               4      DAA
0006E2 07E2 10FA            13      DJNZ    PRTA1
0006E4 07E4 21A513          10      LD  HL,DECBF
0006E7 07E7 77               7      LD  (HL),A
0006E8 07E8 AF               4      XOR A
0006E9 07E9 CD1307          17      CALL    DECX
0006EC 07EC E1              10      POP HL
0006ED 07ED C9              10      RET
                                
       07EE                     PR_DATE:
0006EE 07EE DD7E00          19      LD  A,(IX+0)
0006F1 07F1 FE20             7      CP  020H
0006F3 07F3 D8              11      RET C
0006F4 07F4 CD080C          17      CALL    CAP
0006F7 07F7 FE44             7      CP  'D'
0006F9 07F9 2848            12      JR  Z,PR_DAY
0006FB 07FB FE4D             7      CP  'M'
0006FD 07FD 2820            12      JR  Z,PR_MONTH
0006FF 07FF FE59             7      CP  'Y'
000701 0801 2046            12      JR  NZ,PR_DATE1
000703 0803 4F               4      LD  C,A
000704 0804 DD7E02          19      LD  A,(IX+2)
000707 0807 CD080C          17      CALL    CAP
00070A 080A B9               4      CP  C
00070B 080B 200A            12      JR  NZ,YEAR2
00070D 080D 7C               4      LD  A,H     ;YEAR
00070E 080E C6EC             7      ADD A,80+256-100
000710 0810 3E13             7      LD  A,19
000712 0812 CE00             7      ADC A,0
000714 0814 CDD907          17      CALL    PRDEC_A     ;年4桁
       0817                     YEAR2:
000717 0817 7C               4      LD  A,H     ;YEAR
000718 0818 C650             7      ADD A,80
00071A 081A CDD907          17      CALL    PRDEC_A
00071D 081D 182A            12      JR  PR_DATE1
       081F                     PR_MONTH:
00071F 081F 4F               4      LD  C,A
000720 0820 DD7E02          19      LD  A,(IX+2)
000723 0823 CD080C          17      CALL    CAP
000726 0826 B9               4      CP  C
000727 0827 2014            12      JR  NZ,MONTH2
000729 0829 E5              11      PUSH    HL      ;月を文字列で表示 Jan等
00072A 082A D5              11      PUSH    DE
00072B 082B 7A               4      LD  A,D
00072C 082C 3D               4      DEC A
00072D 082D 87               4      ADD A,A
00072E 082E 87               4      ADD A,A
00072F 082F 21D910          10      LD  HL,S_MONTH
000732 0832 1600             7      LD  D,0
000734 0834 5F               4      LD  E,A
000735 0835 19              11      ADD HL,DE
000736 0836 CD3706          17      CALL    MSX
000739 0839 D1              10      POP DE
00073A 083A E1              10      POP HL
00073B 083B 180C            12      JR  PR_DATE1
       083D                     MONTH2:
00073D 083D 7A               4      LD  A,D     ;月を数字で表示
00073E 083E CDD907          17      CALL    PRDEC_A
000741 0841 1806            12      JR  PR_DATE1
       0843                     PR_DAY:
000743 0843 7D               4      LD  A,L
000744 0844 E61F             7      AND 01FH
000746 0846 CDD907          17      CALL    PRDEC_A
       0849                     PR_DATE1:
000749 0849 DD23            10      INC IX
00074B 084B DD7E00          19      LD  A,(IX+0)
00074E 084E CD080C          17      CALL    CAP
000751 0851 FE41             7      CP  'A'
000753 0853 D8              11      RET C
000754 0854 FE5B             7      CP  'Z'+1
000756 0856 38F1            12      JR  C,PR_DATE1
000758 0858 C9              10      RET
       0859                     PR_DATE_SPLITER:
000759 0859 DD7E00          19      LD  A,(IX+0)
00075C 085C FE20             7      CP  020H
00075E 085E D8              11      RET C
00075F 085F DD23            10      INC IX
000761 0861 C3E60A          10      JP  MSG_A
                                
       0864                     SETFCB:
000764 0864 CDF50B          17      CALL    SPCUT
000767 0867 1A               7      LD  A,(DE)
000768 0868 FE20             7      CP  020H
00076A 086A 3801            12      JR  C,SETFCBA
00076C 086C 1B               6      DEC DE
       086D                     SETFCBA:
00076D 086D D5              11      PUSH    DE
00076E 086E 215C00          10      LD  HL,FCB1
000771 0871 115D00          10      LD  DE,FCB1+1
000774 0874 012300          10      LD  BC,00023H
000777 0877 70               7      LD  (HL),B      ;B=0
000778 0878 EDB0                    LDIR
00077A 087A D1              10      POP DE
00077B 087B D5              11      PUSH    DE
00077C 087C 215C00          10      LD  HL,FCB1
00077F 087F DD21A212        14      LD  IX,PATH_FN1
000783 0883 CD990C          17      CALL    _SYS29      ;ファイル名の解析
000786 0886 216C00          10      LD  HL,FCB2
000789 0889 DD21E212        14      LD  IX,PATH_FN2
00078D 088D CD990C          17      CALL    _SYS29      ;ファイル名の解析
000790 0890 E1              10      POP HL
000791 0891 010050          10      LD  BC,05000H
000794 0894 118100          10      LD  DE,00081H
       0897                     SETFCB1:
000797 0897 7E               7      LD  A,(HL)
000798 0898 23               6      INC HL
000799 0899 FE20             7      CP  020H
00079B 089B 3805            12      JR  C,SETFCB2
00079D 089D 12               7      LD  (DE),A
00079E 089E 13               6      INC DE
00079F 089F 0C               4      INC C
0007A0 08A0 10F5            13      DJNZ    SETFCB1
       08A2                     SETFCB2:
0007A2 08A2 79               4      LD  A,C
0007A3 08A3 328000          13      LD  (DTA1),A
0007A6 08A6 04               4      INC B
0007A7 08A7 AF               4      XOR A
       08A8                     SETFCB3:
0007A8 08A8 12               7      LD  (DE),A
0007A9 08A9 13               6      INC DE
0007AA 08AA 10FC            13      DJNZ    SETFCB3
0007AC 08AC C9              10      RET
                                
       08AD                     C_COPY:
0007AD 08AD CD6408          17      CALL    SETFCB
0007B0 08B0 3ADA11          13      LD  A,(MAJOR_VER)
0007B3 08B3 FE02             7      CP  2
0007B5 08B5 380D            12      JR  C,COPYI0
0007B7 08B7 CD060D          17      CALL    IS_FOLDER_FN2
0007BA 08BA 3808            12      JR  C,COPYI0
0007BC 08BC 21AC13          10      LD  HL,FDRV+1
0007BF 08BF 060B             7      LD  B,8+3
0007C1 08C1 CDBA0B          17      CALL    FILE10
       08C4                     COPYI0:
0007C4 08C4 3AAB13          13      LD  A,(FDRV)
0007C7 08C7 47               4      LD  B,A
0007C8 08C8 B7               4      OR  A
0007C9 08C9 200B            12      JR  NZ,COPYI1
0007CB 08CB C5              11      PUSH    BC
0007CC 08CC 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
0007CE 08CE CD0500          17      CALL    SYSTEM
0007D1 08D1 3C               4      INC A
0007D2 08D2 32AB13          13      LD  (FDRV),A
0007D5 08D5 C1              10      POP BC
       08D6                     COPYI1:
0007D6 08D6 C640             7      ADD A,040H
0007D8 08D8 322213          13      LD  (CUR_DRV),A
0007DB 08DB 112513          10      LD  DE,CUR_PATH
0007DE 08DE 0E59             7      LD  C,059H      ;(BDOS)カレントディレクトリの獲得(_GETCD)
0007E0 08E0 CD0500          17      CALL    SYSTEM
0007E3 08E3 CDF508          17      CALL    COPYSUB
       08E6                     RES_CUR_PATH:
0007E6 08E6 112213          10      LD  DE,CUR_DRV
       08E9                     SET_CUR_PATH:
0007E9 08E9 F5              11      PUSH    AF
0007EA 08EA 3AAB13          13      LD  A,(FDRV)
0007ED 08ED 47               4      LD  B,A
0007EE 08EE 0E5A             7      LD  C,05AH      ;(BDOS)カレントディレクトリの変更(_CHDIR)
0007F0 08F0 CD0500          17      CALL    SYSTEM
0007F3 08F3 F1              10      POP AF
0007F4 08F4 C9              10      RET
       08F5                     COPYSUB:
0007F5 08F5 11D113          10      LD  DE,ZERO
0007F8 08F8 CD290B          17      CALL    FILEC2
0007FB 08FB 216C00          10      LD  HL,FCB2
0007FE 08FE CDDD0C          17      CALL    S29X1
                                
000801 0901 3E10             7      LD  A,010H
000803 0903 326900          13      LD  (FCB1+13),A
000806 0906 216D00          10      LD  HL,FCB2+1
000809 0909 CDAE0A          17      CALL    CWILD1
       090C                     COPY0:
00080C 090C CDAB0A          17      CALL    CWILD
00080F 090F 215C00          10      LD  HL,FCB1
000812 0912 CDCD02          17      CALL    OPEN_D2
000815 0915 37               4      SCF
       0916                     COPY1:
000816 0916 C0              11      RET NZ
000817 0917 CD5903          17      CALL    DEFCB_D2
                                
00081A 091A 3A7F13          13      LD  A,(DTA_CCP+12)
00081D 091D CB67             8      BIT 4,A
00081F 091F 2821            12      JR  Z,COPY1A
                                
000821 0921 215D00          10      LD  HL,FCB1+1
000824 0924 CD410C          17      CALL    CHKWILD
000827 0927 3811            12      JR  C,COPY9
                                
000829 0929 3E20             7      LD  A,020H
00082B 092B 325D00          13      LD  (FCB1+1),A
00082E 092E 2A8D13          16      LD  HL,(DTA_CCP+26)
000831 0931 23               6      INC HL
000832 0932 226A00          16      LD  (FCB1+14),HL
000835 0935 18D5            12      JR  COPY0
                                
       0937                     COPY8:
000837 0937 CDFC0D          17      CALL    SHOW_OK
       093A                     COPY9:
00083A 093A CDE608          17      CALL    RES_CUR_PATH
00083D 093D CD4303          17      CALL    OPEN2_D2
000840 0940 18D4            12      JR  COPY1
                                
       0942                     COPY1A:
000842 0942 216C00          10      LD  HL,FCB2
000845 0945 11AB13          10      LD  DE,FDRV
000848 0948 017513          10      LD  BC,DTA_CCP+2
00084B 094B EDA0            16      LDI
00084D 094D 3E0B             7      LD  A,11
       094F                     COPY2:
00084F 094F F5              11      PUSH    AF
000850 0950 7E               7      LD  A,(HL)
000851 0951 FE3F             7      CP  '?'
000853 0953 2001            12      JR  NZ,COPY3
000855 0955 0A               7      LD  A,(BC)
       0956                     COPY3:
000856 0956 12               7      LD  (DE),A
000857 0957 03               6      INC BC
000858 0958 13               6      INC DE
000859 0959 23               6      INC HL
00085A 095A F1              10      POP AF
00085B 095B 3D               4      DEC A
00085C 095C 20F1            12      JR  NZ,COPY2
00085E 095E 010500          10      LD  BC,16-11
000861 0961 EDB0                    LDIR
       0963                     PUTNAME:
000863 0963 215D00          10      LD  HL,FCB1+1
000866 0966 CD410C          17      CALL    CHKWILD
000869 0969 300B            12      JR  NC,PUTN1
00086B 096B 21AC13          10      LD  HL,FDRV+1
00086E 096E CD3107          17      CALL    FPRNT
000871 0971 3E20             7      LD  A,020H
000873 0973 CDE60A          17      CALL    MSG_A
       0976                     PUTN1:
000876 0976 11E212          10      LD  DE,PATH_FN2
000879 0979 CDE908          17      CALL    SET_CUR_PATH
                                
00087C 097C 11AB13          10      LD  DE,FDRV
00087F 097F 0E16             7      LD  C,016H      ;(BDOS)ファイルの作成
000881 0981 CDC603          17      CALL    SYSTEM0
000884 0984 C2250A          10      JP  NZ,COPYE2
000887 0987 67               4      LD  H,A     ;A=0
000888 0988 6F               4      LD  L,A
000889 0989 22CC13          16      LD  (FDRV+33),HL    ;(FCB)ランダム・レコード
00088C 098C 22CE13          16      LD  (FDRV+35),HL
00088F 098F 2C               4      INC L       ;HL=1
000890 0990 22B913          16      LD  (FDRV+14),HL    ;(FCB)レコード・サイズ
       0993                     COPY6:
000893 0993 CDBD0A          17      CALL    BUFSIZ
000896 0996 CDD903          17      CALL    S27DTA_D2
000899 0999 47               4      LD  B,A
00089A 099A 3C               4      INC A
00089B 099B CA140A          10      JP  Z,COPYE
00089E 099E 7C               4      LD  A,H
00089F 099F B5               4      OR  L
0008A0 09A0 280F            12      JR  Z,COPY7
0008A2 09A2 11AB13          10      LD  DE,FDRV
0008A5 09A5 C5              11      PUSH    BC
0008A6 09A6 0E26             7      LD  C,026H      ;(BDOS)ランダム・ブロック・ライト
0008A8 09A8 CD0500          17      CALL    SYSTEM
0008AB 09AB C1              10      POP BC
0008AC 09AC B7               4      OR  A
0008AD 09AD 2065            12      JR  NZ,COPYE
0008AF 09AF 10E2            13      DJNZ    COPY6
       09B1                     COPY7:
0008B1 09B1 3ADA11          13      LD  A,(MAJOR_VER)
0008B4 09B4 FE02             7      CP  2
0008B6 09B6 3011            12      JR  NC,COPY7_MSX2   ;DOS2はFCBの仕様が違う
0008B8 09B8 3A8013          13      LD  A,(DTA_CCP+13)  ;(FCB)属性(アトリビュート)
0008BB 09BB 32B813          13      LD  (FDRV+13),A ;(FCB)属性(アトリビュート)
0008BE 09BE 218713          10      LD  HL,DTA_CCP+20
0008C1 09C1 11BF13          10      LD  DE,FDRV+20  ;(FCB)更新日時
0008C4 09C4 010400          10      LD  BC,4
0008C7 09C7 EDB0                    LDIR
       09C9                     COPY7_MSX2:
0008C9 09C9 11AB13          10      LD  DE,FDRV
0008CC 09CC 0E10             7      LD  C,010H      ;(BDOS)ファイルのクローズ
0008CE 09CE CDC603          17      CALL    SYSTEM0
                                
0008D1 09D1 2041            12      JR  NZ,COPYE
0008D3 09D3 3ADA11          13      LD  A,(MAJOR_VER)
0008D6 09D6 FE02             7      CP  2
0008D8 09D8 3837            12      JR  C,COPY_DOS2DT
                                
0008DA 09DA ED4B1B12        20      LD  BC,(HANDLE1)
0008DE 09DE 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
0008E0 09E0 CD0500          17      CALL    SYSTEM
                                
0008E3 09E3 11E212          10      LD  DE,PATH_FN2
0008E6 09E6 CDE908          17      CALL    SET_CUR_PATH
                                
0008E9 09E9 11AB13          10      LD  DE,FDRV
0008EC 09EC 216513          10      LD  HL,DOS2NAME
0008EF 09EF CD270A          17      CALL    FCB2FNAME
                                
0008F2 09F2 3AE911          13      LD  A,(SEARCH_IX+14);   (FIB)属性
0008F5 09F5 6F               4      LD  L,A
0008F6 09F6 116513          10      LD  DE,DOS2NAME
0008F9 09F9 3E01             7      LD  A,1
0008FB 09FB 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
0008FD 09FD CDC603          17      CALL    SYSTEM0
                                
000900 0A00 DD2AEA11        20      LD  IX,(SEARCH_IX+15)   ;(FIB)更新時間
000904 0A04 2AEC11          16      LD  HL,(SEARCH_IX+17)   ;(FIB)更新日
000907 0A07 116513          10      LD  DE,DOS2NAME
00090A 0A0A 3E01             7      LD  A,1
00090C 0A0C 0E51             7      LD  C,51H       ;(BDOS)_FTIME ファイルの日付および時刻の獲得・設定
00090E 0A0E CDC603          17      CALL    SYSTEM0
       0A11                     COPY_DOS2DT:
000911 0A11 C33709          10      JP  COPY8
                                
       0A14                     COPYE:
000914 0A14 ED4B1B12        20      LD  BC,(HANDLE1)
000918 0A18 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
00091A 0A1A CD0500          17      CALL    SYSTEM
00091D 0A1D 11AB13          10      LD  DE,FDRV
000920 0A20 0E13             7      LD  C,013H      ;(BDOS)ファイルの削除
000922 0A22 CD0500          17      CALL    SYSTEM
       0A25                     COPYE2:
000925 0A25 37               4      SCF
000926 0A26 C9              10      RET
                                
       0A27                     FCB2FNAME:
000927 0A27 1A               7      LD  A,(DE)
000928 0A28 13               6      INC DE
000929 0A29 C640             7      ADD A,040H
00092B 0A2B 77               7      LD  (HL),A
00092C 0A2C 23               6      INC HL
00092D 0A2D 363A            10      LD  (HL),':'
00092F 0A2F 23               6      INC HL
                                
000930 0A30 0608             7      LD  B,8
       0A32                     FCB2FNAME1:
000932 0A32 1A               7      LD  A,(DE)
000933 0A33 FE21             7      CP  020H+1
000935 0A35 3807            12      JR  C,FCB2FNAME2
000937 0A37 13               6      INC DE
000938 0A38 77               7      LD  (HL),A
000939 0A39 23               6      INC HL
00093A 0A3A 10F6            13      DJNZ    FCB2FNAME1
00093C 0A3C 1803            12      JR  FCB2FNAME3
       0A3E                     FCB2FNAME2:
00093E 0A3E 13               6      INC DE
00093F 0A3F 10FD            13      DJNZ    FCB2FNAME2
       0A41                     FCB2FNAME3:
000941 0A41 1A               7      LD  A,(DE)
000942 0A42 FE21             7      CP  020H+1
000944 0A44 380F            12      JR  C,FCB2FNAME5
000946 0A46 362E            10      LD  (HL),'.'
000948 0A48 23               6      INC HL
000949 0A49 0603             7      LD  B,3
       0A4B                     FCB2FNAME4:
00094B 0A4B 1A               7      LD  A,(DE)
00094C 0A4C 13               6      INC DE
00094D 0A4D FE21             7      CP  020H+1
00094F 0A4F 3804            12      JR  C,FCB2FNAME5
000951 0A51 77               7      LD  (HL),A
000952 0A52 23               6      INC HL
000953 0A53 10F6            13      DJNZ    FCB2FNAME4
       0A55                     FCB2FNAME5:
000955 0A55 3600            10      LD  (HL),0
000957 0A57 C9              10      RET
                                
       0A58                     C_TYPE:
000958 0A58 CD6408          17      CALL    SETFCB
00095B 0A5B 215C00          10      LD  HL,FCB1
00095E 0A5E CDCD02          17      CALL    OPEN_D2
000961 0A61 37               4      SCF
000962 0A62 C0              11      RET NZ
000963 0A63 CD680A          17      CALL    TYPE1
000966 0A66 AF               4      XOR A
000967 0A67 C9              10      RET
       0A68                     TYPE1:
000968 0A68 C0              11      RET NZ
000969 0A69 CD5903          17      CALL    DEFCB_D2
00096C 0A6C 3E1A             7      LD  A,01AH
00096E 0A6E CDE60A          17      CALL    MSG_A
       0A71                     TYPE2:
000971 0A71 CDBD0A          17      CALL    BUFSIZ
000974 0A74 CDD903          17      CALL    S27DTA_D2
000977 0A77 C6FE             7      ADD A,0FEH
000979 0A79 D8              11      RET C
00097A 0A7A 7C               4      LD  A,H
00097B 0A7B B5               4      OR  L
00097C 0A7C 281A            12      JR  Z,TYPEE
00097E 0A7E 010080          10      LD  BC,DATA
       0A81                     TYPE3:
000981 0A81 0A               7      LD  A,(BC)
000982 0A82 03               6      INC BC
000983 0A83 FE1A             7      CP  01AH
000985 0A85 2811            12      JR  Z,TYPEE
000987 0A87 5F               4      LD  E,A
000988 0A88 C5              11      PUSH    BC
000989 0A89 E5              11      PUSH    HL
00098A 0A8A 0E02             7      LD  C,2     ;(BDOS)コンソール出力
00098C 0A8C CD0500          17      CALL    SYSTEM
00098F 0A8F E1              10      POP HL
000990 0A90 C1              10      POP BC
000991 0A91 2B               6      DEC HL
000992 0A92 7C               4      LD  A,H
000993 0A93 B5               4      OR  L
000994 0A94 20EB            12      JR  NZ,TYPE3
000996 0A96 18D9            12      JR  TYPE2
       0A98                     TYPEE:
000998 0A98 3ADA11          13      LD  A,(MAJOR_VER)   ;DOS2対応
00099B 0A9B FE02             7      CP  2
00099D 0A9D 3806            12      JR  C,TYPEE2
00099F 0A9F ED4B1B12        20      LD  BC,(HANDLE1)
0009A3 0AA3 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
       0AA5                     TYPEE2:
0009A5 0AA5 CD4303          17      CALL    OPEN2_D2
0009A8 0AA8 A7               4      AND A
0009A9 0AA9 18BD            12      JR  TYPE1
                                
       0AAB                     CWILD:
0009AB 0AAB 215D00          10      LD  HL,FCB1+1
       0AAE                     CWILD1:
0009AE 0AAE 7E               7      LD  A,(HL)
0009AF 0AAF FE20             7      CP  020H
0009B1 0AB1 C0              11      RET NZ
       0AB2                     CWILD2:
0009B2 0AB2 54               4      LD  D,H
0009B3 0AB3 5D               4      LD  E,L
0009B4 0AB4 13               6      INC DE
0009B5 0AB5 010A00          10      LD  BC,10
0009B8 0AB8 363F            10      LD  (HL),'?'
0009BA 0ABA EDB0                    LDIR
0009BC 0ABC C9              10      RET
                                
       0ABD                     BUFSIZ:
0009BD 0ABD 3A0700          13      LD  A,(SYSTEM+2)
0009C0 0AC0 D681             7      SUB (DATA/256)+1
0009C2 0AC2 E6F8             7      AND 0F8H
0009C4 0AC4 67               4      LD  H,A
0009C5 0AC5 2E00             7      LD  L,0
0009C7 0AC7 C9              10      RET
                                
0009C8 0AC8 E9               4  JP_HL:  JP  (HL)
                                
       0AC9                     _PRINT:
0009C9 0AC9 C5              11      PUSH    BC
0009CA 0ACA D5              11      PUSH    DE
0009CB 0ACB E5              11      PUSH    HL
0009CC 0ACC DDE5            15      PUSH    IX
0009CE 0ACE 0E06             7      LD  C,6
0009D0 0AD0 CD0500          17      CALL    SYSTEM
0009D3 0AD3 DDE1            14      POP IX
0009D5 0AD5 E1              10      POP HL
0009D6 0AD6 D1              10      POP DE
0009D7 0AD7 C1              10      POP BC
0009D8 0AD8 B7               4      OR  A
0009D9 0AD9 C9              10      RET
                                
       0ADA                     PRTHX:
0009DA 0ADA F5              11      PUSH    AF
0009DB 0ADB 07               4      RLCA
0009DC 0ADC 07               4      RLCA
0009DD 0ADD 07               4      RLCA
0009DE 0ADE 07               4      RLCA
0009DF 0ADF CDE30A          17      CALL    PRTHX1
0009E2 0AE2 F1              10      POP AF
       0AE3                     PRTHX1:
0009E3 0AE3 CDF90A          17      CALL    ASC
       0AE6                     MSG_A:
0009E6 0AE6 F5              11      PUSH    AF
0009E7 0AE7 C5              11      PUSH    BC
0009E8 0AE8 D5              11      PUSH    DE
0009E9 0AE9 E5              11      PUSH    HL
0009EA 0AEA DDE5            15      PUSH    IX
0009EC 0AEC 5F               4      LD  E,A
0009ED 0AED 0E02             7      LD  C,2
0009EF 0AEF CD0500          17      CALL    SYSTEM
0009F2 0AF2 DDE1            14      POP IX
0009F4 0AF4 E1              10      POP HL
0009F5 0AF5 D1              10      POP DE
0009F6 0AF6 C1              10      POP BC
0009F7 0AF7 F1              10      POP AF
0009F8 0AF8 C9              10      RET
                                
       0AF9                     ASC:
0009F9 0AF9 E60F             7      AND 00FH
0009FB 0AFB F630             7      OR  '0'
0009FD 0AFD FE39             7      CP  '9'
0009FF 0AFF D8              11      RET C
000A00 0B00 C607             7      ADD A,7
000A02 0B02 C9              10      RET
                                ;       FILE
       0B03                     FILEC_D2:       ;DOS2対応
000A03 0B03 3ADA11          13      LD  A,(MAJOR_VER)
000A06 0B06 FE02             7      CP  2
000A08 0B08 381C            12      JR  C,FILEC
000A0A 0B0A C5              11      PUSH    BC
000A0B 0B0B D5              11      PUSH    DE
000A0C 0B0C E5              11      PUSH    HL
000A0D 0B0D CDF50B          17      CALL    SPCUT
000A10 0B10 212212          10      LD  HL,PATH_CCP
000A13 0B13 0640             7      LD  B,64
       0B15                     PATHCD1:
000A15 0B15 1A               7      LD  A,(DE)
000A16 0B16 13               6      INC DE
000A17 0B17 FE20             7      CP  020H
000A19 0B19 3002            12      JR  NC,PATHCD2
000A1B 0B1B 3E00             7      LD  A,0
       0B1D                     PATHCD2:
000A1D 0B1D 77               7      LD  (HL),A
000A1E 0B1E 3803            12      JR  C,PATHCD3
000A20 0B20 23               6      INC HL
000A21 0B21 10F2            13      DJNZ    PATHCD1
       0B23                     PATHCD3:
000A23 0B23 E1              10      POP HL
000A24 0B24 D1              10      POP DE
000A25 0B25 C1              10      POP BC
       0B26                     FILEC:
000A26 0B26 CD310B          17      CALL    FILE
       0B29                     FILEC2:
000A29 0B29 3AAC13          13      LD  A,(FDRV+1)
000A2C 0B2C FE20             7      CP  020H
000A2E 0B2E C8              11      RET Z
000A2F 0B2F 1840            12      JR  SETDIR1
                                
       0B31                     FILE:
000A31 0B31 3ADA11          13      LD  A,(MAJOR_VER)   ;Tablacus Disk ROM Lite
000A34 0B34 FE01             7      CP  1
000A36 0B36 283A            12      JR  Z,FILE_TDRL
       0B38                     FILEX:
000A38 0B38 AF               4      XOR A
000A39 0B39 32AB13          13      LD  (FDRV),A
000A3C 0B3C 67               4      LD  H,A
000A3D 0B3D 6F               4      LD  L,A
000A3E 0B3E 22B913          16      LD  (FDRV+14),HL
000A41 0B41 CDF50B          17      CALL    SPCUT
000A44 0B44 CDDA0B          17      CALL    CCHK3
000A47 0B47 2812            12      JR  Z,DEVI1
000A49 0B49 13               6      INC DE
000A4A 0B4A 1A               7      LD  A,(DE)
000A4B 0B4B 1B               6      DEC DE
000A4C 0B4C FE3A             7      CP  ':'
000A4E 0B4E 200B            12      JR  NZ,DEVI1
000A50 0B50 1A               7      LD  A,(DE)      ;DRIVE
000A51 0B51 CD080C          17      CALL    CAP
000A54 0B54 D640             7      SUB '@'
000A56 0B56 13               6      INC DE
000A57 0B57 13               6      INC DE
000A58 0B58 32AB13          13      LD  (FDRV),A
       0B5B                     DEVI1:
000A5B 0B5B 1A               7      LD  A,(DE)
000A5C 0B5C D65C             7      SUB 05CH        ;\
000A5E 0B5E 2009            12      JR  NZ,NOROOT
000A60 0B60 6F               4      LD  L,A     ;A=0でH=0のはずなのでHL=0
000A61 0B61 22C513          16      LD  (FDRV+26),HL
000A64 0B64 2C               4      INC L
000A65 0B65 22B913          16      LD  (FDRV+14),HL
000A68 0B68 13               6      INC DE
       0B69                     NOROOT:
                                
       0B69                     SETDIR:
000A69 0B69 CD7A0B          17      CALL    FILED
000A6C 0B6C 1A               7      LD  A,(DE)
000A6D 0B6D FE5C             7      CP  05CH        ;\
000A6F 0B6F C0              11      RET NZ
000A70 0B70 13               6      INC DE
       0B71                     SETDIR1:
000A71 0B71 C9              10      RET
                                
       0B72                     FILE_TDRL:
000A72 0B72 21AB13          10      LD  HL,FDRV
000A75 0B75 0E29             7      LD  C,029H      ;(BDOS) パス名の解析
000A77 0B77 C30500          10      JP  SYSTEM
                                
       0B7A                     FILED:
000A7A 0B7A CDC10B          17      CALL    FILEI
                                
000A7D 0B7D 0608             7      LD  B,8
       0B7F                     FILE2:
000A7F 0B7F CDCF0B          17      CALL    CCHKF
000A82 0B82 C8              11      RET Z
000A83 0B83 FE2A             7      CP  '*'
000A85 0B85 282E            12      JR  Z,FILE9
000A87 0B87 FE2E             7      CP  '.'
000A89 0B89 280C            12      JR  Z,FILE4
000A8B 0B8B 77               7      LD  (HL),A
000A8C 0B8C 23               6      INC HL
000A8D 0B8D 10F0            13      DJNZ    FILE2
                                
       0B8F                     FILE3:
000A8F 0B8F CDCF0B          17      CALL    CCHKF
000A92 0B92 C8              11      RET Z
000A93 0B93 FE2E             7      CP  '.'
000A95 0B95 20F8            12      JR  NZ,FILE3
                                
       0B97                     FILE4:
000A97 0B97 21B413          10      LD  HL,FNAME+8
000A9A 0B9A 0603             7      LD  B,3
                                
       0B9C                     FILE4L:
000A9C 0B9C CDCF0B          17      CALL    CCHKF
000A9F 0B9F C8              11      RET Z
000AA0 0BA0 FE2E             7      CP  '.'
000AA2 0BA2 2008            12      JR  NZ,FILE12
000AA4 0BA4 32AC13          13      LD  (FNAME),A   ;Parent directory(..)
000AA7 0BA7 32AD13          13      LD  (FNAME+1),A
000AAA 0BAA 3E20             7      LD  A,020H
       0BAC                     FILE12:
000AAC 0BAC FE2A             7      CP  '*'
000AAE 0BAE 280A            12      JR  Z,FILE10
000AB0 0BB0 77               7      LD  (HL),A
000AB1 0BB1 23               6      INC HL
000AB2 0BB2 10E8            13      DJNZ    FILE4L
000AB4 0BB4 C9              10      RET
                                
       0BB5                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000AB5 0BB5 CDBA0B          17      CALL    FILE10
000AB8 0BB8 18D5            12      JR  FILE3
                                
       0BBA                     FILE10:
000ABA 0BBA 3E3F             7      LD  A,'?'
                                
       0BBC                     FILL_MEMORY:                ;HLからBバイトAで埋める
000ABC 0BBC 77               7      LD  (HL),A
000ABD 0BBD 23               6      INC HL
000ABE 0BBE 10FC            13      DJNZ    FILL_MEMORY
000AC0 0BC0 C9              10      RET
                                
       0BC1                     FILEI:              ;名前＋拡張子をスペースで初期化
000AC1 0BC1 3E20             7      LD  A,020H
000AC3 0BC3 01000B          10      LD  BC,11*256
000AC6 0BC6 21AC13          10      LD  HL,FNAME
000AC9 0BC9 E5              11      PUSH    HL
000ACA 0BCA CDBC0B          17      CALL    FILL_MEMORY
000ACD 0BCD E1              10      POP HL
000ACE 0BCE C9              10      RET
                                
       0BCF                     CCHKF:
000ACF 0BCF 1A               7      LD  A,(DE)
000AD0 0BD0 CDD70B          17      CALL    CCHK2
000AD3 0BD3 C8              11      RET Z
000AD4 0BD4 C32A0C          10      JP  FKAN
                                
       0BD7                     CCHK2:
000AD7 0BD7 0C               4      INC C
000AD8 0BD8 0D               4      DEC C
000AD9 0BD9 C0              11      RET NZ
       0BDA                     CCHK3:              ;ZF=1 で使えない文字
000ADA 0BDA FE2B             7      CP  '+'
000ADC 0BDC C8              11      RET Z
000ADD 0BDD FE2C             7      CP  ','
000ADF 0BDF C8              11      RET Z
000AE0 0BE0 FE2F             7      CP  '/'
000AE2 0BE2 C8              11      RET Z
000AE3 0BE3 FE3A             7      CP  ':'
000AE5 0BE5 C8              11      RET Z
000AE6 0BE6 FE3B             7      CP  ';'
000AE8 0BE8 C8              11      RET Z
000AE9 0BE9 FE3D             7      CP  '='
000AEB 0BEB C8              11      RET Z
000AEC 0BEC FE5C             7      CP  05CH    ;\
000AEE 0BEE C8              11      RET Z
000AEF 0BEF FE20             7      CP  020H
000AF1 0BF1 D0              11      RET NC
000AF2 0BF2 BF               4      CP  A       ;Z=1
000AF3 0BF3 C9              10      RET
                                
       0BF4                     SS1:
000AF4 0BF4 13               6      INC DE
       0BF5                     SPCUT:              ;スペースをカット
000AF5 0BF5 1A               7      LD  A,(DE)
000AF6 0BF6 FE20             7      CP  020H
000AF8 0BF8 28FA            12      JR  Z,SS1
000AFA 0BFA C9              10      RET
                                
       0BFB                     TOZERO:
000AFB 0BFB D5              11      PUSH    DE
       0BFC                     TZ1:
000AFC 0BFC 1A               7      LD  A,(DE)
000AFD 0BFD FE20             7      CP  20H
000AFF 0BFF 3803            12      JR  C,TZ2
000B01 0C01 13               6      INC DE
000B02 0C02 18F8            12      JR  TZ1
       0C04                     TZ2:
000B04 0C04 AF               4      XOR A
000B05 0C05 12               7      LD  (DE),A
000B06 0C06 D1              10      POP DE
000B07 0C07 C9              10      RET
                                
       0C08                     CAP:
000B08 0C08 FE61             7      CP  'a'
000B0A 0C0A D8              11      RET C
000B0B 0C0B FE7B             7      CP  'z'+1
000B0D 0C0D D0              11      RET NC
000B0E 0C0E D620             7      SUB 020H
000B10 0C10 C9              10      RET
       0C11                     CAP2:
000B11 0C11 CD080C          17      CALL    CAP
       0C14                     CAP3:
000B14 0C14 CD1D0C          17      CALL    CAP4
000B17 0C17 FE21             7      CP  021H
000B19 0C19 D0              11      RET NC
000B1A 0C1A 3E20             7      LD  A,020H
000B1C 0C1C C9              10      RET
       0C1D                     CAP4:
000B1D 0C1D FE05             7      CP  5
000B1F 0C1F C0              11      RET NZ
000B20 0C20 3EE5             7      LD  A,0E5H
000B22 0C22 C9              10      RET
                                
       0C23                     FKANC:
000B23 0C23 CB41             8      BIT 0,C
000B25 0C25 CC110C          17      CALL    Z,CAP2
000B28 0C28 1801            12      JR  FKANX
       0C2A                     FKAN:           ;漢字チェック
000B2A 0C2A 13               6      INC DE
       0C2B                     FKANX:
000B2B 0C2B CB41             8      BIT 0,C
000B2D 0C2D CB81             8      RES 0,C
000B2F 0C2F C0              11      RET NZ
000B30 0C30 FE80             7      CP  080H
000B32 0C32 D8              11      RET C
000B33 0C33 FEA0             7      CP  0A0H
000B35 0C35 3803            12      JR  C,FKAN1
000B37 0C37 FEE0             7      CP  0E0H
000B39 0C39 D8              11      RET C
       0C3A                     FKAN1:
000B3A 0C3A 0C               4      INC C
000B3B 0C3B A7               4      AND A
000B3C 0C3C C9              10      RET
                                
       0C3D                     CHKWILDX:
000B3D 0C3D FDE5            15      PUSH    IY
000B3F 0C3F E1              10      POP HL
000B40 0C40 23               6      INC HL
       0C41                     CHKWILD:
000B41 0C41 060B             7      LD  B,11
000B43 0C43 3E3F             7      LD  A,'?'
       0C45                     CHKWIL1:
000B45 0C45 BE               7      CP  (HL)
000B46 0C46 23               6      INC HL
000B47 0C47 37               4      SCF
000B48 0C48 C8              11      RET Z
000B49 0C49 10FA            13      DJNZ    CHKWIL1
000B4B 0C4B AF               4      XOR A
000B4C 0C4C C9              10      RET
                                
       0C4D                     CPNAME:
000B4D 0C4D C5              11      PUSH    BC
000B4E 0C4E D5              11      PUSH    DE
000B4F 0C4F 119A13          10      LD  DE,CPBUF
000B52 0C52 010700          10      LD  BC,7
000B55 0C55 EDB0                    LDIR
000B57 0C57 D1              10      POP DE
000B58 0C58 D5              11      PUSH    DE
000B59 0C59 E5              11      PUSH    HL
000B5A 0C5A 219A13          10      LD  HL,CPBUF
000B5D 0C5D CD700C          17      CALL    CPFILE
000B60 0C60 E1              10      POP HL
000B61 0C61 D1              10      POP DE
000B62 0C62 C1              10      POP BC
000B63 0C63 2005            12      JR  NZ,CPNAME1
000B65 0C65 7E               7      LD  A,(HL)
000B66 0C66 23               6      INC HL
000B67 0C67 66               7      LD  H,(HL)
000B68 0C68 6F               4      LD  L,A
000B69 0C69 C9              10      RET
       0C6A                     CPNAME1:
000B6A 0C6A 23               6      INC HL
000B6B 0C6B 23               6      INC HL
000B6C 0C6C 10DF            13      DJNZ    CPNAME
000B6E 0C6E 37               4      SCF
000B6F 0C6F C9              10      RET
                                
       0C70                     CPFILE:
000B70 0C70 C5              11      PUSH    BC
000B71 0C71 01000B          10      LD  BC,00B00H
       0C74                     CPSTR1:
000B74 0C74 1A               7      LD  A,(DE)
000B75 0C75 FE3F             7      CP  '?'     ;Wild card
000B77 0C77 2812            12      JR  Z,CPSTR2
000B79 0C79 7E               7      LD  A,(HL)
000B7A 0C7A CD230C          17      CALL    FKANC
000B7D 0C7D E5              11      PUSH    HL
000B7E 0C7E 67               4      LD  H,A
000B7F 0C7F 1A               7      LD  A,(DE)
000B80 0C80 CB01             8      RLC C
000B82 0C82 CD230C          17      CALL    FKANC
000B85 0C85 CB09             8      RRC C
000B87 0C87 BC               4      CP  H       ;CP (HL),(DE)
000B88 0C88 E1              10      POP HL
000B89 0C89 2004            12      JR  NZ,CPSTR3
       0C8B                     CPSTR2:
000B8B 0C8B 13               6      INC DE
000B8C 0C8C 23               6      INC HL
000B8D 0C8D 10E5            13      DJNZ    CPSTR1
       0C8F                     CPSTR3:
000B8F 0C8F C1              10      POP BC
000B90 0C90 C9              10      RET
                                
       0C91                     CPFILE2:
000B91 0C91 FD7E0D          19      LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
000B94 0C94 F6E1             7      OR  0E1H
000B96 0C96 2F               4      CPL
000B97 0C97 A6               7      AND (HL)
000B98 0C98 C9              10      RET
                                
       0C99                     _SYS29:     ;(BDOS)ファイル名の解析
000B99 0C99 C5              11      PUSH    BC
000B9A 0C9A D5              11      PUSH    DE
000B9B 0C9B 0640             7      LD  B,64
000B9D 0C9D CDF50B          17      CALL    SPCUT
000BA0 0CA0 DD229813        20      LD  (DIR_CK),IX
       0CA4                     D2FN1:
000BA4 0CA4 1A               7      LD  A,(DE)
000BA5 0CA5 FE21             7      CP  020H+1
000BA7 0CA7 3808            12      JR  C,D2FN2
000BA9 0CA9 13               6      INC DE
000BAA 0CAA DD7700          19      LD  (IX+0),A
000BAD 0CAD DD23            10      INC IX
000BAF 0CAF 10F3            13      DJNZ    D2FN1
       0CB1                     D2FN2:
000BB1 0CB1 DD360000        19      LD  (IX+0),0
000BB5 0CB5 DD7EFF          19      LD  A,(IX-1)
000BB8 0CB8 FE5C             7      CP  05CH        ;\
000BBA 0CBA 2018            12      JR  NZ,D2FN3
000BBC 0CBC DD7EFE          19      LD  A,(IX-2)
000BBF 0CBF FE3A             7      CP  ':'
000BC1 0CC1 2811            12      JR  Z,D2FN3
                                
000BC3 0CC3 DD36FF00        19      LD  (IX-1),0
000BC7 0CC7 ED5B9813        20      LD  DE,(DIR_CK)
000BCB 0CCB CD4C0D          17      CALL    IS_FOLDER
000BCE 0CCE 3804            12      JR  C,D2FN3
       0CD0                     D2FN4:
000BD0 0CD0 DD36FF5C        19      LD  (IX-1),05CH ;\
       0CD4                     D2FN3:
000BD4 0CD4 D1              10      POP DE
000BD5 0CD5 C1              10      POP BC
000BD6 0CD6 C5              11      PUSH    BC
000BD7 0CD7 E5              11      PUSH    HL
000BD8 0CD8 CD310B          17      CALL    FILE
000BDB 0CDB E1              10      POP HL
000BDC 0CDC C1              10      POP BC
       0CDD                     S29X1:
000BDD 0CDD C5              11      PUSH    BC
000BDE 0CDE D5              11      PUSH    DE
000BDF 0CDF E5              11      PUSH    HL
000BE0 0CE0 EB               4      EX  DE,HL
000BE1 0CE1 21AB13          10      LD  HL,FDRV
000BE4 0CE4 010D00          10      LD  BC,13
000BE7 0CE7 EDB0                    LDIR
000BE9 0CE9 70               7      LD  (HL),B      ;B=0
000BEA 0CEA 0E03             7      LD  C,3
000BEC 0CEC EDB0                    LDIR
000BEE 0CEE E1              10      POP HL
000BEF 0CEF D1              10      POP DE
000BF0 0CF0 C1              10      POP BC
000BF1 0CF1 AF               4      XOR A
000BF2 0CF2 C9              10      RET
       0CF3                     GET_WIDTH:
000BF3 0CF3 3AD911          13      LD  A,(IS_MSX)
000BF6 0CF6 B7               4      OR  A
000BF7 0CF7 2804            12      JR  Z,NOT_MSX
000BF9 0CF9 3AB0F3          13      LD  A,(LINLEN)
000BFC 0CFC C9              10      RET
       0CFD                     NOT_MSX:
000BFD 0CFD E5              11      PUSH    HL
000BFE 0CFE 2A0100          16      LD  HL,(1)
000C01 0D01 2EB1             7      LD  L,0B1H
000C03 0D03 7E               7      LD  A,(HL)
000C04 0D04 E1              10      POP HL
000C05 0D05 C9              10      RET
                                
       0D06                     IS_FOLDER_FN2:
000C06 0D06 11E212          10      LD  DE,PATH_FN2
000C09 0D09 CD630D          17      CALL    IS_FOLDER2
000C0C 0D0C D8              11      RET C
                                
000C0D 0D0D 110000          10      LD  DE,0
000C10 0D10 ED53D613        20      LD  (PATH_FN2_SL),DE
000C14 0D14 11E212          10      LD  DE,PATH_FN2
       0D17                     IF2_1:
000C17 0D17 1A               7      LD  A,(DE)
000C18 0D18 13               6      INC DE
000C19 0D19 FE5C             7      CP  '\\'
000C1B 0D1B 2004            12      JR  NZ,IF2_2
000C1D 0D1D ED53D613        20      LD  (PATH_FN2_SL),DE
       0D21                     IF2_2:
000C21 0D21 B7               4      OR  A
000C22 0D22 20F3            12      JR  NZ,IF2_1
000C24 0D24 ED5BD613        20      LD  DE,(PATH_FN2_SL)
000C28 0D28 7A               4      LD  A,D
000C29 0D29 B3               4      OR  E
000C2A 0D2A 280F            12      JR  Z,IS_FOLDER_FN2_E
000C2C 0D2C AF               4      XOR A
000C2D 0D2D 1B               6      DEC DE
000C2E 0D2E 12               7      LD  (DE),A
                                
000C2F 0D2F 11E212          10      LD  DE,PATH_FN2
000C32 0D32 CD4C0D          17      CALL    IS_FOLDER
000C35 0D35 3009            12      JR  NC,IS2_3
000C37 0D37 3E5C             7      LD  A,'\\'
000C39 0D39 1B               6      DEC DE
000C3A 0D3A 12               7      LD  (DE),A
       0D3B                     IS_FOLDER_FN2_E:
000C3B 0D3B 11E212          10      LD  DE,PATH_FN2
000C3E 0D3E 37               4      SCF
000C3F 0D3F C9              10      RET
       0D40                     IS2_3:
000C40 0D40 ED5BD613        20      LD  DE,(PATH_FN2_SL)
000C44 0D44 216C00          10      LD  HL,FCB2
000C47 0D47 CD990C          17      CALL    _SYS29
000C4A 0D4A 37               4      SCF
000C4B 0D4B C9              10      RET
                                
       0D4C                     IS_FOLDER:          ;out CF=0:Folder
000C4C 0D4C CDF50B          17      CALL    SPCUT
000C4F 0D4F 1A               7      LD  A,(DE)
000C50 0D50 C6FF             7      ADD A,0FFH
000C52 0D52 D0              11      RET NC
000C53 0D53 AF               4      XOR A
000C54 0D54 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C56 0D56 D5              11      PUSH    DE
000C57 0D57 CDC603          17      CALL    SYSTEM0
000C5A 0D5A D1              10      POP DE
000C5B 0D5B 37               4      SCF
000C5C 0D5C C0              11      RET NZ
000C5D 0D5D 7D               4      LD  A,L
000C5E 0D5E E610             7      AND 010H
000C60 0D60 D601             7      SUB 1
000C62 0D62 C9              10      RET
                                
       0D63                     IS_FOLDER2:         ;out CF=0:Folder
000C63 0D63 CDF50B          17      CALL    SPCUT
000C66 0D66 1A               7      LD  A,(DE)
000C67 0D67 C6FF             7      ADD A,0FFH
000C69 0D69 D0              11      RET NC
000C6A 0D6A AF               4      XOR A
000C6B 0D6B 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000C6D 0D6D D5              11      PUSH    DE
000C6E 0D6E CDC603          17      CALL    SYSTEM0
000C71 0D71 D1              10      POP DE
000C72 0D72 C0              11      RET NZ
000C73 0D73 7D               4      LD  A,L
000C74 0D74 E610             7      AND 010H
000C76 0D76 D601             7      SUB 1
000C78 0D78 C9              10      RET
                                
       0D79                     C_MODE:
000C79 0D79 3AD911          13      LD  A,(IS_MSX)
000C7C 0D7C B7               4      OR  A
000C7D 0D7D C8              11      RET Z
000C7E 0D7E 0E29             7      LD  C,41
000C80 0D80 3AF8FA          13      LD  A,(EXBRSA)
000C83 0D83 B7               4      OR  A
000C84 0D84 2802            12      JR  Z,MODE_MSX1
000C86 0D86 0E51             7      LD  C,81
       0D88                     MODE_MSX1:
000C88 0D88 C5              11      PUSH    BC
000C89 0D89 CDE10F          17      CALL    GETNUM
000C8C 0D8C C1              10      POP BC
000C8D 0D8D 7D               4      LD  A,L
000C8E 0D8E B9               4      CP  C
000C8F 0D8F 301C            12      JR  NC,MODE1
000C91 0D91 B7               4      OR  A
000C92 0D92 2819            12      JR  Z,MODE1
000C94 0D94 FE21             7      CP  33
000C96 0D96 381E            12      JR  C,MODE32
000C98 0D98 32AEF3          13      LD  (LINL40),A
000C9B 0D9B DD216C00        14      LD  IX,INITXT
000C9F 0D9F CDA60D          17      CALL    CALLROM
000CA2 0DA2 DD217800        14      LD  IX,SETTXT
       0DA6                     CALLROM:
000CA6 0DA6 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000CAA 0DAA C31C00          10      JP  CALSLT
       0DAD                     MODE1:
000CAD 0DAD 3AB0F3          13      LD  A,(LINLEN)
000CB0 0DB0 CDD907          17      CALL    PRDEC_A
000CB3 0DB3 C37506          10      JP  LTNL
       0DB6                     MODE32:
000CB6 0DB6 32AFF3          13      LD  (LINL32),A
000CB9 0DB9 DD216F00        14      LD  IX,INIT32
000CBD 0DBD CDA60D          17      CALL    CALLROM
000CC0 0DC0 DD217B00        14      LD  IX,SETT32
000CC4 0DC4 18E0            12      JR  CALLROM
                                
       0DC6                     C_PAUSE:
000CC6 0DC6 CDF50B          17      CALL    SPCUT
000CC9 0DC9 EB               4      EX  DE,HL
000CCA 0DCA 7E               7      LD  A,(HL)
000CCB 0DCB B7               4      OR  A
000CCC 0DCC 2003            12      JR  NZ,C_PAUSE1
000CCE 0DCE 21BE10          10      LD  HL,PAUSE
       0DD1                     C_PAUSE1:
000CD1 0DD1 CD3706          17      CALL    MSX
000CD4 0DD4 0E07             7      LD  C,7     ;(BDOS)コンソール直接入力(_DIRIN)
000CD6 0DD6 CD0500          17      CALL    SYSTEM
000CD9 0DD9 FE03             7      CP  3
000CDB 0DDB CA4C05          10      JP  Z,END_BATCH
000CDE 0DDE C37506          10      JP  LTNL
                                
       0DE1                     C_ECHO:
000CE1 0DE1 CDF50B          17      CALL    SPCUT
000CE4 0DE4 EB               4      EX  DE,HL
000CE5 0DE5 CD3706          17      CALL    MSX
000CE8 0DE8 C37506          10      JP  LTNL
                                
       0DEB                     C_MKDIR:
000CEB 0DEB CDF50B          17      CALL    SPCUT
000CEE 0DEE 014490          10      LD  BC,09044H   ;B=新規作成+ディレクトリ/C=(BDOS)ファイルハンドルの作成(_CREATE)
000CF1 0DF1 CD0500          17      CALL    SYSTEM
000CF4 0DF4 C6FF             7      ADD A,0FFH
000CF6 0DF6 D8              11      RET C
000CF7 0DF7 0E45             7      LD  C,045H      ;(BDOS)ファイルハンドルのクローズ(_CLOSE)
000CF9 0DF9 CD0500          17      CALL    SYSTEM
       0DFC                     SHOW_OK:
000CFC 0DFC 11B410          10      LD  DE,OK
000CFF 0DFF 0E09             7      LD  C,9     ;(BDOS)文字列出力
000D01 0E01 CD0500          17      CALL    SYSTEM
000D04 0E04 C37506          10      JP  LTNL
                                
       0E07                     C_RMDIR:
000D07 0E07 CD4C0D          17      CALL    IS_FOLDER
000D0A 0E0A D8              11      RET C
000D0B 0E0B 0E4D             7      LD  C,04DH      ;(BDOS)ファイル・サブディレクトリの削除
000D0D 0E0D CD0500          17      CALL    SYSTEM
000D10 0E10 C6FF             7      ADD A,0FFH
000D12 0E12 D8              11      RET C
000D13 0E13 18E7            12      JR  SHOW_OK
                                
       0E15                     C_SET:
000D15 0E15 CDF50B          17      CALL    SPCUT
000D18 0E18 ED532B0E        20      LD  (CSET_PARAM),DE
       0E1C                     CSET2:
000D1C 0E1C 1A               7      LD  A,(DE)
000D1D 0E1D FE20             7      CP  020H
000D1F 0E1F 3838            12      JR  C,CSET_LIST
000D21 0E21 D63D             7      SUB '='
000D23 0E23 2803            12      JR  Z,CSET_SET
000D25 0E25 13               6      INC DE
000D26 0E26 18F4            12      JR  CSET2
       0E28                     CSET_SET:
000D28 0E28 12               7      LD  (DE),A
000D29 0E29 13               6      INC DE
       0E2B                     CSET_PARAM  EQU $+1
000D2A 0E2A 210000          10      LD  HL,0
000D2D 0E2D 0E6C             7      LD  C,06CH      ;_SENV 環境変数の設定
000D2F 0E2F CD0500          17      CALL    SYSTEM
       0E32                     INIT_VAR:           ;環境変数の初期化
000D32 0E32 219511          10      LD  HL,N_DATE
000D35 0E35 119A11          10      LD  DE,V_DATE
000D38 0E38 0610             7      LD  B,16
000D3A 0E3A 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D3C 0E3C CD0500          17      CALL    SYSTEM
                                
000D3F 0E3F 21BA11          10      LD  HL,N_TIME
000D42 0E42 11BF11          10      LD  DE,V_TIME
000D45 0E45 0603             7      LD  B,3
000D47 0E47 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D49 0E49 CD0500          17      CALL    SYSTEM
                                
000D4C 0E4C 210911          10      LD  HL,N_APPEND
000D4F 0E4F 111011          10      LD  DE,V_APPEND
000D52 0E52 0640             7      LD  B,PATHX
000D54 0E54 0E6B             7      LD  C,06BH      ;_GENV 環境変数の獲得
000D56 0E56 C30500          10      JP  SYSTEM
                                
       0E59                     CSET_LIST:
000D59 0E59 3E0A             7      LD  A,10
000D5B 0E5B 32D813          13      LD  (CSET_DATA),A
000D5E 0E5E 110100          10      LD  DE,1
       0E61                     CSET1:
000D61 0E61 D5              11      PUSH    DE
000D62 0E62 016DFF          10      LD  BC,0FF6DH   ;_FENV 環境変数の検索
000D65 0E65 21DA13          10      LD  HL,DATA_COM
000D68 0E68 3600            10      LD  (HL),0
000D6A 0E6A CD0500          17      CALL    SYSTEM
000D6D 0E6D B7               4      OR  A
000D6E 0E6E 2030            12      JR  NZ,CSET_ERROR
000D70 0E70 21DA13          10      LD  HL,DATA_COM
000D73 0E73 7E               7      LD  A,(HL)
000D74 0E74 B7               4      OR  A
000D75 0E75 2829            12      JR  Z,CSET_ERROR
000D77 0E77 CD3706          17      CALL    MSX
000D7A 0E7A 1E3D             7      LD  E,'='
000D7C 0E7C CDC90A          17      CALL    _PRINT
000D7F 0E7F 21DA13          10      LD  HL,DATA_COM
000D82 0E82 11DA14          10      LD  DE,DATA_COM+256
000D85 0E85 016BFF          10      LD  BC,0FF6BH   ;_GENV 環境変数の獲得
000D88 0E88 CD0500          17      CALL    SYSTEM
000D8B 0E8B 21DA14          10      LD  HL,DATA_COM+256
000D8E 0E8E CD3706          17      CALL    MSX
000D91 0E91 CD7506          17      CALL    LTNL
000D94 0E94 3E0A             7      LD  A,10
000D96 0E96 32D813          13      LD  (CSET_DATA),A
       0E99                     CSET_NEXT:
000D99 0E99 D1              10      POP DE
000D9A 0E9A 13               6      INC DE
000D9B 0E9B 7A               4      LD  A,D
000D9C 0E9C B3               4      OR  E
000D9D 0E9D 20C2            12      JR  NZ,CSET1
000D9F 0E9F C9              10      RET
       0EA0                     CSET_ERROR:
000DA0 0EA0 21D813          10      LD  HL,CSET_DATA
000DA3 0EA3 35              11      DEC (HL)
000DA4 0EA4 20F3            12      JR  NZ,CSET_NEXT
       0EA6                     CSET_END:
000DA6 0EA6 D1              10      POP DE
000DA7 0EA7 C9              10      RET
                                
       0EA8                     C_FORMAT:
000DA8 0EA8 3AD911          13      LD  A,(IS_MSX)
000DAB 0EAB B7               4      OR  A
000DAC 0EAC C8              11      RET Z
000DAD 0EAD 3ADA11          13      LD  A,(MAJOR_VER)
000DB0 0EB0 FE02             7      CP  2
000DB2 0EB2 300B            12      JR  NC,FORMAT2
       0EB4                     FORMAT1:
000DB4 0EB4 FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
000DB8 0EB8 DD214701        14      LD  IX,FORMAT
000DBC 0EBC C31C00          10      JP  CALSLT
       0EBF                     FORMAT2:
000DBF 0EBF CD6408          17      CALL    SETFCB
000DC2 0EC2 3A5C00          13      LD  A,(FCB1)
000DC5 0EC5 B7               4      OR  A
000DC6 0EC6 28EC            12      JR  Z,FORMAT1
000DC8 0EC8 47               4      LD  B,A
000DC9 0EC9 AF               4      XOR A
000DCA 0ECA 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000DCC 0ECC CD0500          17      CALL    SYSTEM
000DCF 0ECF B7               4      OR  A
000DD0 0ED0 20E2            12      JR  NZ,FORMAT1
000DD2 0ED2 CD4006          17      CALL    MSXSLT
000DD5 0ED5 21D611          10      LD  HL,PROMPT
000DD8 0ED8 CD3706          17      CALL    MSX
       0EDB                     FORMAT3:
000DDB 0EDB 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DDD 0EDD CD0500          17      CALL    SYSTEM
000DE0 0EE0 D631             7      SUB '0'+1
000DE2 0EE2 38F7            12      JR  C,FORMAT3
000DE4 0EE4 3C               4      INC A
000DE5 0EE5 FE0A             7      CP  10
000DE7 0EE7 30F2            12      JR  NC,FORMAT3
000DE9 0EE9 F5              11      PUSH    AF
000DEA 0EEA CD7506          17      CALL    LTNL
000DED 0EED 21BE10          10      LD  HL,PAUSE
000DF0 0EF0 CD3706          17      CALL    MSX
000DF3 0EF3 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力(_INNOE)
000DF5 0EF5 CD0500          17      CALL    SYSTEM
000DF8 0EF8 CD7506          17      CALL    LTNL
000DFB 0EFB F1              10      POP AF
000DFC 0EFC ED4B5B00        20      LD  BC,(FCB1-1)
000E00 0F00 210080          10      LD  HL,08000H
000E03 0F03 110040          10      LD  DE,04000H
000E06 0F06 0E67             7      LD  C,067H      ;(_FORMAT)ディスクのフォーマット
000E08 0F08 C30500          10      JP  SYSTEM
                                
       0F0B                     C_RAMDISK:
000E0B 0F0B 3AD911          13      LD  A,(IS_MSX)
000E0E 0F0E B7               4      OR  A
000E0F 0F0F C8              11      RET Z
000E10 0F10 3ADA11          13      LD  A,(MAJOR_VER)
000E13 0F13 FE02             7      CP  2
000E15 0F15 D8              11      RET C
000E16 0F16 CDF50B          17      CALL    SPCUT
000E19 0F19 1A               7      LD  A,(DE)
000E1A 0F1A FE30             7      CP  '0'
000E1C 0F1C D8              11      RET C
000E1D 0F1D FE3A             7      CP  '9'+1
000E1F 0F1F 3F               4      CCF
000E20 0F20 D8              11      RET C
000E21 0F21 CDE10F          17      CALL    GETNUM
000E24 0F24 110F00          10      LD  DE,15       ;切り上げの為
000E27 0F27 19              11      ADD HL,DE
000E28 0F28 7D               4      LD  A,L
000E29 0F29 0604             7      LD  B,4     ;16で割る
       0F2B                     RAMDISK1:
000E2B 0F2B CB3C             8      SRL H   ;/2
000E2D 0F2D 1F               4      RRA
000E2E 0F2E 10FB            13      DJNZ    RAMDISK1
000E30 0F30 FEFF             7      CP  0FFH
000E32 0F32 2001            12      JR  NZ,RAMDISK2
000E34 0F34 3D               4      DEC A
       0F35                     RAMDISK2:
000E35 0F35 47               4      LD  B,A
000E36 0F36 0E68             7      LD  C,068H      ;(_RAMD)RAMディスクの作成あるいは消去
000E38 0F38 CD0500          17      CALL    SYSTEM
000E3B 0F3B B7               4      OR  A
000E3C 0F3C CCFC0D          17      CALL    Z,SHOW_OK
000E3F 0F3F C9              10      RET
                                
       0F40                     C_ATTRIB:
000E40 0F40 3AD911          13      LD  A,(IS_MSX)
000E43 0F43 B7               4      OR  A
000E44 0F44 C8              11      RET Z
000E45 0F45 3ADA11          13      LD  A,(MAJOR_VER)
000E48 0F48 FE02             7      CP  2
000E4A 0F4A D8              11      RET C
000E4B 0F4B ED536C0F        20      LD  (ATTRIB_OPT),DE
                                                ;パス名を検索
       0F4F                     ATTRIB1:
000E4F 0F4F CDF50B          17      CALL    SPCUT
000E52 0F52 1A               7      LD  A,(DE)
000E53 0F53 13               6      INC DE
000E54 0F54 FE20             7      CP  ' '
000E56 0F56 D8              11      RET C
000E57 0F57 FE41             7      CP  'A'
000E59 0F59 3003            12      JR  NC,ATTRIB2
000E5B 0F5B 13               6      INC DE
000E5C 0F5C 18F1            12      JR  ATTRIB1
       0F5E                     ATTRIB2:
000E5E 0F5E 1B               6      DEC DE
000E5F 0F5F ED53D40F        20      LD  (ATTRIB_PATH),DE
000E63 0F63 AF               4      XOR A
000E64 0F64 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000E66 0F66 CDC603          17      CALL    SYSTEM0
000E69 0F69 37               4      SCF
000E6A 0F6A C0              11      RET NZ
                                
000E6B 0F6B 110000          10      LD  DE,0
       0F6C                     ATTRIB_OPT  EQU $-2
       0F6E                     ATTRIB3:
000E6E 0F6E CDF50B          17      CALL    SPCUT
000E71 0F71 1A               7      LD  A,(DE)
000E72 0F72 13               6      INC DE
000E73 0F73 FE41             7      CP  'A'
000E75 0F75 305C            12      JR  NC,ATTRIB_WRITE
000E77 0F77 FE2D             7      CP  '-'
000E79 0F79 280A            12      JR  Z,ATTRIB_M
000E7B 0F7B FE2B             7      CP  '+'
000E7D 0F7D 282D            12      JR  Z,ATTRIB_P
000E7F 0F7F FE2F             7      CP  '/'
000E81 0F81 1A               7      LD  A,(DE)
000E82 0F82 13               6      INC DE
000E83 0F83 18E9            12      JR  ATTRIB3
       0F85                     ATTRIB_M:
000E85 0F85 1A               7      LD  A,(DE)
000E86 0F86 13               6      INC DE
000E87 0F87 CD080C          17      CALL    CAP
000E8A 0F8A FE41             7      CP  'A'
000E8C 0F8C 280E            12      JR  Z,ATTRIB_M_A
000E8E 0F8E FE53             7      CP  'S'
000E90 0F90 280E            12      JR  Z,ATTRIB_M_S
000E92 0F92 FE48             7      CP  'H'
000E94 0F94 280E            12      JR  Z,ATTRIB_M_H
000E96 0F96 FE52             7      CP  'R'
000E98 0F98 280E            12      JR  Z,ATTRIB_M_R
000E9A 0F9A 18D2            12      JR  ATTRIB3
       0F9C                     ATTRIB_M_A:
000E9C 0F9C CBAD             8      RES 5,L
000E9E 0F9E 18CE            12      JR  ATTRIB3
       0FA0                     ATTRIB_M_S:
000EA0 0FA0 CB95             8      RES 2,L
000EA2 0FA2 18CA            12      JR  ATTRIB3
       0FA4                     ATTRIB_M_H:
000EA4 0FA4 CB8D             8      RES 1,L
000EA6 0FA6 18C6            12      JR  ATTRIB3
       0FA8                     ATTRIB_M_R:
000EA8 0FA8 CB85             8      RES 0,L
000EAA 0FAA 18C2            12      JR  ATTRIB3
       0FAC                     ATTRIB_P:
000EAC 0FAC 1A               7      LD  A,(DE)
000EAD 0FAD 13               6      INC DE
000EAE 0FAE CD080C          17      CALL    CAP
000EB1 0FB1 FE41             7      CP  'A'
000EB3 0FB3 280E            12      JR  Z,ATTRIB_P_A
000EB5 0FB5 FE53             7      CP  'S'
000EB7 0FB7 280E            12      JR  Z,ATTRIB_P_S
000EB9 0FB9 FE48             7      CP  'H'
000EBB 0FBB 280E            12      JR  Z,ATTRIB_P_H
000EBD 0FBD FE52             7      CP  'R'
000EBF 0FBF 280E            12      JR  Z,ATTRIB_P_R
000EC1 0FC1 18AB            12      JR  ATTRIB3
       0FC3                     ATTRIB_P_A:
000EC3 0FC3 CBED             8      SET 5,L
000EC5 0FC5 18A7            12      JR  ATTRIB3
       0FC7                     ATTRIB_P_S:
000EC7 0FC7 CBD5             8      SET 2,L
000EC9 0FC9 18A3            12      JR  ATTRIB3
       0FCB                     ATTRIB_P_H:
000ECB 0FCB CBCD             8      SET 1,L
000ECD 0FCD 189F            12      JR  ATTRIB3
       0FCF                     ATTRIB_P_R:
000ECF 0FCF CBC5             8      SET 0,L
000ED1 0FD1 189B            12      JR  ATTRIB3
       0FD3                     ATTRIB_WRITE:
000ED3 0FD3 110000          10      LD  DE,0
       0FD4                     ATTRIB_PATH EQU $-2
000ED6 0FD6 3E01             7      LD  A,1
000ED8 0FD8 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
000EDA 0FDA CDC603          17      CALL    SYSTEM0
000EDD 0FDD D8              11      RET C
000EDE 0FDE C3FC0D          10      JP  SHOW_OK
                                
       0FE1                     GETNUM:
000EE1 0FE1 CDF50B          17      CALL    SPCUT
000EE4 0FE4 210000          10      LD  HL,0
       0FE7                     GETNUM1:
000EE7 0FE7 1A               7      LD  A,(DE)
000EE8 0FE8 13               6      INC DE
000EE9 0FE9 D630             7      SUB '0'
000EEB 0FEB D8              11      RET C
000EEC 0FEC FE0A             7      CP  10
000EEE 0FEE D0              11      RET NC
000EEF 0FEF 4D               4      LD  C,L
000EF0 0FF0 44               4      LD  B,H
000EF1 0FF1 29              11      ADD HL,HL   ;*2
000EF2 0FF2 29              11      ADD HL,HL   ;*4
000EF3 0FF3 09              11      ADD HL,BC   ;*5
000EF4 0FF4 29              11      ADD HL,HL   ;*10
000EF5 0FF5 4F               4      LD  C,A
000EF6 0FF6 0600             7      LD  B,0
000EF8 0FF8 09              11      ADD HL,BC
000EF9 0FF9 18EC            12      JR  GETNUM1
                                
       0012                     COMS    EQU 18
       0FFB                     COMTB:
000EFB 0FFB 44202020202020          DB  "D      "   ;1
000F02 1002 CB05                    DW  C_DIR
000F04 1004 44495220202020          DB  "DIR    "   ;2
000F0B 100B CB05                    DW  C_DIR
000F0D 100D 434F5059202020          DB  "COPY   "   ;3
000F14 1014 AD08                    DW  C_COPY
000F16 1016 43442020202020          DB  "CD     "   ;4
000F1D 101D CB03                    DW  C_CD
000F1F 101F 44454C20202020          DB  "DEL    "   ;5
000F26 1026 6A05                    DW  C_DEL
000F28 1028 50415448202020          DB  "PATH   "   ;6
000F2F 102F 7F06                    DW  C_PATH
000F31 1031 52454E20202020          DB  "REN    "   ;7
000F38 1038 9D05                    DW  C_REN
000F3A 103A 54595045202020          DB  "TYPE   "   ;8
000F41 1041 580A                    DW  C_TYPE
000F43 1043 52454D20202020          DB  "REM    "   ;9
000F4A 104A 6805                    DW  C_REM
000F4C 104C 4D4F4445202020          DB  "MODE   "   ;10
000F53 1053 790D                    DW  C_MODE
000F55 1055 50415553452020          DB  "PAUSE  "   ;11
000F5C 105C C60D                    DW  C_PAUSE
000F5E 105E 53455420202020          DB  "SET    "   ;12
000F65 1065 150E                    DW  C_SET
000F67 1067 4543484F202020          DB  "ECHO   "   ;13
000F6E 106E E10D                    DW  C_ECHO
000F70 1070 4D4B4449522020          DB  "MKDIR  "   ;14
000F77 1077 EB0D                    DW  C_MKDIR
000F79 1079 524D4449522020          DB  "RMDIR  "   ;15
000F80 1080 070E                    DW  C_RMDIR
000F82 1082 464F524D415420          DB  "FORMAT "   ;16
000F89 1089 A80E                    DW  C_FORMAT
000F8B 108B 52414D4449534B          DB  "RAMDISK"   ;17
000F92 1092 0B0F                    DW  C_RAMDISK
000F94 1094 41545452494220          DB  "ATTRIB "   ;18
000F9B 109B 400F                    DW  C_ATTRIB
                                
000F9D 109D 2062797465732066    FREE:   DB  " bytes free  $"
            726565202024        
000FAB 10AB 2020203C4449523E    DIRMES: DB  "   <DIR>$"
            24                  
000FB4 10B4 4F4B24              OK: DB  "OK$"
000FB7 10B7 4572726F722124      COMERM: DB  "Error!$"
000FBE 10BE 537472696B652061    PAUSE:  DB  "Strike any key when ready ",0
            6E79206B65792077    
            68656E2072656164    
            792000              
                                
       10D9                     S_MONTH:
000FD9 10D9 4A616E00                DB  "Jan",0
000FDD 10DD 46656200                DB  "Feb",0
000FE1 10E1 4D617200                DB  "Mar",0
000FE5 10E5 41707200                DB  "Apr",0
000FE9 10E9 4D617900                DB  "May",0
000FED 10ED 4A756E00                DB  "Jun",0
000FF1 10F1 4A756C00                DB  "Jul",0
000FF5 10F5 41756700                DB  "Aug",0
000FF9 10F9 53657000                DB  "Sep",0
000FFD 10FD 4F637400                DB  "Oct",0
001001 1101 4E6F7600                DB  "Nov",0
001005 1105 44656300                DB  "Dec",0
                                
       1109                     N_APPEND:
001009 1109 415050454E4400          DB  "APPEND",0
       1110                     V_APPEND:
001010 1110                         DS  64
       1150                     N_PATH:
001050 1150 5041544800              DB  "PATH",0
       1155                     V_PATH:
001055 1155                         DS  PATHX
       1195                     N_DATE:
001095 1195 4441544500              DB  "DATE",0
       119A                     V_DATE:
00109A 119A 79792D6D6D2D6464        DB  "yy-mm-dd"
0010A2 11A2                         DS  8
       11AA                     V_DATE1:
0010AA 11AA 6D6D2D64642D7979        DB  "mm-dd-yy"
       11B2                     V_DATE2:
0010B2 11B2 64642D6D6D2D7979        DB  "dd-mm-yy"
       11BA                     N_TIME:
0010BA 11BA 54494D4500              DB  "TIME",0
       11BF                     V_TIME:
0010BF 11BF 323400                  DB  "24",0
       11C2                     N_PROGRAM:
0010C2 11C2 50524F4752414D00        DB  "PROGRAM",0
       11CA                     N_PARAMETERS:
0010CA 11CA 504152414D455445        DB  "PARAMETERS",0
            525300              
                                
       11D5                     F_TIME:
0010D5 11D5 00                      DB  0
       11D6                     PROMPT:
0010D6 11D6 3F2000                  DB  "? ",0
       11D9                     IS_MSX:
0010D9 11D9 00                      DB  0
       11DA                     MAJOR_VER:
0010DA 11DA 00                      DB  0
       11DB                     SEARCH_IX:
0010DB 11DB                         DS  64  ;DOS2用
       121B                     HANDLE1:
00111B 121B 0000                    DW  0
       121D                     PATH_POS:
00111D 121D 0000                    DW  0
       121F                     PATH_DRV:
00111F 121F 413A5C                  DB  "A:\\"
       1222                     PATH_CCP:
001122 1222                         DS  64  ;DOS2用
       1262                     PATH_PAR:
001162 1262                         DS  64  ;DOS2用
       12A2                     PATH_FN1:
0011A2 12A2                         DS  64  ;DOS2用
       12E2                     PATH_FN2:
0011E2 12E2                         DS  64  ;DOS2用
       1322                     CUR_DRV:
001222 1322 413A5C                  DB  "A:\\"
       1325                     CUR_PATH:
001225 1325                         DS  64  ;DOS2用
       1365                     DOS2NAME:
001265 1365                         DS  2+8+3+1 ;DOS2用
       1373                     DTA_CCP:
001273 1373                         DS  37
       1398                     DIR_CK:
001298 1398 0000                    DW  0
                                
       139A                     CPBUF:
00129A 139A 0000                LEFTX:  DW  0
00129C 139C 0000                DTAX:   DW  0
00129E 139E 20                      DB  020H    ;CPBUFで使う
00129F 139F 20                      DB  020H
0012A0 13A0 20                      DB  020H
0012A1 13A1 20                      DB  020H
0012A2 13A2 20                      DB  020H
0012A3 13A3 20                      DB  020H
0012A4 13A4 20                      DB  020H
                                
       13A5                     DECBF:
0012A5 13A5                         DS  5
       13AA                     FCB_BAT2:
0012AA 13AA 00                      DB  0
       13AB                     FDRV:
0012AB 13AB 00                      DB  0
       13AC                     FNAME:
0012AC 13AC                         DS  37
       13D1                     ZERO:
0012D1 13D1 00                      DB  0
       13D2                     FCB_BAT:
0012D2 13D2 AA13                    DW  FCB_BAT2
       13D4                     X_PATH:
0012D4 13D4 0000                    DW  0
       13D6                     PATH_FN2_SL:
0012D6 13D6 0000                    DW  0
       13D8                     CSET_DATA:
0012D8 13D8 00                      DB  0
       13D9                     PROCESS:
0012D9 13D9 00                      DB  0
                                
       13DA                     DATA_COM:
[EOF:COMMAND.ASM:UTF_8]
