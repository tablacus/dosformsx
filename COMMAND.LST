                                ;*** AILZ80ASM *** Z-80 Assembler, version 1.0.0.0, LST:Full:4
                                
                                ;   似非COMMAND.COM
                                
       0005                     SYSTEM  EQU 00005H
       005C                     FCB1    EQU 0005CH
       006C                     FCB2    EQU 0006CH
       0080                     DTA1    EQU 00080H
                                
       001C                     CALSLT  EQU 0001CH
       006C                     INITXT  EQU 0006CH
       006F                     INIT32  EQU 0006FH
       0078                     SETTXT  EQU 00078H
       007B                     SETT32  EQU 0007BH
                                
       F3AE                     LINL40  EQU 0F3AEH
       F3AF                     LINL32  EQU 0F3AFH
       F3B0                     LINLEN  EQU 0F3B0H
       F55E                     BUF EQU 0F55EH
       FAF8                     EXBRSA  EQU 0FAF8H
       FC9B                     INTFLG  EQU 0FC9BH
       FCC1                     EXPTBL  EQU 0FCC1H
                                
                                
       0020                     PATHX   EQU 32
       F640                     PATHD   EQU BUF+258-32
                                
       8000                     DATA    EQU 08000H
                                
000000 0100                         ORG 0100H
000000 0100 C31501          10      JP  START
000003 0103 0D0A434F4D4D414E    VER:    DB  00DH,00AH,"COMMAND v0.06",00DH,00AH,'$'
            442076302E30360D    
            0A24                
       0115                     START:
000015 0115 ED7B0600        20      LD  SP,(SYSTEM+1)
000019 0119 0E6F             7      LD  C,06FH      ;(BDOS)MSX-DOS のバージョン番号の獲得
00001B 011B CD0500          17      CALL    SYSTEM
00001E 011E D8              11      RET C
00001F 011F 211D01          10      LD  HL,0011DH
000022 0122 ED42            15      SBC HL,BC
000024 0124 78               4      LD  A,B
000025 0125 32960A          13      LD  (MAJOR_VER),A
000028 0128 B5               4      OR  L
000029 0129 32950A          13      LD  (IS_MSX),A
00002C 012C B7               4      OR  A
00002D 012D 281D            12      JR  Z,WSTART
00002F 012F 2A0600          16      LD  HL,(SYSTEM+1)
000032 0132 2EDB             7      LD  L,256-37
000034 0134 24               4      INC H
000035 0135 22900B          16      LD  (FCB_BAT),HL
000038 0138 3A8000          13      LD  A,(DTA1)
00003B 013B B7               4      OR  A
00003C 013C 280E            12      JR  Z,WSTART
00003E 013E 110301          10      LD  DE,VER
000041 0141 0E09             7      LD  C,9
000043 0143 CD0500          17      CALL    SYSTEM
000046 0146 118100          10      LD  DE,DTA1+1
000049 0149 CD8F01          17      CALL    COMANL
       014C                     WSTART:
00004C 014C CD4F04          17      CALL    LTNL
       014F                     COMMAND:
00004F 014F E5              11      PUSH    HL
000050 0150 2A900B          16      LD  HL,(FCB_BAT)
000053 0153 7E               7      LD  A,(HL)
000054 0154 E1              10      POP HL
000055 0155 B7               4      OR  A
000056 0156 C22D03          10      JP  NZ,C_BAT1
000059 0159 CD7202          17      CALL    SETDTA1
00005C 015C D5              11      PUSH    DE
00005D 015D C5              11      PUSH    BC
00005E 015E E5              11      PUSH    HL
00005F 015F 0E19             7      LD  C,019H      ;(BDOS)_CURDRV デフォルトドライブの獲得
000061 0161 CD0500          17      CALL    SYSTEM
000064 0164 E1              10      POP HL
000065 0165 C1              10      POP BC
000066 0166 C641             7      ADD A,'A'
000068 0168 5F               4      LD  E,A
000069 0169 CD9207          17      CALL    _PRINT
00006C 016C 1E3E             7      LD  E,'>'
00006E 016E CD9207          17      CALL    _PRINT
000071 0171 D1              10      POP DE      ;DE=DTA1
000072 0172 3E50             7      LD  A,80
000074 0174 12               7      LD  (DE),A
000075 0175 0E0A             7      LD  C,0AH       ;(BDOS)文字列入力
000077 0177 CD0500          17      CALL    SYSTEM
00007A 017A CD4F04          17      CALL    LTNL
       017D                     COMMAND2:
00007D 017D 118200          10      LD  DE,DTA1+2
000080 0180 CD8F01          17      CALL    COMANL
000083 0183 30CA            12      JR  NC,COMMAND
000085 0185 11730A          10      LD  DE,COMERM
000088 0188 0E09             7      LD  C,9     ;(BDOS)文字列出力
00008A 018A CD0500          17      CALL    SYSTEM
00008D 018D 18BD            12      JR  WSTART
                                
       018F                     COMANL:
00008F 018F CDDC07          17      CALL    FILE
000092 0192 D5              11      PUSH    DE
000093 0193 116A0B          10      LD  DE,FNAME
000096 0196 1A               7      LD  A,(DE)
000097 0197 FE20             7      CP  020H
000099 0199 284E            12      JR  Z,SDVSW
00009B 019B 1B               6      DEC DE
00009C 019C 1A               7      LD  A,(DE)
00009D 019D C6FF             7      ADD A,0FFH
00009F 019F 380A            12      JR  C,COMB
0000A1 01A1 13               6      INC DE
                                
0000A2 01A2 21070A          10      LD  HL,COMTB
0000A5 01A5 3E0B             7      LD  A,COMS
0000A7 01A7 47               4      LD  B,A
0000A8 01A8 CD0409          17      CALL    CPNAME
       01AB                     COMB:
0000AB 01AB D1              10      POP DE
0000AC 01AC D29107          10      JP  NC,JP_HL
       01AF                     COMB2:
0000AF 01AF EB               4      EX  DE,HL
0000B0 01B0 22F602          16      LD  (COMPAT+1),HL
0000B3 01B3 F5              11      PUSH    AF
0000B4 01B4 CD9A02          17      CALL    CEXE4
0000B7 01B7 F1              10      POP AF
0000B8 01B8 216A0B          10      LD  HL,FNAME
0000BB 01BB 116D00          10      LD  DE,FCB2+1   ;COMMAND NAME
0000BE 01BE 010B00          10      LD  BC,11
0000C1 01C1 EDB0                    LDIR
0000C3 01C3 1140F6          10      LD  DE,PATHD
0000C6 01C6 3A950A          13      LD  A,(IS_MSX)
0000C9 01C9 B7               4      OR  A
0000CA 01CA 2003            12      JR  NZ,CEX1
0000CC 01CC 118F0B          10      LD  DE,ZERO
       01CF                     CEX1:
0000CF 01CF 1A               7      LD  A,(DE)
0000D0 01D0 FE20             7      CP  020H
0000D2 01D2 D8              11      RET C
0000D3 01D3 CDD107          17      CALL    FILEC
0000D6 01D6 D5              11      PUSH    DE
0000D7 01D7 216D00          10      LD  HL,FCB2+1   ;COMMAND NAME
0000DA 01DA 116A0B          10      LD  DE,FNAME
0000DD 01DD 010B00          10      LD  BC,11
0000E0 01E0 EDB0                    LDIR
0000E2 01E2 CD9A02          17      CALL    CEXE4
0000E5 01E5 D1              10      POP DE
0000E6 01E6 13               6      INC DE
0000E7 01E7 18E6            12      JR  CEX1
                                
       01E9                     SDVSW:
0000E9 01E9 F1              10      POP AF
0000EA 01EA 3A690B          13      LD  A,(FDRV)
0000ED 01ED 3D               4      DEC A
0000EE 01EE 5F               4      LD  E,A
0000EF 01EF 0E0E             7      LD  C,00EH      ;(BDOS)カレントドライブの設定
0000F1 01F1 C37902          10      JP  SYSTEM0
                                
       01F4                     OPEN1_D2:           ;DOS2対応
0000F4 01F4 3A960A          13      LD  A,(MAJOR_VER)
0000F7 01F7 FE02             7      CP  2
0000F9 01F9 382C            12      JR  C,OPEN1
                                
0000FB 01FB 11D70A          10      LD  DE,PATH_CCP
0000FE 01FE DD21970A        14      LD  IX,SEARCH_IX
000102 0202 014010          10      LD  BC,01040H   ;(BDOS)最初のエントリ検索
000105 0205 CD0500          17      CALL    SYSTEM
       0208                     FIB2DIRENT:
000108 0208 B7               4      OR  A
000109 0209 C0              11      RET NZ
                                
00010A 020A 11980A          10      LD  DE,SEARCH_IX+1
00010D 020D 21340B          10      LD  HL,DTA_CCP+1
000110 0210 0E5C             7      LD  C,05CH      ;(BDOS)ファイル名の解析
000112 0212 CD0500          17      CALL    SYSTEM
                                
000115 0215 21A50A          10      LD  HL,SEARCH_IX+14
000118 0218 113F0B          10      LD  DE,DTA_CCP+1+8+3
00011B 021B EDA0            16      LDI
00011D 021D 114A0B          10      LD  DE,DTA_CCP+1+8+3+1+10
000120 0220 010A00          10      LD  BC,2+2+2+4  ;最終変更時刻+最終変更日付+開始クラスタ+ファイルサイズ
000123 0223 EDB0                    LDIR
000125 0225 AF               4      XOR A
000126 0226 C9              10      RET
                                
       0227                     OPEN1:
000127 0227 21690B          10      LD  HL,FDRV
       022A                     OPEN:
00012A 022A 0E11             7      LD  C,011H      ;(BDOS)最初のファイルの検索
       022C                     OPEN3:
00012C 022C D5              11      PUSH    DE
00012D 022D 11330B          10      LD  DE,DTA_CCP
000130 0230 CD6602          17      CALL    SETDTA
000133 0233 EB               4      EX  DE,HL
000134 0234 CD0500          17      CALL    SYSTEM
000137 0237 D1              10      POP DE
000138 0238 B7               4      OR  A
000139 0239 C9              10      RET
                                
       023A                     OPEN2_D2:           ;DOS2対応
00013A 023A 3A960A          13      LD  A,(MAJOR_VER)
00013D 023D FE02             7      CP  2
00013F 023F 380B            12      JR  C,OPEN2
000141 0241 DD21970A        14      LD  IX,SEARCH_IX
000145 0245 0E41             7      LD  C,41H       ;(BDOS)次のエントリ検索
000147 0247 CD0500          17      CALL    SYSTEM
00014A 024A 18BC            12      JR  FIB2DIRENT
       024C                     OPEN2:
00014C 024C 0E12             7      LD  C,012H
00014E 024E 18DC            12      JR  OPEN3
                                
       0250                     DEFCB:              ;Z=Ok NZ=Error
000150 0250 11330B          10      LD  DE,DTA_CCP
000153 0253 CD7702          17      CALL    SYSC0F
                                
000156 0256 210100          10      LD  HL,1
000159 0259 22410B          16      LD  (DTA_CCP+14),HL
00015C 025C 2D               4      DEC L
00015D 025D 22540B          16      LD  (DTA_CCP+33),HL
000160 0260 22560B          16      LD  (DTA_CCP+35),HL
       0263                     SETDTA100:
000163 0263 110080          10      LD  DE,DATA
       0266                     SETDTA:
000166 0266 C5              11      PUSH    BC
000167 0267 D5              11      PUSH    DE
000168 0268 E5              11      PUSH    HL
000169 0269 0E1A             7      LD  C,01AH      ;(BDOS)DTAの設定
00016B 026B CD0500          17      CALL    SYSTEM
00016E 026E E1              10      POP HL
00016F 026F D1              10      POP DE
000170 0270 C1              10      POP BC
000171 0271 C9              10      RET
                                
       0272                     SETDTA1:
000172 0272 118000          10      LD  DE,DTA1
000175 0275 18EF            12      JR  SETDTA
                                
       0277                     SYSC0F:
000177 0277 0E0F             7      LD  C,00FH      ;(BDOS)ファイルのオープン
       0279                     SYSTEM0:
000179 0279 CD0500          17      CALL    SYSTEM
00017C 027C B7               4      OR  A
00017D 027D C9              10      RET
                                
       027E                     C_CD:
00017E 027E CDAE07          17      CALL    FILEC_D2
000181 0281 11D70A          10      LD  DE,PATH_CCP
000184 0284 0E5A             7      LD  C,5AH       ;(BDOS)_CHDIR カレントディレクトリの変更
000186 0286 C30500          10      JP  SYSTEM
                                
       0289                     S27DTA:
000189 0289 110100          10      LD  DE,1
00018C 028C ED53410B        20      LD  (DTA_CCP+14),DE
000190 0290 11330B          10      LD  DE,DTA_CCP
       0293                     S27:
000193 0293 0E27             7      LD  C,027H      ;(BDOS)ランダム・ブロック・リード
000195 0295 CD0500          17      CALL    SYSTEM
000198 0298 B7               4      OR  A
000199 0299 C9              10      RET
                                
       029A                     CEXE4:
00019A 029A 21720B          10      LD  HL,FNAME+8
00019D 029D 7E               7      LD  A,(HL)
00019E 029E FE20             7      CP  020H
0001A0 02A0 2007            12      JR  NZ,CEXE7
0001A2 02A2 3E3F             7      LD  A,'?'
0001A4 02A4 77               7      LD  (HL),A
0001A5 02A5 23               6      INC HL
0001A6 02A6 77               7      LD  (HL),A
0001A7 02A7 23               6      INC HL
0001A8 02A8 77               7      LD  (HL),A
       02A9                     CEXE7:
0001A9 02A9 CD2702          17      CALL    OPEN1
       02AC                     CEXE5:
0001AC 02AC C0              11      RET NZ
0001AD 02AD 2A3D0B          16      LD  HL,(DTA_CCP+1+9)
0001B0 02B0 7C               4      LD  A,H
0001B1 02B1 CDBF08          17      CALL    CAP
0001B4 02B4 67               4      LD  H,A
0001B5 02B5 7D               4      LD  A,L
0001B6 02B6 CDBF08          17      CALL    CAP
0001B9 02B9 6F               4      LD  L,A
0001BA 02BA 3A3C0B          13      LD  A,(DTA_CCP+1+8)
0001BD 02BD CDBF08          17      CALL    CAP
0001C0 02C0 D642             7      SUB 'B'
0001C2 02C2 2853            12      JR  Z,C_BAT
0001C4 02C4 3D               4      DEC A       ;'C'
0001C5 02C5 2805            12      JR  Z,C_EXE
       02C7                     CEXE6:
0001C7 02C7 CD4C02          17      CALL    OPEN2
0001CA 02CA 18E0            12      JR  CEXE5
                                
       02CC                     C_EXE:
0001CC 02CC 7C               4      LD  A,H
0001CD 02CD FE4D             7      CP  'M'
0001CF 02CF 20F6            12      JR  NZ,CEXE6
                                
0001D1 02D1 CD5002          17      CALL    DEFCB
                                
0001D4 02D4 11D20B          10      LD  DE,DATA_COM
0001D7 02D7 CD6602          17      CALL    SETDTA
                                
0001DA 02DA 2A0600          16      LD  HL,(SYSTEM+1)
0001DD 02DD 11D20B          10      LD  DE,DATA_COM
0001E0 02E0 ED52            15      SBC HL,DE
                                
0001E2 02E2 CD8902          17      CALL    S27DTA
0001E5 02E5 3D               4      DEC A
0001E6 02E6 37               4      SCF
0001E7 02E7 C0              11      RET NZ
0001E8 02E8 7C               4      LD  A,H
0001E9 02E9 B5               4      OR  L
0001EA 02EA 37               4      SCF
0001EB 02EB C8              11      RET Z
0001EC 02EC 221103          16      LD  (COMSIZ+1),HL
                                
0001EF 02EF 11D20B          10      LD  DE,DATA_COM
0001F2 02F2 CD6602          17      CALL    SETDTA
0001F5 02F5 110000          10  COMPAT: LD  DE,0
0001F8 02F8 CD9505          17      CALL    SETFCB
                                
0001FB 02FB AF               4      XOR A
0001FC 02FC 67               4      LD  H,A
0001FD 02FD 6F               4      LD  L,A ;HL=0x0000
0001FE 02FE F3               4      DI
0001FF 02FF ED7B0600        20  SPPAT:  LD  SP,(SYSTEM+1)
000203 0303 E5              11      PUSH    HL
000204 0304 21EDB0          10      LD  HL,0B0EDH   ;LDIR
000207 0307 22FE00          16      LD  (000FEH),HL
00020A 030A 21D20B          10      LD  HL,DATA_COM
00020D 030D 110001          10      LD  DE,00100H
000210 0310 010000          10  COMSIZ: LD  BC,0
000213 0313 FB               4      EI
000214 0314 C3FE00          10      JP  000FEH
                                
       0317                     C_BAT:
000217 0317 114154          10      LD  DE,'A'+'T'*256
00021A 031A ED52            15      SBC HL,DE
00021C 031C 20A9            12      JR  NZ,CEXE6
                                
00021E 031E CD5002          17      CALL    DEFCB
                                
000221 0321 21330B          10      LD  HL,DTA_CCP
000224 0324 ED5B900B        20      LD  DE,(FCB_BAT)
000228 0328 012500          10      LD  BC,37
00022B 032B EDB0                    LDIR
       032D                     C_BAT1:
00022D 032D CD6302          17      CALL    SETDTA100
000230 0330 CD6E03          17      CALL    FGETC_BAT
000233 0333 218100          10      LD  HL,DTA1+1
000236 0336 202A            12      JR  NZ,END_BATCH
000238 0338 FE21             7      CP  021H        ;スペースや改行など制御文字を飛ばす
00023A 033A 38F1            12      JR  C,C_BAT1
00023C 033C 3620            10      LD  (HL),' '
00023E 033E 23               6      INC HL
       033F                     C_BAT2:
00023F 033F 77               7      LD  (HL),A
000240 0340 23               6      INC HL
000241 0341 7D               4      LD  A,L
000242 0342 3C               4      INC A       ;L==0FFH
000243 0343 2809            12      JR  Z,RUN_BATCH
000245 0345 CD6E03          17      CALL    FGETC_BAT
000248 0348 2004            12      JR  NZ,RUN_BATCH
00024A 034A FE20             7      CP  020H
00024C 034C 30F1            12      JR  NC,C_BAT2
       034E                     RUN_BATCH:
00024E 034E 7D               4      LD  A,L
00024F 034F D67F             7      SUB DTA1-1
000251 0351 328000          13      LD  (DTA1),A
000254 0354 FE04             7      CP  4
000256 0356 380A            12      JR  C,END_BATCH
000258 0358 3600            10      LD  (HL),0
00025A 035A 3A9BFC          13      LD  A,(INTFLG)
00025D 035D FE03             7      CP  3
00025F 035F C27D01          10      JP  NZ,COMMAND2
       0362                     END_BATCH:      ;バッチファイルを閉じる
000262 0362 2A900B          16      LD  HL,(FCB_BAT)
000265 0365 3600            10      LD  (HL),0
000267 0367 ED7B0600        20      LD  SP,(SYSTEM+1)
00026B 036B C34C01          10      JP  WSTART
                                
       036E                     FGETC_BAT:
00026E 036E ED5B900B        20      LD  DE,(FCB_BAT)
       0372                     FGETC:              ;1文字ずつ読み込む
000272 0372 E5              11      PUSH    HL      ;Z:成功
000273 0373 210100          10      LD  HL,1
000276 0376 CD9302          17      CALL    S27
000279 0379 E1              10      POP HL
00027A 037A 3A0080          13      LD  A,(DATA)
00027D 037D C9              10      RET
                                
       037E                     C_REM:
00027E 037E AF               4      XOR A
00027F 037F C9              10      RET
                                
       0380                     C_DEL:
000280 0380 CD9505          17      CALL    SETFCB
000283 0383 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力
000285 0385 CD0500          17      CALL    SYSTEM
                                
000288 0388 0E13             7      LD  C,013H
00028A 038A 180A            12      JR  CDEL1       ;(BDOS)ファイルの削除
                                
       038C                     C_REN:
00028C 038C CD9505          17      CALL    SETFCB
00028F 038F 3E10             7      LD  A,010H      ;ディレクトリも対象にする(LSX-Dodgers)
000291 0391 326900          13      LD  (FCB1+13),A ;属性
000294 0394 0E17             7      LD  C,017H      ;(BDOS)ファイル名の変更
       0396                     CDEL1:
000296 0396 115C00          10      LD  DE,FCB1
000299 0399 CD0500          17      CALL    SYSTEM
00029C 039C C6FF             7      ADD A,0FFH
00029E 039E C9              10      RET
                                
       039F                     C_DIR:
00029F 039F CDAE07          17      CALL    FILEC_D2
0002A2 03A2 216A0B          10      LD  HL,FDRV+1
0002A5 03A5 CD7707          17      CALL    CWILD1
0002A8 03A8 3EF1             7      LD  A,0F1H
0002AA 03AA 32760B          13      LD  (FDRV+13),A
0002AD 03AD CDF401          17      CALL    OPEN1_D2
       03B0                     CDIR1:
0002B0 03B0 B7               4      OR  A
0002B1 03B1 2008            12      JR  NZ,PDSKF
0002B3 03B3 CD2704          17      CALL    P_NAME
0002B6 03B6 CD3A02          17      CALL    OPEN2_D2
0002B9 03B9 18F5            12      JR  CDIR1
                                
       03BB                     PDSKF:
0002BB 03BB 3A690B          13      LD  A,(FDRV)
0002BE 03BE 5F               4      LD  E,A
0002BF 03BF 0E1B             7      LD  C,01BH      ;(BDOS)ディスク情報の獲得
0002C1 03C1 CD0500          17      CALL    SYSTEM
0002C4 03C4 4F               4      LD  C,A     ;C←1クラスタ辺りの論理セクタ数
0002C5 03C5 C601             7      ADD A,001H
0002C7 03C7 D8              11      RET C       ;Aが0FFHだった場合
0002C8 03C8 3E06             7      LD  A,8-2
       03CA                     PDS1:               ;HL=未使用クラスタの総数
0002CA 03CA 3C               4      INC A
0002CB 03CB CB19             8      RR  C
0002CD 03CD 30FB            12      JR  NC,PDS1
       03CF                     PDS2:               ;B←論理セクタのサイズの上位8ビット
0002CF 03CF 3C               4      INC A
0002D0 03D0 CB18             8      RR  B
0002D2 03D2 30FB            12      JR  NC,PDS2
0002D4 03D4 47               4      LD  B,A
                                
0002D5 03D5 110000          10      LD  DE,0
       03D8                     PDS3:
0002D8 03D8 29              11      ADD HL,HL
0002D9 03D9 EB               4      EX  DE,HL
0002DA 03DA ED6A            15      ADC HL,HL
0002DC 03DC EB               4      EX  DE,HL
0002DD 03DD 10F9            13      DJNZ    PDS3
       03DF                     PDSKF1:
0002DF 03DF CDA004          17      CALL    PRDEC_DEHL
0002E2 03E2 11540A          10      LD  DE,FREE
0002E5 03E5 0E09             7      LD  C,9     ;(BDOS)文字列出力
0002E7 03E7 CD0500          17      CALL    SYSTEM
0002EA 03EA CD8004          17      CALL    PUTDRV
0002ED 03ED 3E5C             7      LD  A,05CH
0002EF 03EF CD9F07          17      CALL    MSG_A
0002F2 03F2 3A960A          13      LD  A,(MAJOR_VER)
0002F5 03F5 FE01             7      CP  1
0002F7 03F7 3856            12      JR  C,LTNL
0002F9 03F9 200E            12      JR  NZ,PDSKF2
0002FB 03FB 2A770B          16      LD  HL,(FDRV+14)
0002FE 03FE AF               4      XOR A
0002FF 03FF 11FEFF          10      LD  DE,0-2
000302 0402 19              11      ADD HL,DE
000303 0403 23               6      INC HL
000304 0404 DC9C04          17      CALL    C,PRDEC_HL
000307 0407 1846            12      JR  LTNL
       0409                     PDSKF2:             ;MSX-DOS2
000309 0409 3A690B          13      LD  A,(FDRV)
00030C 040C 47               4      LD  B,A     ;ドライブ
00030D 040D 110080          10      LD  DE,DATA
000310 0410 0E59             7      LD  C,059H      ;(BDOS)GETCD カレントディレクトリの獲得
000312 0412 CD0500          17      CALL    SYSTEM
000315 0415 210080          10      LD  HL,DATA
                                
000318 0418 CD2104          17      CALL    MSX
00031B 041B 1832            12      JR  LTNL
                                
       041D                     MSX1:
00031D 041D 5F               4      LD  E,A
00031E 041E CD9207          17      CALL    _PRINT
       0421                     MSX:
000321 0421 7E               7      LD  A,(HL)
000322 0422 23               6      INC HL
000323 0423 B7               4      OR  A
000324 0424 20F7            12      JR  NZ,MSX1
000326 0426 C9              10      RET
                                
       0427                     P_NAME:
000327 0427 21340B          10      LD  HL,DTA_CCP+1
00032A 042A 7E               7      LD  A,(HL)
00032B 042B FE2E             7      CP  '.'
00032D 042D C8              11      RET Z
00032E 042E CDF604          17      CALL    FPRNT
000331 0431 3A3F0B          13      LD  A,(DTA_CCP+12)
000334 0434 CB67             8      BIT 4,A
000336 0436 280A            12      JR  Z,DIR3
000338 0438 11620A          10      LD  DE,DIRMES
00033B 043B 0E09             7      LD  C,9     ;(BDOS)文字列出力
00033D 043D CD0500          17      CALL    SYSTEM
000340 0440 180A            12      JR  DIR6
       0442                     DIR3:
000342 0442 ED5B520B        20      LD  DE,(DTA_CCP+1+01EH)
000346 0446 2A500B          16      LD  HL,(DTA_CCP+1+01CH)
000349 0449 CDA004          17      CALL    PRDEC_DEHL
       044C                     DIR6:
00034C 044C CD1805          17      CALL    PRTTMS
                                
       044F                     LTNL:
00034F 044F 1E0D             7      LD  E,00DH
000351 0451 CD9207          17      CALL    _PRINT
000354 0454 1E0A             7      LD  E,00AH
000356 0456 C39207          10      JP  _PRINT
                                
       0459                     C_PATH:
000359 0459 3A950A          13      LD  A,(IS_MSX)
00035C 045C B7               4      OR  A
00035D 045D C8              11      RET Z
00035E 045E CDB908          17      CALL    SPCUT
000361 0461 2140F6          10      LD  HL,PATHD
000364 0464 FE21             7      CP  021H
000366 0466 300C            12      JR  NC,CPATH0
       0468                     CPATHP:
000368 0468 7E               7      LD  A,(HL)
000369 0469 23               6      INC HL
00036A 046A FE20             7      CP  020H
00036C 046C 3F               4      CCF
00036D 046D 30E0            12      JR  NC,LTNL
00036F 046F CD9F07          17      CALL    MSG_A
000372 0472 18F4            12      JR  CPATHP
       0474                     CPATH0:
000374 0474 FE3B             7      CP  ';'
000376 0476 2001            12      JR  NZ,CPATH1
000378 0478 13               6      INC DE
       0479                     CPATH1:
000379 0479 EB               4      EX  DE,HL
00037A 047A 012000          10      LD  BC,PATHX
00037D 047D EDB0                    LDIR
00037F 047F C9              10      RET
                                
       0480                     PUTDRV:
000380 0480 3A690B          13      LD  A,(FDRV)
000383 0483 B7               4      OR  A
000384 0484 200C            12      JR  NZ,PUTDRV1
000386 0486 C5              11      PUSH    BC
000387 0487 D5              11      PUSH    DE
000388 0488 E5              11      PUSH    HL
000389 0489 0E19             7      LD  C,019H
00038B 048B CD0500          17      CALL    SYSTEM
00038E 048E E1              10      POP HL
00038F 048F D1              10      POP DE
000390 0490 C1              10      POP BC
000391 0491 3C               4      INC A
       0492                     PUTDRV1:
000392 0492 C640             7      ADD A,'A'-1
000394 0494 CD9F07          17      CALL    MSG_A
000397 0497 3E3A             7      LD  A,':'
       0499                     MSG_AR:
000399 0499 C39F07          10      JP  MSG_A
                                
       049C                     PRDEC_HL:
00039C 049C AF               4      XOR A
       049D                     PRDEC_AHL:
00039D 049D 5F               4      LD  E,A
00039E 049E 1600             7      LD  D,0
       04A0                     PRDEC_DEHL:
0003A0 04A0 3E02             7      LD  A,2
0003A2 04A2 32EB04          13      LD  (DEC6+1),A
0003A5 04A5 AF               4      XOR A
0003A6 04A6 E5              11      PUSH    HL
0003A7 04A7 21630B          10      LD  HL,DECBF
0003AA 04AA 0605             7      LD  B,5
0003AC 04AC CD8008          17      CALL    FILL_MEMORY
0003AF 04AF E1              10      POP HL
                                
0003B0 04B0 0E20             7      LD  C,32
       04B2                     DEC1:
0003B2 04B2 29              11      ADD HL,HL
0003B3 04B3 EB               4      EX  DE,HL
0003B4 04B4 ED6A            15      ADC HL,HL
0003B6 04B6 EB               4      EX  DE,HL
0003B7 04B7 E5              11      PUSH    HL
0003B8 04B8 21670B          10      LD  HL,DECBF+4
0003BB 04BB 0605             7      LD  B,5
       04BD                     DEC2:
0003BD 04BD 7E               7      LD  A,(HL)
0003BE 04BE 8F               4      ADC A,A
0003BF 04BF 27               4      DAA
0003C0 04C0 77               7      LD  (HL),A
0003C1 04C1 2B               6      DEC HL
0003C2 04C2 10F9            13      DJNZ    DEC2
0003C4 04C4 E1              10      POP HL
0003C5 04C5 0D               4      DEC C
0003C6 04C6 20EA            12      JR  NZ,DEC1
                                
0003C8 04C8 21630B          10      LD  HL,DECBF
0003CB 04CB 3E20             7      LD  A,020H
0003CD 04CD 0604             7      LD  B,4
       04CF                     DEC3:
0003CF 04CF CDDC04          17      CALL    DEC4
0003D2 04D2 CDDC04          17      CALL    DEC4
0003D5 04D5 23               6      INC HL
0003D6 04D6 10F7            13      DJNZ    DEC3
       04D8                     DECX:
0003D8 04D8 CDDC04          17      CALL    DEC4
0003DB 04DB AF               4      XOR A
       04DC                     DEC4:
0003DC 04DC ED6F            18      RLD
0003DE 04DE FE20             7      CP  020H
0003E0 04E0 2808            12      JR  Z,DEC6
0003E2 04E2 F630             7      OR  030H
       04E4                     DEC5:
0003E4 04E4 18B3            12      JR  MSG_AR
       04E6                     DEC7:
0003E6 04E6 3E20             7      LD  A,020H
0003E8 04E8 18AF            12      JR  MSG_AR
       04EA                     DEC6:
0003EA 04EA 3E02             7      LD  A,2
0003EC 04EC B7               4      OR  A
0003ED 04ED 28F7            12      JR  Z,DEC7
0003EF 04EF 3D               4      DEC A
0003F0 04F0 32EB04          13      LD  (DEC6+1),A
0003F3 04F3 3E20             7      LD  A,020H
0003F5 04F5 C9              10      RET
                                
       04F6                     FPRNT:
0003F6 04F6 0608             7      LD  B,8
0003F8 04F8 CD0905          17      CALL    P_N1
0003FB 04FB 7E               7      LD  A,(HL)
0003FC 04FC C680             7      ADD A,0A0H-020H
0003FE 04FE FEA0             7      CP  0A0H
000400 0500 2802            12      JR  Z,FPR1
000402 0502 3E2E             7      LD  A,'.'
       0504                     FPR1:
000404 0504 CD9F07          17      CALL    MSG_A
000407 0507 0603             7      LD  B,3
                                
       0509                     P_N1:
000409 0509 C5              11      PUSH    BC
00040A 050A E5              11      PUSH    HL
00040B 050B 7E               7      LD  A,(HL)
00040C 050C CDCB08          17      CALL    CAP3
00040F 050F CD9F07          17      CALL    MSG_A
000412 0512 E1              10      POP HL
000413 0513 C1              10      POP BC
000414 0514 23               6      INC HL
000415 0515 10F2            13      DJNZ    P_N1
000417 0517 C9              10      RET
                                
       0518                     PRTTMS:
000418 0518 3E20             7      LD  A,020H
00041A 051A CD9F07          17      CALL    MSG_A
                                
00041D 051D 2A4C0B          16      LD  HL,(DTA_CCP+1+24)
000420 0520 7D               4      LD  A,L
000421 0521 B7               4      OR  A
000422 0522 C8              11      RET Z
000423 0523 CB3C             8      SRL H
000425 0525 17               4      RLA
000426 0526 17               4      RLA
000427 0527 17               4      RLA
000428 0528 17               4      RLA
000429 0529 E60F             7      AND 00FH
00042B 052B 57               4      LD  D,A
00042C 052C 7C               4      LD  A,H
00042D 052D C650             7      ADD A,80
00042F 052F CD8005          17      CALL    PRDEC_A
000432 0532 3E2D             7      LD  A,'-'
000434 0534 CD9F07          17      CALL    MSG_A
000437 0537 7A               4      LD  A,D
000438 0538 CD8005          17      CALL    PRDEC_A
00043B 053B 3E2D             7      LD  A,'-'
00043D 053D CD9F07          17      CALL    MSG_A
000440 0540 7D               4      LD  A,L
000441 0541 E61F             7      AND 01FH
000443 0543 CD8005          17      CALL    PRDEC_A
                                
000446 0546 CD6D09          17      CALL    GET_WIDTH
000449 0549 FE21             7      CP  32+1
00044B 054B 3005            12      JR  NC,SHOW_TIME
00044D 054D 3E1D             7      LD  A,01DH
00044F 054F C39F07          10      JP  MSG_A
       0552                     SHOW_TIME:
000452 0552 2A4A0B          16      LD  HL,(DTA_CCP+1+22)
                                
000455 0555 3E20             7      LD  A,020H
000457 0557 CD9F07          17      CALL    MSG_A
00045A 055A 7C               4      LD  A,H
00045B 055B 65               4      LD  H,L
00045C 055C 1F               4      RRA
00045D 055D CB1D             8      RR  L
00045F 055F 1F               4      RRA
000460 0560 CB1D             8      RR  L
000462 0562 1F               4      RRA
000463 0563 CB1D             8      RR  L
000465 0565 E61F             7      AND 01FH
000467 0567 CD8005          17      CALL    PRDEC_A
00046A 056A 3E3A             7      LD  A,':'
00046C 056C CD9F07          17      CALL    MSG_A
00046F 056F 7D               4      LD  A,L
000470 0570 0F               4      RRCA
000471 0571 0F               4      RRCA
000472 0572 E63F             7      AND 03FH
000474 0574 CD8005          17      CALL    PRDEC_A
                                
000477 0577 3E3A             7      LD  A,':'
000479 0579 CD9F07          17      CALL    MSG_A
00047C 057C 7C               4      LD  A,H
00047D 057D E61F             7      AND 01FH
00047F 057F 87               4      ADD A,A
                                
                                ;   PRINT10
                                
       0580                     PRDEC_A:
000480 0580 E5              11      PUSH    HL
000481 0581 0608             7      LD  B,8
000483 0583 4F               4      LD  C,A
000484 0584 AF               4      XOR A
       0585                     PRTA1:
000485 0585 CB01             4      RLC C
000487 0587 8F               4      ADC A,A
000488 0588 27               4      DAA
000489 0589 10FA            13      DJNZ    PRTA1
00048B 058B 21630B          10      LD  HL,DECBF
00048E 058E 77               7      LD  (HL),A
00048F 058F AF               4      XOR A
000490 0590 CDD804          17      CALL    DECX
000493 0593 E1              10      POP HL
000494 0594 C9              10      RET
                                
       0595                     SETFCB:
000495 0595 CDB908          17      CALL    SPCUT
000498 0598 1A               7      LD  A,(DE)
000499 0599 FE20             7      CP  020H
00049B 059B 3801            12      JR  C,SETFCBA
00049D 059D 1B               6      DEC DE
       059E                     SETFCBA:
00049E 059E D5              11      PUSH    DE
00049F 059F 215C00          10      LD  HL,FCB1
0004A2 05A2 115D00          10      LD  DE,FCB1+1
0004A5 05A5 012300          10      LD  BC,00023H
0004A8 05A8 70               7      LD  (HL),B      ;B=0
0004A9 05A9 EDB0                    LDIR
0004AB 05AB D1              10      POP DE
0004AC 05AC D5              11      PUSH    DE
0004AD 05AD 215C00          10      LD  HL,FCB1
0004B0 05B0 CD5009          17      CALL    _SYS29      ;ファイル名の解析
0004B3 05B3 216C00          10      LD  HL,FCB2
0004B6 05B6 CD5009          17      CALL    _SYS29      ;ファイル名の解析
0004B9 05B9 E1              10      POP HL
0004BA 05BA 010050          10      LD  BC,05000H
0004BD 05BD 118100          10      LD  DE,00081H
       05C0                     SETFCB1:
0004C0 05C0 7E               7      LD  A,(HL)
0004C1 05C1 23               6      INC HL
0004C2 05C2 FE20             7      CP  020H
0004C4 05C4 3805            12      JR  C,SETFCB2
0004C6 05C6 12               7      LD  (DE),A
0004C7 05C7 13               6      INC DE
0004C8 05C8 0C               4      INC C
0004C9 05C9 10F5            13      DJNZ    SETFCB1
       05CB                     SETFCB2:
0004CB 05CB 79               4      LD  A,C
0004CC 05CC 328000          13      LD  (DTA1),A
0004CF 05CF 04               4      INC B
0004D0 05D0 AF               4      XOR A
       05D1                     SETFCB3:
0004D1 05D1 12               7      LD  (DE),A
0004D2 05D2 13               6      INC DE
0004D3 05D3 10FC            13      DJNZ    SETFCB3
0004D5 05D5 C9              10      RET
                                
       05D6                     C_COPY:
0004D6 05D6 CD9505          17      CALL    SETFCB
                                
0004D9 05D9 118F0B          10      LD  DE,ZERO
0004DC 05DC CDD407          17      CALL    FILEC2
0004DF 05DF 216C00          10      LD  HL,FCB2
0004E2 05E2 CD5709          17      CALL    S29X1
                                
0004E5 05E5 3E10             7      LD  A,010H
0004E7 05E7 326900          13      LD  (FCB1+13),A
0004EA 05EA 216D00          10      LD  HL,FCB2+1
0004ED 05ED CD7707          17      CALL    CWILD1
       05F0                     COPY0:
0004F0 05F0 CD7407          17      CALL    CWILD
0004F3 05F3 215C00          10      LD  HL,FCB1
0004F6 05F6 CD2A02          17      CALL    OPEN
0004F9 05F9 37               4      SCF
       05FA                     COPY1:
0004FA 05FA C0              11      RET NZ
0004FB 05FB CD5002          17      CALL    DEFCB
                                
0004FE 05FE 3A400B          13      LD  A,(DTA_CCP+13)
000501 0601 CB67             8      BIT 4,A
000503 0603 2823            12      JR  Z,COPY1A
                                
000505 0605 215D00          10      LD  HL,FCB1+1
000508 0608 CDF808          17      CALL    CHKWILD
00050B 060B 3816            12      JR  C,COPY9
                                
00050D 060D 3E20             7      LD  A,020H
00050F 060F 325D00          13      LD  (FCB1+1),A
000512 0612 2A4D0B          16      LD  HL,(DTA_CCP+26)
000515 0615 23               6      INC HL
000516 0616 226A00          16      LD  (FCB1+14),HL
000519 0619 18D5            12      JR  COPY0
                                
       061B                     COPY8:
00051B 061B 0E09             7      LD  C,9     ;(BDOS)文字列出力
00051D 061D CD0500          17      CALL    SYSTEM
000520 0620 CD4F04          17      CALL    LTNL
       0623                     COPY9:
000523 0623 CD4C02          17      CALL    OPEN2
000526 0626 18D2            12      JR  COPY1
                                
       0628                     COPY1A:
000528 0628 216C00          10      LD  HL,FCB2
00052B 062B 11690B          10      LD  DE,FDRV
00052E 062E 01350B          10      LD  BC,DTA_CCP+2
000531 0631 EDA0            16      LDI
000533 0633 3E0B             7      LD  A,11
       0635                     COPY2:
000535 0635 F5              11      PUSH    AF
000536 0636 7E               7      LD  A,(HL)
000537 0637 FE3F             7      CP  '?'
000539 0639 2001            12      JR  NZ,COPY3
00053B 063B 0A               7      LD  A,(BC)
       063C                     COPY3:
00053C 063C 12               7      LD  (DE),A
00053D 063D 03               6      INC BC
00053E 063E 13               6      INC DE
00053F 063F 23               6      INC HL
000540 0640 F1              10      POP AF
000541 0641 3D               4      DEC A
000542 0642 20F1            12      JR  NZ,COPY2
000544 0644 010500          10      LD  BC,16-11
000547 0647 EDB0                    LDIR
       0649                     PUTNAME:
000549 0649 215D00          10      LD  HL,FCB1+1
00054C 064C CDF808          17      CALL    CHKWILD
00054F 064F 300B            12      JR  NC,PUTN1
000551 0651 216A0B          10      LD  HL,FDRV+1
000554 0654 CDF604          17      CALL    FPRNT
000557 0657 3E20             7      LD  A,020H
000559 0659 CD9F07          17      CALL    MSG_A
       065C                     PUTN1:
00055C 065C 11690B          10      LD  DE,FDRV
00055F 065F 0E16             7      LD  C,016H      ;(BDOS)ファイルの作成
000561 0661 CD7902          17      CALL    SYSTEM0
000564 0664 C20207          10      JP  NZ,COPYE2
000567 0667 67               4      LD  H,A     ;A=0
000568 0668 6F               4      LD  L,A
000569 0669 228A0B          16      LD  (FDRV+33),HL    ;(FCB)ランダム・レコード
00056C 066C 228C0B          16      LD  (FDRV+35),HL
00056F 066F 2C               4      INC L       ;HL=1
000570 0670 22770B          16      LD  (FDRV+14),HL    ;(FCB)レコード・サイズ
       0673                     COPY6:
000573 0673 CD8607          17      CALL    BUFSIZ
000576 0676 CD8902          17      CALL    S27DTA
000579 0679 3C               4      INC A
00057A 067A 287E            12      JR  Z,COPYE
00057C 067C 47               4      LD  B,A
00057D 067D 7C               4      LD  A,H
00057E 067E B5               4      OR  L
00057F 067F 280F            12      JR  Z,COPY7
000581 0681 11690B          10      LD  DE,FDRV
000584 0684 C5              11      PUSH    BC
000585 0685 0E26             7      LD  C,026H      ;(BDOS)ランダム・ブロック・ライト
000587 0687 CD0500          17      CALL    SYSTEM
00058A 068A C1              10      POP BC
00058B 068B B7               4      OR  A
00058C 068C 206C            12      JR  NZ,COPYE
00058E 068E 10E3            13      DJNZ    COPY6
       0690                     COPY7:
000590 0690 3A960A          13      LD  A,(MAJOR_VER)
000593 0693 FE02             7      CP  2
000595 0695 3011            12      JR  NC,COPY7_MSX2   ;DOS2はFCBの仕様が違う
000597 0697 3A400B          13      LD  A,(DTA_CCP+13)  ;(FCB)属性(アトリビュート)
00059A 069A 32760B          13      LD  (FDRV+13),A ;(FCB)属性(アトリビュート)
00059D 069D 21470B          10      LD  HL,DTA_CCP+20
0005A0 06A0 117D0B          10      LD  DE,FDRV+20  ;(FCB)更新日時
0005A3 06A3 010400          10      LD  BC,4
0005A6 06A6 EDB0                    LDIR
       06A8                     COPY7_MSX2:
0005A8 06A8 11690B          10      LD  DE,FDRV
0005AB 06AB 0E10             7      LD  C,010H      ;(BDOS)ファイルのクローズ
0005AD 06AD CD7902          17      CALL    SYSTEM0
                                
0005B0 06B0 2048            12      JR  NZ,COPYE
0005B2 06B2 3A960A          13      LD  A,(MAJOR_VER)
0005B5 06B5 FE02             7      CP  2
0005B7 06B7 383B            12      JR  C,COPY_DOS2DT
                                
0005B9 06B9 11330B          10      LD  DE,DTA_CCP
0005BC 06BC 21170B          10      LD  HL,DOS2NAME
0005BF 06BF CD0407          17      CALL    FCB2FNAME
                                
0005C2 06C2 11690B          10      LD  DE,FDRV
0005C5 06C5 21250B          10      LD  HL,DOS2NAME2
0005C8 06C8 CD0407          17      CALL    FCB2FNAME
                                
0005CB 06CB 11170B          10      LD  DE,DOS2NAME
0005CE 06CE AF               4      XOR A
0005CF 06CF 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
0005D1 06D1 CD7902          17      CALL    SYSTEM0
                                
0005D4 06D4 11250B          10      LD  DE,DOS2NAME2
0005D7 06D7 3E01             7      LD  A,1
0005D9 06D9 0E50             7      LD  C,050H      ;(BDOS)_ATTR ファイル属性の獲得・設定
0005DB 06DB CD7902          17      CALL    SYSTEM0
                                
0005DE 06DE 11170B          10      LD  DE,DOS2NAME
0005E1 06E1 AF               4      XOR A
0005E2 06E2 0E51             7      LD  C,51H       ;(BDOS)_FTIME ファイルの日付および時刻の獲得・設定
0005E4 06E4 CD7902          17      CALL    SYSTEM0
                                
0005E7 06E7 D5              11      PUSH    DE
0005E8 06E8 DDE1            14      POP IX
                                
0005EA 06EA 11250B          10      LD  DE,DOS2NAME2
0005ED 06ED 3E01             7      LD  A,1
0005EF 06EF 0E51             7      LD  C,51H       ;(BDOS)_FTIME ファイルの日付および時刻の獲得・設定
0005F1 06F1 CD7902          17      CALL    SYSTEM0
       06F4                     COPY_DOS2DT:
0005F4 06F4 116B0A          10      LD  DE,OK
0005F7 06F7 C31B06          10      JP  COPY8
                                
       06FA                     COPYE:
0005FA 06FA 11690B          10      LD  DE,FDRV
0005FD 06FD 0E13             7      LD  C,013H      ;(BDOS)ファイルの削除
0005FF 06FF CD0500          17      CALL    SYSTEM
       0702                     COPYE2:
000602 0702 37               4      SCF
000603 0703 C9              10      RET
                                
       0704                     FCB2FNAME:
000604 0704 1A               7      LD  A,(DE)
000605 0705 13               6      INC DE
000606 0706 C640             7      ADD A,'@'
000608 0708 77               7      LD  (HL),A
000609 0709 23               6      INC HL
00060A 070A 363A            10      LD  (HL),':'
00060C 070C 23               6      INC HL
                                
00060D 070D 0608             7      LD  B,8
       070F                     FCB2FNAME1:
00060F 070F 1A               7      LD  A,(DE)
000610 0710 FE21             7      CP  020H+1
000612 0712 3807            12      JR  C,FCB2FNAME2
000614 0714 13               6      INC DE
000615 0715 77               7      LD  (HL),A
000616 0716 23               6      INC HL
000617 0717 10F6            13      DJNZ    FCB2FNAME1
000619 0719 1803            12      JR  FCB2FNAME3
       071B                     FCB2FNAME2:
00061B 071B 13               6      INC DE
00061C 071C 10FD            13      DJNZ    FCB2FNAME2
       071E                     FCB2FNAME3:
00061E 071E 1A               7      LD  A,(DE)
00061F 071F FE21             7      CP  020H+1
000621 0721 380F            12      JR  C,FCB2FNAME5
000623 0723 362E            10      LD  (HL),'.'
000625 0725 23               6      INC HL
000626 0726 0603             7      LD  B,3
       0728                     FCB2FNAME4:
000628 0728 1A               7      LD  A,(DE)
000629 0729 13               6      INC DE
00062A 072A FE21             7      CP  020H+1
00062C 072C 3804            12      JR  C,FCB2FNAME5
00062E 072E 77               7      LD  (HL),A
00062F 072F 23               6      INC HL
000630 0730 10F6            13      DJNZ    FCB2FNAME4
       0732                     FCB2FNAME5:
000632 0732 3600            10      LD  (HL),0
000634 0734 C9              10      RET
                                
       0735                     C_TYPE:
000635 0735 CD9505          17      CALL    SETFCB
000638 0738 215C00          10      LD  HL,FCB1
00063B 073B CD2A02          17      CALL    OPEN
00063E 073E 37               4      SCF
       073F                     TYPE1:
00063F 073F C0              11      RET NZ
000640 0740 CD5002          17      CALL    DEFCB
000643 0743 3E1A             7      LD  A,01AH
000645 0745 CD9F07          17      CALL    MSG_A
       0748                     TYPE2:
000648 0748 CD8607          17      CALL    BUFSIZ
00064B 074B CD8902          17      CALL    S27DTA
00064E 074E C6FE             7      ADD A,0FEH
000650 0750 D8              11      RET C
000651 0751 7C               4      LD  A,H
000652 0752 B5               4      OR  L
000653 0753 281A            12      JR  Z,TYPEE
000655 0755 010080          10      LD  BC,DATA
       0758                     TYPE3:
000658 0758 0A               7      LD  A,(BC)
000659 0759 03               6      INC BC
00065A 075A FE1A             7      CP  01AH
00065C 075C 2811            12      JR  Z,TYPEE
00065E 075E 5F               4      LD  E,A
00065F 075F C5              11      PUSH    BC
000660 0760 E5              11      PUSH    HL
000661 0761 0E02             7      LD  C,2     ;(BDOS)コンソール出力
000663 0763 CD0500          17      CALL    SYSTEM
000666 0766 E1              10      POP HL
000667 0767 C1              10      POP BC
000668 0768 2B               6      DEC HL
000669 0769 7C               4      LD  A,H
00066A 076A B5               4      OR  L
00066B 076B 20EB            12      JR  NZ,TYPE3
00066D 076D 18D9            12      JR  TYPE2
       076F                     TYPEE:
00066F 076F CD4C02          17      CALL    OPEN2
000672 0772 18CB            12      JR  TYPE1
                                
       0774                     CWILD:
000674 0774 215D00          10      LD  HL,FCB1+1
       0777                     CWILD1:
000677 0777 7E               7      LD  A,(HL)
000678 0778 FE20             7      CP  020H
00067A 077A C0              11      RET NZ
       077B                     CWILD2:
00067B 077B 54               4      LD  D,H
00067C 077C 5D               4      LD  E,L
00067D 077D 13               6      INC DE
00067E 077E 010A00          10      LD  BC,10
000681 0781 363F            10      LD  (HL),'?'
000683 0783 EDB0                    LDIR
000685 0785 C9              10      RET
                                
       0786                     BUFSIZ:
000686 0786 3A0700          13      LD  A,(SYSTEM+2)
000689 0789 D681             7      SUB (DATA/256)+1
00068B 078B E6F8             7      AND 0F8H
00068D 078D 67               4      LD  H,A
00068E 078E 2E00             7      LD  L,0
000690 0790 C9              10      RET
                                
000691 0791 E9               4  JP_HL:  JP  (HL)
                                
       0792                     _PRINT:
000692 0792 C5              11      PUSH    BC
000693 0793 D5              11      PUSH    DE
000694 0794 E5              11      PUSH    HL
000695 0795 0E06             7      LD  C,6
000697 0797 CD0500          17      CALL    SYSTEM
00069A 079A E1              10      POP HL
00069B 079B D1              10      POP DE
00069C 079C C1              10      POP BC
00069D 079D B7               4      OR  A
00069E 079E C9              10      RET
                                
       079F                     MSG_A:
00069F 079F F5              11      PUSH    AF
0006A0 07A0 C5              11      PUSH    BC
0006A1 07A1 D5              11      PUSH    DE
0006A2 07A2 E5              11      PUSH    HL
0006A3 07A3 5F               4      LD  E,A
0006A4 07A4 0E02             7      LD  C,2
0006A6 07A6 CD0500          17      CALL    SYSTEM
0006A9 07A9 E1              10      POP HL
0006AA 07AA D1              10      POP DE
0006AB 07AB C1              10      POP BC
0006AC 07AC F1              10      POP AF
0006AD 07AD C9              10      RET
                                ;       FILE
       07AE                     FILEC_D2:       ;DOS2対応
0006AE 07AE 3A960A          13      LD  A,(MAJOR_VER)
0006B1 07B1 FE02             7      CP  2
0006B3 07B3 381C            12      JR  C,FILEC
0006B5 07B5 C5              11      PUSH    BC
0006B6 07B6 D5              11      PUSH    DE
0006B7 07B7 E5              11      PUSH    HL
0006B8 07B8 CDB908          17      CALL    SPCUT
0006BB 07BB 21D70A          10      LD  HL,PATH_CCP
0006BE 07BE 0640             7      LD  B,64
       07C0                     PATHCD1:
0006C0 07C0 1A               7      LD  A,(DE)
0006C1 07C1 13               6      INC DE
0006C2 07C2 FE20             7      CP  020H
0006C4 07C4 3002            12      JR  NC,PATHCD2
0006C6 07C6 3E00             7      LD  A,0
       07C8                     PATHCD2:
0006C8 07C8 77               7      LD  (HL),A
0006C9 07C9 3803            12      JR  C,PATHCD3
0006CB 07CB 23               6      INC HL
0006CC 07CC 10F2            13      DJNZ    PATHCD1
       07CE                     PATHCD3:
0006CE 07CE E1              10      POP HL
0006CF 07CF D1              10      POP DE
0006D0 07D0 C1              10      POP BC
       07D1                     FILEC:
0006D1 07D1 CDDC07          17      CALL    FILE
       07D4                     FILEC2:
0006D4 07D4 3A6A0B          13      LD  A,(FDRV+1)
0006D7 07D7 FE20             7      CP  020H
0006D9 07D9 C8              11      RET Z
0006DA 07DA 1839            12      JR  SETDIR1
                                
       07DC                     FILE:
0006DC 07DC AF               4      XOR A
0006DD 07DD 32690B          13      LD  (FDRV),A
0006E0 07E0 67               4      LD  H,A
0006E1 07E1 6F               4      LD  L,A
0006E2 07E2 22770B          16      LD  (FDRV+14),HL
0006E5 07E5 CDB908          17      CALL    SPCUT
0006E8 07E8 CD9E08          17      CALL    CCHK3
0006EB 07EB 2812            12      JR  Z,DEVI1
0006ED 07ED 13               6      INC DE
0006EE 07EE 1A               7      LD  A,(DE)
0006EF 07EF 1B               6      DEC DE
0006F0 07F0 FE3A             7      CP  ':'
0006F2 07F2 200B            12      JR  NZ,DEVI1
0006F4 07F4 1A               7      LD  A,(DE)      ;DRIVE
0006F5 07F5 CDBF08          17      CALL    CAP
0006F8 07F8 D640             7      SUB '@'
0006FA 07FA 13               6      INC DE
0006FB 07FB 13               6      INC DE
0006FC 07FC 32690B          13      LD  (FDRV),A
       07FF                     DEVI1:
0006FF 07FF 1A               7      LD  A,(DE)
000700 0800 D65C             7      SUB 05CH        ;\
000702 0802 2009            12      JR  NZ,NOROOT
000704 0804 6F               4      LD  L,A     ;A=0でH=0のはずなのでHL=0
000705 0805 22830B          16      LD  (FDRV+26),HL
000708 0808 2C               4      INC L
000709 0809 22770B          16      LD  (FDRV+14),HL
00070C 080C 13               6      INC DE
       080D                     NOROOT:
                                
       080D                     SETDIR:
00070D 080D CD3E08          17      CALL    FILED
000710 0810 1A               7      LD  A,(DE)
000711 0811 FE5C             7      CP  05CH        ;\
000713 0813 C0              11      RET NZ
000714 0814 13               6      INC DE
       0815                     SETDIR1:
000715 0815 3A960A          13      LD  A,(MAJOR_VER)
000718 0818 FE01             7      CP  1
00071A 081A C0              11      RET NZ
                                                ;for LSX-Dodgers
00071B 081B 3E10             7      LD  A,010H      ;Directory
00071D 081D 32760B          13      LD  (FDRV+13),A
000720 0820 D5              11      PUSH    DE
000721 0821 11690B          10      LD  DE,FDRV
000724 0824 0E0F             7      LD  C,00FH
000726 0826 CD0500          17      CALL    SYSTEM
000729 0829 D1              10      POP DE
00072A 082A B7               4      OR  A
00072B 082B C0              11      RET NZ
                                
00072C 082C 3A760B          13      LD  A,(FDRV+13)
00072F 082F CB67             8      BIT 4,A
000731 0831 C8              11      RET Z
                                
000732 0832 CD8508          17      CALL    FILEI
000735 0835 2A830B          16      LD  HL,(FDRV+26)
000738 0838 23               6      INC HL
000739 0839 22770B          16      LD  (FDRV+14),HL
00073C 083C 18CF            12      JR  SETDIR
                                
       083E                     FILED:
00073E 083E CD8508          17      CALL    FILEI
                                
000741 0841 0608             7      LD  B,8
       0843                     FILE2:
000743 0843 CD9308          17      CALL    CCHKF
000746 0846 C8              11      RET Z
000747 0847 FE2A             7      CP  '*'
000749 0849 282E            12      JR  Z,FILE9
00074B 084B FE2E             7      CP  '.'
00074D 084D 280C            12      JR  Z,FILE4
00074F 084F 77               7      LD  (HL),A
000750 0850 23               6      INC HL
000751 0851 10F0            13      DJNZ    FILE2
                                
       0853                     FILE3:
000753 0853 CD9308          17      CALL    CCHKF
000756 0856 C8              11      RET Z
000757 0857 FE2E             7      CP  '.'
000759 0859 20F8            12      JR  NZ,FILE3
                                
       085B                     FILE4:
00075B 085B 21720B          10      LD  HL,FNAME+8
00075E 085E 0603             7      LD  B,3
                                
       0860                     FILE4L:
000760 0860 CD9308          17      CALL    CCHKF
000763 0863 C8              11      RET Z
000764 0864 FE2E             7      CP  '.'
000766 0866 2008            12      JR  NZ,FILE12
000768 0868 326A0B          13      LD  (FNAME),A   ;Parent directory(..)
00076B 086B 326B0B          13      LD  (FNAME+1),A
00076E 086E 3E20             7      LD  A,020H
       0870                     FILE12:
000770 0870 FE2A             7      CP  '*'
000772 0872 280A            12      JR  Z,FILE10
000774 0874 77               7      LD  (HL),A
000775 0875 23               6      INC HL
000776 0876 10E8            13      DJNZ    FILE4L
000778 0878 C9              10      RET
                                
       0879                     FILE9:              ;名前の*処理、名前の残りを?で埋める
000779 0879 CD7E08          17      CALL    FILE10
00077C 087C 18D5            12      JR  FILE3
                                
       087E                     FILE10:
00077E 087E 3E3F             7      LD  A,'?'
                                
       0880                     FILL_MEMORY:                ;HLからBバイトAで埋める
000780 0880 77               7      LD  (HL),A
000781 0881 23               6      INC HL
000782 0882 10FC            13      DJNZ    FILL_MEMORY
000784 0884 C9              10      RET
                                
       0885                     FILEI:              ;名前＋拡張子をスペースで初期化
000785 0885 3E20             7      LD  A,020H
000787 0887 01000B          10      LD  BC,11*256
00078A 088A 216A0B          10      LD  HL,FNAME
00078D 088D E5              11      PUSH    HL
00078E 088E CD8008          17      CALL    FILL_MEMORY
000791 0891 E1              10      POP HL
000792 0892 C9              10      RET
                                
       0893                     CCHKF:
000793 0893 1A               7      LD  A,(DE)
000794 0894 CD9B08          17      CALL    CCHK2
000797 0897 C8              11      RET Z
000798 0898 C3E108          10      JP  FKAN
                                
       089B                     CCHK2:
00079B 089B 0C               4      INC C
00079C 089C 0D               4      DEC C
00079D 089D C0              11      RET NZ
       089E                     CCHK3:              ;ZF=1 で使えない文字
00079E 089E FE2B             7      CP  '+'
0007A0 08A0 C8              11      RET Z
0007A1 08A1 FE2C             7      CP  ','
0007A3 08A3 C8              11      RET Z
0007A4 08A4 FE2F             7      CP  '/'
0007A6 08A6 C8              11      RET Z
0007A7 08A7 FE3A             7      CP  ':'
0007A9 08A9 C8              11      RET Z
0007AA 08AA FE3B             7      CP  ';'
0007AC 08AC C8              11      RET Z
0007AD 08AD FE3D             7      CP  '='
0007AF 08AF C8              11      RET Z
0007B0 08B0 FE5C             7      CP  05CH    ;\
0007B2 08B2 C8              11      RET Z
0007B3 08B3 FE20             7      CP  020H
0007B5 08B5 D0              11      RET NC
0007B6 08B6 BF               4      CP  A       ;Z=1
0007B7 08B7 C9              10      RET
                                
       08B8                     SS1:
0007B8 08B8 13               6      INC DE
       08B9                     SPCUT:              ;スペースをカット
0007B9 08B9 1A               7      LD  A,(DE)
0007BA 08BA FE20             7      CP  020H
0007BC 08BC 28FA            12      JR  Z,SS1
0007BE 08BE C9              10      RET
                                
       08BF                     CAP:
0007BF 08BF FE61             7      CP  'a'
0007C1 08C1 D8              11      RET C
0007C2 08C2 FE7B             7      CP  'z'+1
0007C4 08C4 D0              11      RET NC
0007C5 08C5 D620             7      SUB 020H
0007C7 08C7 C9              10      RET
       08C8                     CAP2:
0007C8 08C8 CDBF08          17      CALL    CAP
       08CB                     CAP3:
0007CB 08CB CDD408          17      CALL    CAP4
0007CE 08CE FE21             7      CP  021H
0007D0 08D0 D0              11      RET NC
0007D1 08D1 3E20             7      LD  A,020H
0007D3 08D3 C9              10      RET
       08D4                     CAP4:
0007D4 08D4 FE05             7      CP  5
0007D6 08D6 C0              11      RET NZ
0007D7 08D7 3EE5             7      LD  A,0E5H
0007D9 08D9 C9              10      RET
                                
       08DA                     FKANC:
0007DA 08DA CB41             8      BIT 0,C
0007DC 08DC CCC808          17      CALL    Z,CAP2
0007DF 08DF 1801            12      JR  FKANX
       08E1                     FKAN:           ;漢字チェック
0007E1 08E1 13               6      INC DE
       08E2                     FKANX:
0007E2 08E2 CB41             8      BIT 0,C
0007E4 08E4 CB81             8      RES 0,C
0007E6 08E6 C0              11      RET NZ
0007E7 08E7 FE80             7      CP  080H
0007E9 08E9 D8              11      RET C
0007EA 08EA FEA0             7      CP  0A0H
0007EC 08EC 3803            12      JR  C,FKAN1
0007EE 08EE FEE0             7      CP  0E0H
0007F0 08F0 D8              11      RET C
       08F1                     FKAN1:
0007F1 08F1 0C               4      INC C
0007F2 08F2 A7               4      AND A
0007F3 08F3 C9              10      RET
                                
       08F4                     CHKWILDX:
0007F4 08F4 FDE5            15      PUSH    IY
0007F6 08F6 E1              10      POP HL
0007F7 08F7 23               6      INC HL
       08F8                     CHKWILD:
0007F8 08F8 060B             7      LD  B,11
0007FA 08FA 3E3F             7      LD  A,'?'
       08FC                     CHKWIL1:
0007FC 08FC BE               7      CP  (HL)
0007FD 08FD 23               6      INC HL
0007FE 08FE 37               4      SCF
0007FF 08FF C8              11      RET Z
000800 0900 10FA            13      DJNZ    CHKWIL1
000802 0902 AF               4      XOR A
000803 0903 C9              10      RET
                                
       0904                     CPNAME:
000804 0904 C5              11      PUSH    BC
000805 0905 D5              11      PUSH    DE
000806 0906 11580B          10      LD  DE,CPBUF
000809 0909 010500          10      LD  BC,5
00080C 090C EDB0                    LDIR
00080E 090E D1              10      POP DE
00080F 090F D5              11      PUSH    DE
000810 0910 E5              11      PUSH    HL
000811 0911 21580B          10      LD  HL,CPBUF
000814 0914 CD2709          17      CALL    CPFILE
000817 0917 E1              10      POP HL
000818 0918 D1              10      POP DE
000819 0919 C1              10      POP BC
00081A 091A 2005            12      JR  NZ,CPNAME1
00081C 091C 7E               7      LD  A,(HL)
00081D 091D 23               6      INC HL
00081E 091E 66               7      LD  H,(HL)
00081F 091F 6F               4      LD  L,A
000820 0920 C9              10      RET
       0921                     CPNAME1:
000821 0921 23               6      INC HL
000822 0922 23               6      INC HL
000823 0923 10DF            13      DJNZ    CPNAME
000825 0925 37               4      SCF
000826 0926 C9              10      RET
                                
       0927                     CPFILE:
000827 0927 C5              11      PUSH    BC
000828 0928 01000B          10      LD  BC,00B00H
       092B                     CPSTR1:
00082B 092B 1A               7      LD  A,(DE)
00082C 092C FE3F             7      CP  '?'     ;Wild card
00082E 092E 2812            12      JR  Z,CPSTR2
000830 0930 7E               7      LD  A,(HL)
000831 0931 CDDA08          17      CALL    FKANC
000834 0934 E5              11      PUSH    HL
000835 0935 67               4      LD  H,A
000836 0936 1A               7      LD  A,(DE)
000837 0937 CB01             4      RLC C
000839 0939 CDDA08          17      CALL    FKANC
00083C 093C CB09             4      RRC C
00083E 093E BC               4      CP  H       ;CP (HL),(DE)
00083F 093F E1              10      POP HL
000840 0940 2004            12      JR  NZ,CPSTR3
       0942                     CPSTR2:
000842 0942 13               6      INC DE
000843 0943 23               6      INC HL
000844 0944 10E5            13      DJNZ    CPSTR1
       0946                     CPSTR3:
000846 0946 C1              10      POP BC
000847 0947 C9              10      RET
                                
       0948                     CPFILE2:
000848 0948 FD7E0D          19      LD  A,(IY+13)   ;(FCB)属性(アトリビュート)
00084B 094B F6E1             7      OR  0E1H
00084D 094D 2F               4      CPL
00084E 094E A6               7      AND (HL)
00084F 094F C9              10      RET
                                
       0950                     _SYS29:     ;(BDOS)ファイル名の解析
000850 0950 C5              11      PUSH    BC
000851 0951 E5              11      PUSH    HL
000852 0952 CDDC07          17      CALL    FILE
000855 0955 E1              10      POP HL
000856 0956 C1              10      POP BC
       0957                     S29X1:
000857 0957 C5              11      PUSH    BC
000858 0958 D5              11      PUSH    DE
000859 0959 E5              11      PUSH    HL
00085A 095A EB               4      EX  DE,HL
00085B 095B 21690B          10      LD  HL,FDRV
00085E 095E 010D00          10      LD  BC,13
000861 0961 EDB0                    LDIR
000863 0963 70               7      LD  (HL),B      ;B=0
000864 0964 0E03             7      LD  C,3
000866 0966 EDB0                    LDIR
000868 0968 E1              10      POP HL
000869 0969 D1              10      POP DE
00086A 096A C1              10      POP BC
00086B 096B AF               4      XOR A
00086C 096C C9              10      RET
       096D                     GET_WIDTH:
00086D 096D 3A950A          13      LD  A,(IS_MSX)
000870 0970 B7               4      OR  A
000871 0971 2804            12      JR  Z,NOT_MSX
000873 0973 3AB0F3          13      LD  A,(LINLEN)
000876 0976 C9              10      RET
       0977                     NOT_MSX:
000877 0977 E5              11      PUSH    HL
000878 0978 2A0100          16      LD  HL,(1)
00087B 097B 2EB1             7      LD  L,0B1H
00087D 097D 7E               7      LD  A,(HL)
00087E 097E E1              10      POP HL
00087F 097F C9              10      RET
                                
       0980                     C_MODE:
000880 0980 3A950A          13      LD  A,(IS_MSX)
000883 0983 B7               4      OR  A
000884 0984 C8              11      RET Z
000885 0985 0E29             7      LD  C,41
000887 0987 3AF8FA          13      LD  A,(EXBRSA)
00088A 098A B7               4      OR  A
00088B 098B 2802            12      JR  Z,MODE_MSX1
00088D 098D 0E51             7      LD  C,81
       098F                     MODE_MSX1:
00088F 098F C5              11      PUSH    BC
000890 0990 CDDD09          17      CALL    GETNUM
000893 0993 C1              10      POP BC
000894 0994 7D               4      LD  A,L
000895 0995 B9               4      CP  C
000896 0996 301C            12      JR  NC,MODE1
000898 0998 B7               4      OR  A
000899 0999 2819            12      JR  Z,MODE1
00089B 099B FE21             7      CP  33
00089D 099D 381E            12      JR  C,MODE32
00089F 099F 32AEF3          13      LD  (LINL40),A
0008A2 09A2 DD216C00        14      LD  IX,INITXT
0008A6 09A6 CDAD09          17      CALL    CALLROM
0008A9 09A9 DD217800        14      LD  IX,SETTXT
       09AD                     CALLROM:
0008AD 09AD FD2AC1FC        20      LD  IY,(EXPTBL) ;メインROMスロット
0008B1 09B1 C31C00          10      JP  CALSLT
       09B4                     MODE1:
0008B4 09B4 3AB0F3          13      LD  A,(LINLEN)
0008B7 09B7 CD8005          17      CALL    PRDEC_A
0008BA 09BA C34F04          10      JP  LTNL
       09BD                     MODE32:
0008BD 09BD 32AFF3          13      LD  (LINL32),A
0008C0 09C0 DD216F00        14      LD  IX,INIT32
0008C4 09C4 CDAD09          17      CALL    CALLROM
0008C7 09C7 DD217B00        14      LD  IX,SETT32
0008CB 09CB 18E0            12      JR  CALLROM
                                
       09CD                     C_PAUSE:
0008CD 09CD 117A0A          10      LD  DE,PAUSE
0008D0 09D0 0E09             7      LD  C,9     ;(BDOS)文字列出力
0008D2 09D2 CD0500          17      CALL    SYSTEM
0008D5 09D5 0E08             7      LD  C,8     ;(BDOS)エコーなしコンソール入力
0008D7 09D7 CD0500          17      CALL    SYSTEM
0008DA 09DA C34F04          10      JP  LTNL
                                
       09DD                     GETNUM:
0008DD 09DD CDB908          17      CALL    SPCUT
0008E0 09E0 210000          10      LD  HL,0
       09E3                     GETNUM1:
0008E3 09E3 1A               7      LD  A,(DE)
0008E4 09E4 13               6      INC DE
0008E5 09E5 D630             7      SUB '0'
0008E7 09E7 D8              11      RET C
0008E8 09E8 FE0A             7      CP  10
0008EA 09EA D0              11      RET NC
0008EB 09EB 4D               4      LD  C,L
0008EC 09EC 44               4      LD  B,H
0008ED 09ED 29              11      ADD HL,HL   ;*2
0008EE 09EE 29              11      ADD HL,HL   ;*4
0008EF 09EF 09              11      ADD HL,BC   ;*5
0008F0 09F0 29              11      ADD HL,HL   ;*10
0008F1 09F1 4F               4      LD  C,A
0008F2 09F2 0600             7      LD  B,0
0008F4 09F4 09              11      ADD HL,BC
0008F5 09F5 18EC            12      JR  GETNUM1
                                
       09F7                     CHDIR:
0008F7 09F7 3A960A          13      LD  A,(MAJOR_VER)
0008FA 09FA FE02             7      CP  2
0008FC 09FC D8              11      RET C
0008FD 09FD C5              11      PUSH    BC
0008FE 09FE E5              11      PUSH    HL
0008FF 09FF 0E5A             7      LD  C,05AH      ;(BDOS)_CHDIR カレントディレクトリの変更
000901 0A01 CD0500          17      CALL    SYSTEM
000904 0A04 E1              10      POP HL
000905 0A05 C1              10      POP BC
000906 0A06 C9              10      RET
                                
       000B                     COMS    EQU 11
       0A07                     COMTB:
000907 0A07 4420202020              DB  "D    " ;1
00090C 0A0C 9F03                    DW  C_DIR
00090E 0A0E 4449522020              DB  "DIR  " ;2
000913 0A13 9F03                    DW  C_DIR
000915 0A15 434F505920              DB  "COPY " ;3
00091A 0A1A D605                    DW  C_COPY
00091C 0A1C 4344202020              DB  "CD   " ;4
000921 0A21 7E02                    DW  C_CD
000923 0A23 44454C2020              DB  "DEL  " ;5
000928 0A28 8003                    DW  C_DEL
00092A 0A2A 5041544820              DB  "PATH " ;6
00092F 0A2F 5904                    DW  C_PATH
000931 0A31 52454E2020              DB  "REN  " ;7
000936 0A36 8C03                    DW  C_REN
000938 0A38 5459504520              DB  "TYPE " ;8
00093D 0A3D 3507                    DW  C_TYPE
00093F 0A3F 52454D2020              DB  "REM  " ;9
000944 0A44 7E03                    DW  C_REM
000946 0A46 4D4F444520              DB  "MODE " ;10
00094B 0A4B 8009                    DW  C_MODE
00094D 0A4D 5041555345              DB  "PAUSE" ;11
000952 0A52 CD09                    DW  C_PAUSE
                                
000954 0A54 2062797465732066    FREE:   DB  " bytes free  $"
            726565202024        
000962 0A62 2020203C4449523E    DIRMES: DB  "   <DIR>$"
            24                  
00096B 0A6B 4F4B24              OK: DB  "OK$"
00096E 0A6E 536B697024          SKIP:   DB  "Skip$"
000973 0A73 4572726F722124      COMERM: DB  "Error!$"
00097A 0A7A 537472696B652061    PAUSE:  DB  "Strike any key when ready $"
            6E79206B65792077    
            68656E2072656164    
            792024              
                                
       0A95                     IS_MSX:
000995 0A95 00                      DB  0
       0A96                     MAJOR_VER:
000996 0A96 00                      DB  0
                                
       0A97                     SEARCH_IX:; EQU $4000
000997 0A97                         DS  64  ;DOS2用
                                
       0AD7                     PATH_CCP:;  EQU $5000
0009D7 0AD7                         DS  64  ;DOS2用
                                
       0B17                     DOS2NAME:
000A17 0B17                         DS  2+8+3+1
       0B25                     DOS2NAME2:
000A25 0B25                         DS  2+8+3+1
                                
       0B33                     DTA_CCP:;       EQU $6000
000A33 0B33                         DS  37
       0B58                     CPBUF:
000A58 0B58 0000                LEFTX:  DW  0
000A5A 0B5A 0000                DTAX:   DW  0
000A5C 0B5C 20                      DB  020H    ;CPBUFで使う
000A5D 0B5D 20                      DB  020H
000A5E 0B5E 20                      DB  020H
000A5F 0B5F 20                      DB  020H
000A60 0B60 20                      DB  020H
000A61 0B61 20                      DB  020H
000A62 0B62 20                      DB  020H
                                
       0B63                     DECBF:
000A63 0B63                         DS  5
       0B68                     FCB_BAT2:
000A68 0B68 00                      DB  0
       0B69                     FDRV:
000A69 0B69 00                      DB  0
       0B6A                     FNAME:
000A6A 0B6A                         DS  37
       0B8F                     ZERO:
000A8F 0B8F 00                      DB  0
       0B90                     FCB_BAT:
000A90 0B90 680B                    DW  FCB_BAT2
       0B92                     CUR_DIR:
       0B92                         DS  64
                                
       0BD2                     DATA_COM:
[EOF:COMMAND.ASM:SHIFT_JIS]
